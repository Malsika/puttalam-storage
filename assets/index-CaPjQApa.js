(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Qo(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const rt={},os=[],Pr=()=>{},Cu=()=>!1,Ca=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Zo=e=>e.startsWith("onUpdate:"),Wt=Object.assign,el=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},Vh=Object.prototype.hasOwnProperty,ze=(e,t)=>Vh.call(e,t),De=Array.isArray,ls=e=>_i(e)==="[object Map]",Oa=e=>_i(e)==="[object Set]",jl=e=>_i(e)==="[object Date]",Ne=e=>typeof e=="function",mt=e=>typeof e=="string",Nr=e=>typeof e=="symbol",it=e=>e!==null&&typeof e=="object",Ou=e=>(it(e)||Ne(e))&&Ne(e.then)&&Ne(e.catch),Ru=Object.prototype.toString,_i=e=>Ru.call(e),Kh=e=>_i(e).slice(8,-1),Iu=e=>_i(e)==="[object Object]",tl=e=>mt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Us=Qo(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ra=e=>{const t=Object.create(null);return(r=>t[r]||(t[r]=e(r)))},Gh=/-\w/g,dn=Ra(e=>e.replace(Gh,t=>t.slice(1).toUpperCase())),qh=/\B([A-Z])/g,xn=Ra(e=>e.replace(qh,"-$1").toLowerCase()),Fu=Ra(e=>e.charAt(0).toUpperCase()+e.slice(1)),eo=Ra(e=>e?`on${Fu(e)}`:""),hn=(e,t)=>!Object.is(e,t),Ji=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},Du=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},Ia=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Wl;const Fa=()=>Wl||(Wl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function rl(e){if(De(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],s=mt(n)?Yh(n):rl(n);if(s)for(const i in s)t[i]=s[i]}return t}else if(mt(e)||it(e))return e}const zh=/;(?![^(]*\))/g,Xh=/:([^]+)/,Jh=/\/\*[^]*?\*\//g;function Yh(e){const t={};return e.replace(Jh,"").split(zh).forEach(r=>{if(r){const n=r.split(Xh);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function qr(e){let t="";if(mt(e))t=e;else if(De(e))for(let r=0;r<e.length;r++){const n=qr(e[r]);n&&(t+=n+" ")}else if(it(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Qh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Zh=Qo(Qh);function Pu(e){return!!e||e===""}function ed(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=Da(e[n],t[n]);return r}function Da(e,t){if(e===t)return!0;let r=jl(e),n=jl(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=Nr(e),n=Nr(t),r||n)return e===t;if(r=De(e),n=De(t),r||n)return r&&n?ed(e,t):!1;if(r=it(e),n=it(t),r||n){if(!r||!n)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const a in e){const o=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(o&&!l||!o&&l||!Da(e[a],t[a]))return!1}}return String(e)===String(t)}function td(e,t){return e.findIndex(r=>Da(r,t))}const Nu=e=>!!(e&&e.__v_isRef===!0),be=e=>mt(e)?e:e==null?"":De(e)||it(e)&&(e.toString===Ru||!Ne(e.toString))?Nu(e)?be(e.value):JSON.stringify(e,Lu,2):String(e),Lu=(e,t)=>Nu(t)?Lu(e,t.value):ls(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,s],i)=>(r[to(n,i)+" =>"]=s,r),{})}:Oa(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>to(r))}:Nr(t)?to(t):it(t)&&!De(t)&&!Iu(t)?String(t):t,to=(e,t="")=>{var r;return Nr(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};let Jt;class rd{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Jt,!t&&Jt&&(this.index=(Jt.scopes||(Jt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Jt;try{return Jt=this,t()}finally{Jt=r}}}on(){++this._on===1&&(this.prevScope=Jt,Jt=this)}off(){this._on>0&&--this._on===0&&(Jt=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function nd(){return Jt}let st;const ro=new WeakSet;class Bu{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Jt&&Jt.active&&Jt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ro.has(this)&&(ro.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Uu(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hl(this),$u(this);const t=st,r=Ar;st=this,Ar=!0;try{return this.fn()}finally{ju(this),st=t,Ar=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)il(t);this.deps=this.depsTail=void 0,Hl(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ro.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ko(this)&&this.run()}get dirty(){return ko(this)}}let Mu=0,$s,js;function Uu(e,t=!1){if(e.flags|=8,t){e.next=js,js=e;return}e.next=$s,$s=e}function nl(){Mu++}function sl(){if(--Mu>0)return;if(js){let t=js;for(js=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;$s;){let t=$s;for($s=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function $u(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function ju(e){let t,r=e.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),il(n),sd(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}e.deps=t,e.depsTail=r}function ko(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Wu(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Wu(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ei)||(e.globalVersion=ei,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!ko(e))))return;e.flags|=2;const t=e.dep,r=st,n=Ar;st=e,Ar=!0;try{$u(e);const s=e.fn(e._value);(t.version===0||hn(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{st=r,Ar=n,ju(e),e.flags&=-3}}function il(e,t=!1){const{dep:r,prevSub:n,nextSub:s}=e;if(n&&(n.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)il(i,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function sd(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let Ar=!0;const Hu=[];function zr(){Hu.push(Ar),Ar=!1}function Xr(){const e=Hu.pop();Ar=e===void 0?!0:e}function Hl(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=st;st=void 0;try{t()}finally{st=r}}}let ei=0;class id{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class al{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!st||!Ar||st===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==st)r=this.activeLink=new id(st,this),st.deps?(r.prevDep=st.depsTail,st.depsTail.nextDep=r,st.depsTail=r):st.deps=st.depsTail=r,Vu(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=st.depsTail,r.nextDep=void 0,st.depsTail.nextDep=r,st.depsTail=r,st.deps===r&&(st.deps=n)}return r}trigger(t){this.version++,ei++,this.notify(t)}notify(t){nl();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{sl()}}}function Vu(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Vu(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const Co=new WeakMap,Dn=Symbol(""),Oo=Symbol(""),ti=Symbol("");function Mt(e,t,r){if(Ar&&st){let n=Co.get(e);n||Co.set(e,n=new Map);let s=n.get(r);s||(n.set(r,s=new al),s.map=n,s.key=r),s.track()}}function Wr(e,t,r,n,s,i){const a=Co.get(e);if(!a){ei++;return}const o=l=>{l&&l.trigger()};if(nl(),t==="clear")a.forEach(o);else{const l=De(e),c=l&&tl(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,p)=>{(p==="length"||p===ti||!Nr(p)&&p>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(ti)),t){case"add":l?c&&o(a.get("length")):(o(a.get(Dn)),ls(e)&&o(a.get(Oo)));break;case"delete":l||(o(a.get(Dn)),ls(e)&&o(a.get(Oo)));break;case"set":ls(e)&&o(a.get(Dn));break}}sl()}function Vn(e){const t=qe(e);return t===e?t:(Mt(t,"iterate",ti),vr(e)?t:t.map(Cr))}function Pa(e){return Mt(e=qe(e),"iterate",ti),e}function sn(e,t){return Jr(e)?ms(Pn(e)?Cr(t):t):Cr(t)}const ad={__proto__:null,[Symbol.iterator](){return no(this,Symbol.iterator,e=>sn(this,e))},concat(...e){return Vn(this).concat(...e.map(t=>De(t)?Vn(t):t))},entries(){return no(this,"entries",e=>(e[1]=sn(this,e[1]),e))},every(e,t){return Ur(this,"every",e,t,void 0,arguments)},filter(e,t){return Ur(this,"filter",e,t,r=>r.map(n=>sn(this,n)),arguments)},find(e,t){return Ur(this,"find",e,t,r=>sn(this,r),arguments)},findIndex(e,t){return Ur(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Ur(this,"findLast",e,t,r=>sn(this,r),arguments)},findLastIndex(e,t){return Ur(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Ur(this,"forEach",e,t,void 0,arguments)},includes(...e){return so(this,"includes",e)},indexOf(...e){return so(this,"indexOf",e)},join(e){return Vn(this).join(e)},lastIndexOf(...e){return so(this,"lastIndexOf",e)},map(e,t){return Ur(this,"map",e,t,void 0,arguments)},pop(){return Rs(this,"pop")},push(...e){return Rs(this,"push",e)},reduce(e,...t){return Vl(this,"reduce",e,t)},reduceRight(e,...t){return Vl(this,"reduceRight",e,t)},shift(){return Rs(this,"shift")},some(e,t){return Ur(this,"some",e,t,void 0,arguments)},splice(...e){return Rs(this,"splice",e)},toReversed(){return Vn(this).toReversed()},toSorted(e){return Vn(this).toSorted(e)},toSpliced(...e){return Vn(this).toSpliced(...e)},unshift(...e){return Rs(this,"unshift",e)},values(){return no(this,"values",e=>sn(this,e))}};function no(e,t,r){const n=Pa(e),s=n[t]();return n!==e&&!vr(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=r(i.value)),i}),s}const od=Array.prototype;function Ur(e,t,r,n,s,i){const a=Pa(e),o=a!==e&&!vr(e),l=a[t];if(l!==od[t]){const f=l.apply(e,i);return o?Cr(f):f}let c=r;a!==e&&(o?c=function(f,p){return r.call(this,sn(e,f),p,e)}:r.length>2&&(c=function(f,p){return r.call(this,f,p,e)}));const u=l.call(a,c,n);return o&&s?s(u):u}function Vl(e,t,r,n){const s=Pa(e);let i=r;return s!==e&&(vr(e)?r.length>3&&(i=function(a,o,l){return r.call(this,a,o,l,e)}):i=function(a,o,l){return r.call(this,a,sn(e,o),l,e)}),s[t](i,...n)}function so(e,t,r){const n=qe(e);Mt(n,"iterate",ti);const s=n[t](...r);return(s===-1||s===!1)&&ul(r[0])?(r[0]=qe(r[0]),n[t](...r)):s}function Rs(e,t,r=[]){zr(),nl();const n=qe(e)[t].apply(e,r);return sl(),Xr(),n}const ld=Qo("__proto__,__v_isRef,__isVue"),Ku=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Nr));function cd(e){Nr(e)||(e=String(e));const t=qe(this);return Mt(t,"has",e),t.hasOwnProperty(e)}class Gu{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?_d:Ju:i?Xu:zu).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=De(t);if(!s){let l;if(a&&(l=ad[r]))return l;if(r==="hasOwnProperty")return cd}const o=Reflect.get(t,r,Ut(t)?t:n);if((Nr(r)?Ku.has(r):ld(r))||(s||Mt(t,"get",r),i))return o;if(Ut(o)){const l=a&&tl(r)?o:o.value;return s&&it(l)?Io(l):l}return it(o)?s?Io(o):ll(o):o}}class qu extends Gu{constructor(t=!1){super(!1,t)}set(t,r,n,s){let i=t[r];const a=De(t)&&tl(r);if(!this._isShallow){const c=Jr(i);if(!vr(n)&&!Jr(n)&&(i=qe(i),n=qe(n)),!a&&Ut(i)&&!Ut(n))return c||(i.value=n),!0}const o=a?Number(r)<t.length:ze(t,r),l=Reflect.set(t,r,n,Ut(t)?t:s);return t===qe(s)&&(o?hn(n,i)&&Wr(t,"set",r,n):Wr(t,"add",r,n)),l}deleteProperty(t,r){const n=ze(t,r);t[r];const s=Reflect.deleteProperty(t,r);return s&&n&&Wr(t,"delete",r,void 0),s}has(t,r){const n=Reflect.has(t,r);return(!Nr(r)||!Ku.has(r))&&Mt(t,"has",r),n}ownKeys(t){return Mt(t,"iterate",De(t)?"length":Dn),Reflect.ownKeys(t)}}class ud extends Gu{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const fd=new qu,hd=new ud,dd=new qu(!0);const Ro=e=>e,Fi=e=>Reflect.getPrototypeOf(e);function pd(e,t,r){return function(...n){const s=this.__v_raw,i=qe(s),a=ls(i),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=s[e](...n),u=r?Ro:t?ms:Cr;return!t&&Mt(i,"iterate",l?Oo:Dn),Wt(Object.create(c),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:o?[u(f[0]),u(f[1])]:u(f),done:p}}})}}function Di(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function gd(e,t){const r={get(s){const i=this.__v_raw,a=qe(i),o=qe(s);e||(hn(s,o)&&Mt(a,"get",s),Mt(a,"get",o));const{has:l}=Fi(a),c=t?Ro:e?ms:Cr;if(l.call(a,s))return c(i.get(s));if(l.call(a,o))return c(i.get(o));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Mt(qe(s),"iterate",Dn),s.size},has(s){const i=this.__v_raw,a=qe(i),o=qe(s);return e||(hn(s,o)&&Mt(a,"has",s),Mt(a,"has",o)),s===o?i.has(s):i.has(s)||i.has(o)},forEach(s,i){const a=this,o=a.__v_raw,l=qe(o),c=t?Ro:e?ms:Cr;return!e&&Mt(l,"iterate",Dn),o.forEach((u,f)=>s.call(i,c(u),c(f),a))}};return Wt(r,e?{add:Di("add"),set:Di("set"),delete:Di("delete"),clear:Di("clear")}:{add(s){!t&&!vr(s)&&!Jr(s)&&(s=qe(s));const i=qe(this);return Fi(i).has.call(i,s)||(i.add(s),Wr(i,"add",s,s)),this},set(s,i){!t&&!vr(i)&&!Jr(i)&&(i=qe(i));const a=qe(this),{has:o,get:l}=Fi(a);let c=o.call(a,s);c||(s=qe(s),c=o.call(a,s));const u=l.call(a,s);return a.set(s,i),c?hn(i,u)&&Wr(a,"set",s,i):Wr(a,"add",s,i),this},delete(s){const i=qe(this),{has:a,get:o}=Fi(i);let l=a.call(i,s);l||(s=qe(s),l=a.call(i,s)),o&&o.call(i,s);const c=i.delete(s);return l&&Wr(i,"delete",s,void 0),c},clear(){const s=qe(this),i=s.size!==0,a=s.clear();return i&&Wr(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=pd(s,e,t)}),r}function ol(e,t){const r=gd(e,t);return(n,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(ze(r,s)&&s in n?r:n,s,i)}const vd={get:ol(!1,!1)},md={get:ol(!1,!0)},xd={get:ol(!0,!1)};const zu=new WeakMap,Xu=new WeakMap,Ju=new WeakMap,_d=new WeakMap;function wd(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yd(e){return e.__v_skip||!Object.isExtensible(e)?0:wd(Kh(e))}function ll(e){return Jr(e)?e:cl(e,!1,fd,vd,zu)}function Ed(e){return cl(e,!1,dd,md,Xu)}function Io(e){return cl(e,!0,hd,xd,Ju)}function cl(e,t,r,n,s){if(!it(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=yd(e);if(i===0)return e;const a=s.get(e);if(a)return a;const o=new Proxy(e,i===2?n:r);return s.set(e,o),o}function Pn(e){return Jr(e)?Pn(e.__v_raw):!!(e&&e.__v_isReactive)}function Jr(e){return!!(e&&e.__v_isReadonly)}function vr(e){return!!(e&&e.__v_isShallow)}function ul(e){return e?!!e.__v_raw:!1}function qe(e){const t=e&&e.__v_raw;return t?qe(t):e}function Td(e){return!ze(e,"__v_skip")&&Object.isExtensible(e)&&Du(e,"__v_skip",!0),e}const Cr=e=>it(e)?ll(e):e,ms=e=>it(e)?Io(e):e;function Ut(e){return e?e.__v_isRef===!0:!1}function Be(e){return bd(e,!1)}function bd(e,t){return Ut(e)?e:new Sd(e,t)}class Sd{constructor(t,r){this.dep=new al,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:qe(t),this._value=r?t:Cr(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||vr(t)||Jr(t);t=n?t:qe(t),hn(t,r)&&(this._rawValue=t,this._value=n?t:Cr(t),this.dep.trigger())}}function Ad(e){return Ut(e)?e.value:e}const kd={get:(e,t,r)=>t==="__v_raw"?e:Ad(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const s=e[t];return Ut(s)&&!Ut(r)?(s.value=r,!0):Reflect.set(e,t,r,n)}};function Yu(e){return Pn(e)?e:new Proxy(e,kd)}class Cd{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new al(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ei-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&st!==this)return Uu(this,!0),!0}get value(){const t=this.dep.track();return Wu(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Od(e,t,r=!1){let n,s;return Ne(e)?n=e:(n=e.get,s=e.set),new Cd(n,s,r)}const Pi={},ta=new WeakMap;let An;function Rd(e,t=!1,r=An){if(r){let n=ta.get(r);n||ta.set(r,n=[]),n.push(e)}}function Id(e,t,r=rt){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:o,call:l}=r,c=O=>s?O:vr(O)||s===!1||s===0?Hr(O,1):Hr(O);let u,f,p,d,v=!1,h=!1;if(Ut(e)?(f=()=>e.value,v=vr(e)):Pn(e)?(f=()=>c(e),v=!0):De(e)?(h=!0,v=e.some(O=>Pn(O)||vr(O)),f=()=>e.map(O=>{if(Ut(O))return O.value;if(Pn(O))return c(O);if(Ne(O))return l?l(O,2):O()})):Ne(e)?t?f=l?()=>l(e,2):e:f=()=>{if(p){zr();try{p()}finally{Xr()}}const O=An;An=u;try{return l?l(e,3,[d]):e(d)}finally{An=O}}:f=Pr,t&&s){const O=f,B=s===!0?1/0:s;f=()=>Hr(O(),B)}const g=nd(),w=()=>{u.stop(),g&&g.active&&el(g.effects,u)};if(i&&t){const O=t;t=(...B)=>{O(...B),w()}}let E=h?new Array(e.length).fill(Pi):Pi;const _=O=>{if(!(!(u.flags&1)||!u.dirty&&!O))if(t){const B=u.run();if(s||v||(h?B.some((N,k)=>hn(N,E[k])):hn(B,E))){p&&p();const N=An;An=u;try{const k=[B,E===Pi?void 0:h&&E[0]===Pi?[]:E,d];E=B,l?l(t,3,k):t(...k)}finally{An=N}}}else u.run()};return o&&o(_),u=new Bu(f),u.scheduler=a?()=>a(_,!1):_,d=O=>Rd(O,!1,u),p=u.onStop=()=>{const O=ta.get(u);if(O){if(l)l(O,4);else for(const B of O)B();ta.delete(u)}},t?n?_(!0):E=u.run():a?a(_.bind(null,!0),!0):u.run(),w.pause=u.pause.bind(u),w.resume=u.resume.bind(u),w.stop=w,w}function Hr(e,t=1/0,r){if(t<=0||!it(e)||e.__v_skip||(r=r||new Map,(r.get(e)||0)>=t))return e;if(r.set(e,t),t--,Ut(e))Hr(e.value,t,r);else if(De(e))for(let n=0;n<e.length;n++)Hr(e[n],t,r);else if(Oa(e)||ls(e))e.forEach(n=>{Hr(n,t,r)});else if(Iu(e)){for(const n in e)Hr(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&Hr(e[n],t,r)}return e}function wi(e,t,r,n){try{return n?e(...n):e()}catch(s){Na(s,t,r)}}function Lr(e,t,r,n){if(Ne(e)){const s=wi(e,t,r,n);return s&&Ou(s)&&s.catch(i=>{Na(i,t,r)}),s}if(De(e)){const s=[];for(let i=0;i<e.length;i++)s.push(Lr(e[i],t,r,n));return s}}function Na(e,t,r,n=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||rt;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](e,l,c)===!1)return}o=o.parent}if(i){zr(),wi(i,null,10,[e,l,c]),Xr();return}}Fd(e,r,s,n,a)}function Fd(e,t,r,n=!0,s=!1){if(s)throw e;console.error(e)}const Gt=[];let Fr=-1;const cs=[];let an=null,es=0;const Qu=Promise.resolve();let ra=null;function Zu(e){const t=ra||Qu;return e?t.then(this?e.bind(this):e):t}function Dd(e){let t=Fr+1,r=Gt.length;for(;t<r;){const n=t+r>>>1,s=Gt[n],i=ri(s);i<e||i===e&&s.flags&2?t=n+1:r=n}return t}function fl(e){if(!(e.flags&1)){const t=ri(e),r=Gt[Gt.length-1];!r||!(e.flags&2)&&t>=ri(r)?Gt.push(e):Gt.splice(Dd(t),0,e),e.flags|=1,e0()}}function e0(){ra||(ra=Qu.then(r0))}function Pd(e){De(e)?cs.push(...e):an&&e.id===-1?an.splice(es+1,0,e):e.flags&1||(cs.push(e),e.flags|=1),e0()}function Kl(e,t,r=Fr+1){for(;r<Gt.length;r++){const n=Gt[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;Gt.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function t0(e){if(cs.length){const t=[...new Set(cs)].sort((r,n)=>ri(r)-ri(n));if(cs.length=0,an){an.push(...t);return}for(an=t,es=0;es<an.length;es++){const r=an[es];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}an=null,es=0}}const ri=e=>e.id==null?e.flags&2?-1:1/0:e.id;function r0(e){try{for(Fr=0;Fr<Gt.length;Fr++){const t=Gt[Fr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),wi(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Fr<Gt.length;Fr++){const t=Gt[Fr];t&&(t.flags&=-2)}Fr=-1,Gt.length=0,t0(),ra=null,(Gt.length||cs.length)&&r0()}}let gr=null,n0=null;function na(e){const t=gr;return gr=e,n0=e&&e.type.__scopeId||null,t}function Nd(e,t=gr,r){if(!t||e._n)return e;const n=(...s)=>{n._d&&tc(-1);const i=na(t);let a;try{a=e(...s)}finally{na(i),n._d&&tc(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Ke(e,t){if(gr===null)return e;const r=Ua(gr),n=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,a,o,l=rt]=t[s];i&&(Ne(i)&&(i={mounted:i,updated:i}),i.deep&&Hr(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return e}function yn(e,t,r,n){const s=e.dirs,i=t&&t.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let l=o.dir[n];l&&(zr(),Lr(l,r,8,[e.el,o,e,t]),Xr())}}function Ld(e,t){if(qt){let r=qt.provides;const n=qt.parent&&qt.parent.provides;n===r&&(r=qt.provides=Object.create(n)),r[e]=t}}function Yi(e,t,r=!1){const n=Lp();if(n||us){let s=us?us._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return r&&Ne(t)?t.call(n&&n.proxy):t}}const Bd=Symbol.for("v-scx"),Md=()=>Yi(Bd);function io(e,t,r){return s0(e,t,r)}function s0(e,t,r=rt){const{immediate:n,deep:s,flush:i,once:a}=r,o=Wt({},r),l=t&&n||!t&&i!=="post";let c;if(si){if(i==="sync"){const d=Md();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Pr,d.resume=Pr,d.pause=Pr,d}}const u=qt;o.call=(d,v,h)=>Lr(d,u,v,h);let f=!1;i==="post"?o.scheduler=d=>{nr(d,u&&u.suspense)}:i!=="sync"&&(f=!0,o.scheduler=(d,v)=>{v?d():fl(d)}),o.augmentJob=d=>{t&&(d.flags|=4),f&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const p=Id(e,t,o);return si&&(c?c.push(p):l&&p()),p}function Ud(e,t,r){const n=this.proxy,s=mt(e)?e.includes(".")?i0(n,e):()=>n[e]:e.bind(n,n);let i;Ne(t)?i=t:(i=t.handler,r=t);const a=yi(this),o=s0(s,i.bind(n),r);return a(),o}function i0(e,t){const r=t.split(".");return()=>{let n=e;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}const $d=Symbol("_vte"),jd=e=>e.__isTeleport,Wd=Symbol("_leaveCb");function hl(e,t){e.shapeFlag&6&&e.component?(e.transition=t,hl(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function a0(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const sa=new WeakMap;function Ws(e,t,r,n,s=!1){if(De(e)){e.forEach((v,h)=>Ws(v,t&&(De(t)?t[h]:t),r,n,s));return}if(Hs(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ws(e,t,r,n.component.subTree);return}const i=n.shapeFlag&4?Ua(n.component):n.el,a=s?null:i,{i:o,r:l}=e,c=t&&t.r,u=o.refs===rt?o.refs={}:o.refs,f=o.setupState,p=qe(f),d=f===rt?Cu:v=>ze(p,v);if(c!=null&&c!==l){if(Gl(t),mt(c))u[c]=null,d(c)&&(f[c]=null);else if(Ut(c)){c.value=null;const v=t;v.k&&(u[v.k]=null)}}if(Ne(l))wi(l,o,12,[a,u]);else{const v=mt(l),h=Ut(l);if(v||h){const g=()=>{if(e.f){const w=v?d(l)?f[l]:u[l]:l.value;if(s)De(w)&&el(w,i);else if(De(w))w.includes(i)||w.push(i);else if(v)u[l]=[i],d(l)&&(f[l]=u[l]);else{const E=[i];l.value=E,e.k&&(u[e.k]=E)}}else v?(u[l]=a,d(l)&&(f[l]=a)):h&&(l.value=a,e.k&&(u[e.k]=a))};if(a){const w=()=>{g(),sa.delete(e)};w.id=-1,sa.set(e,w),nr(w,r)}else Gl(e),g()}}}function Gl(e){const t=sa.get(e);t&&(t.flags|=8,sa.delete(e))}Fa().requestIdleCallback;Fa().cancelIdleCallback;const Hs=e=>!!e.type.__asyncLoader,o0=e=>e.type.__isKeepAlive;function Hd(e,t){l0(e,"a",t)}function Vd(e,t){l0(e,"da",t)}function l0(e,t,r=qt){const n=e.__wdc||(e.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(La(t,n,r),r){let s=r.parent;for(;s&&s.parent;)o0(s.parent.vnode)&&Kd(n,t,r,s),s=s.parent}}function Kd(e,t,r,n){const s=La(t,e,n,!0);u0(()=>{el(n[t],s)},r)}function La(e,t,r=qt,n=!1){if(r){const s=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{zr();const o=yi(r),l=Lr(t,r,e,a);return o(),Xr(),l});return n?s.unshift(i):s.push(i),i}}const Zr=e=>(t,r=qt)=>{(!si||e==="sp")&&La(e,(...n)=>t(...n),r)},Gd=Zr("bm"),c0=Zr("m"),qd=Zr("bu"),zd=Zr("u"),Xd=Zr("bum"),u0=Zr("um"),Jd=Zr("sp"),Yd=Zr("rtg"),Qd=Zr("rtc");function Zd(e,t=qt){La("ec",e,t)}const ep=Symbol.for("v-ndc");function ct(e,t,r,n){let s;const i=r,a=De(e);if(a||mt(e)){const o=a&&Pn(e);let l=!1,c=!1;o&&(l=!vr(e),c=Jr(e),e=Pa(e)),s=new Array(e.length);for(let u=0,f=e.length;u<f;u++)s[u]=t(l?c?ms(Cr(e[u])):Cr(e[u]):e[u],u,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let o=0;o<e;o++)s[o]=t(o+1,o,void 0,i)}else if(it(e))if(e[Symbol.iterator])s=Array.from(e,(o,l)=>t(o,l,void 0,i));else{const o=Object.keys(e);s=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];s[l]=t(e[u],u,l,i)}}else s=[];return s}const Fo=e=>e?R0(e)?Ua(e):Fo(e.parent):null,Vs=Wt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Fo(e.parent),$root:e=>Fo(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>h0(e),$forceUpdate:e=>e.f||(e.f=()=>{fl(e.update)}),$nextTick:e=>e.n||(e.n=Zu.bind(e.proxy)),$watch:e=>Ud.bind(e)}),ao=(e,t)=>e!==rt&&!e.__isScriptSetup&&ze(e,t),tp={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:l}=e;if(t[0]!=="$"){const p=a[t];if(p!==void 0)switch(p){case 1:return n[t];case 2:return s[t];case 4:return r[t];case 3:return i[t]}else{if(ao(n,t))return a[t]=1,n[t];if(s!==rt&&ze(s,t))return a[t]=2,s[t];if(ze(i,t))return a[t]=3,i[t];if(r!==rt&&ze(r,t))return a[t]=4,r[t];Do&&(a[t]=0)}}const c=Vs[t];let u,f;if(c)return t==="$attrs"&&Mt(e.attrs,"get",""),c(e);if((u=o.__cssModules)&&(u=u[t]))return u;if(r!==rt&&ze(r,t))return a[t]=4,r[t];if(f=l.config.globalProperties,ze(f,t))return f[t]},set({_:e},t,r){const{data:n,setupState:s,ctx:i}=e;return ao(s,t)?(s[t]=r,!0):n!==rt&&ze(n,t)?(n[t]=r,!0):ze(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:s,props:i,type:a}},o){let l;return!!(r[o]||e!==rt&&o[0]!=="$"&&ze(e,o)||ao(t,o)||ze(i,o)||ze(n,o)||ze(Vs,o)||ze(s.config.globalProperties,o)||(l=a.__cssModules)&&l[o])},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ze(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function ql(e){return De(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let Do=!0;function rp(e){const t=h0(e),r=e.proxy,n=e.ctx;Do=!1,t.beforeCreate&&zl(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:d,updated:v,activated:h,deactivated:g,beforeDestroy:w,beforeUnmount:E,destroyed:_,unmounted:O,render:B,renderTracked:N,renderTriggered:k,errorCaptured:K,serverPrefetch:P,expose:q,inheritAttrs:Q,components:ne,directives:ve,filters:je}=t;if(c&&np(c,n,null),a)for(const se in a){const we=a[se];Ne(we)&&(n[se]=we.bind(r))}if(s){const se=s.call(r,r);it(se)&&(e.data=ll(se))}if(Do=!0,i)for(const se in i){const we=i[se],ke=Ne(we)?we.bind(r,r):Ne(we.get)?we.get.bind(r,r):Pr,$e=!Ne(we)&&Ne(we.set)?we.set.bind(r):Pr,Se=yt({get:ke,set:$e});Object.defineProperty(n,se,{enumerable:!0,configurable:!0,get:()=>Se.value,set:R=>Se.value=R})}if(o)for(const se in o)f0(o[se],n,r,se);if(l){const se=Ne(l)?l.call(r):l;Reflect.ownKeys(se).forEach(we=>{Ld(we,se[we])})}u&&zl(u,e,"c");function te(se,we){De(we)?we.forEach(ke=>se(ke.bind(r))):we&&se(we.bind(r))}if(te(Gd,f),te(c0,p),te(qd,d),te(zd,v),te(Hd,h),te(Vd,g),te(Zd,K),te(Qd,N),te(Yd,k),te(Xd,E),te(u0,O),te(Jd,P),De(q))if(q.length){const se=e.exposed||(e.exposed={});q.forEach(we=>{Object.defineProperty(se,we,{get:()=>r[we],set:ke=>r[we]=ke,enumerable:!0})})}else e.exposed||(e.exposed={});B&&e.render===Pr&&(e.render=B),Q!=null&&(e.inheritAttrs=Q),ne&&(e.components=ne),ve&&(e.directives=ve),P&&a0(e)}function np(e,t,r=Pr){De(e)&&(e=Po(e));for(const n in e){const s=e[n];let i;it(s)?"default"in s?i=Yi(s.from||n,s.default,!0):i=Yi(s.from||n):i=Yi(s),Ut(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[n]=i}}function zl(e,t,r){Lr(De(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function f0(e,t,r,n){let s=n.includes(".")?i0(r,n):()=>r[n];if(mt(e)){const i=t[e];Ne(i)&&io(s,i)}else if(Ne(e))io(s,e.bind(r));else if(it(e))if(De(e))e.forEach(i=>f0(i,t,r,n));else{const i=Ne(e.handler)?e.handler.bind(r):t[e.handler];Ne(i)&&io(s,i,e)}}function h0(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,o=i.get(t);let l;return o?l=o:!s.length&&!r&&!n?l=t:(l={},s.length&&s.forEach(c=>ia(l,c,a,!0)),ia(l,t,a)),it(t)&&i.set(t,l),l}function ia(e,t,r,n=!1){const{mixins:s,extends:i}=t;i&&ia(e,i,r,!0),s&&s.forEach(a=>ia(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const o=sp[a]||r&&r[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const sp={data:Xl,props:Jl,emits:Jl,methods:Ls,computed:Ls,beforeCreate:Ht,created:Ht,beforeMount:Ht,mounted:Ht,beforeUpdate:Ht,updated:Ht,beforeDestroy:Ht,beforeUnmount:Ht,destroyed:Ht,unmounted:Ht,activated:Ht,deactivated:Ht,errorCaptured:Ht,serverPrefetch:Ht,components:Ls,directives:Ls,watch:ap,provide:Xl,inject:ip};function Xl(e,t){return t?e?function(){return Wt(Ne(e)?e.call(this,this):e,Ne(t)?t.call(this,this):t)}:t:e}function ip(e,t){return Ls(Po(e),Po(t))}function Po(e){if(De(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Ht(e,t){return e?[...new Set([].concat(e,t))]:t}function Ls(e,t){return e?Wt(Object.create(null),e,t):t}function Jl(e,t){return e?De(e)&&De(t)?[...new Set([...e,...t])]:Wt(Object.create(null),ql(e),ql(t??{})):t}function ap(e,t){if(!e)return t;if(!t)return e;const r=Wt(Object.create(null),e);for(const n in t)r[n]=Ht(e[n],t[n]);return r}function d0(){return{app:null,config:{isNativeTag:Cu,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let op=0;function lp(e,t){return function(n,s=null){Ne(n)||(n=Wt({},n)),s!=null&&!it(s)&&(s=null);const i=d0(),a=new WeakSet,o=[];let l=!1;const c=i.app={_uid:op++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:Wp,get config(){return i.config},set config(u){},use(u,...f){return a.has(u)||(u&&Ne(u.install)?(a.add(u),u.install(c,...f)):Ne(u)&&(a.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,p){if(!l){const d=c._ceVNode||Rt(n,s);return d.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),e(d,u,p),l=!0,c._container=u,u.__vue_app__=c,Ua(d.component)}},onUnmount(u){o.push(u)},unmount(){l&&(Lr(o,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=us;us=c;try{return u()}finally{us=f}}};return c}}let us=null;const cp=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${dn(t)}Modifiers`]||e[`${xn(t)}Modifiers`];function up(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||rt;let s=r;const i=t.startsWith("update:"),a=i&&cp(n,t.slice(7));a&&(a.trim&&(s=r.map(u=>mt(u)?u.trim():u)),a.number&&(s=r.map(Ia)));let o,l=n[o=eo(t)]||n[o=eo(dn(t))];!l&&i&&(l=n[o=eo(xn(t))]),l&&Lr(l,e,6,s);const c=n[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Lr(c,e,6,s)}}const fp=new WeakMap;function p0(e,t,r=!1){const n=r?fp:t.emitsCache,s=n.get(e);if(s!==void 0)return s;const i=e.emits;let a={},o=!1;if(!Ne(e)){const l=c=>{const u=p0(c,t,!0);u&&(o=!0,Wt(a,u))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!i&&!o?(it(e)&&n.set(e,null),null):(De(i)?i.forEach(l=>a[l]=null):Wt(a,i),it(e)&&n.set(e,a),a)}function Ba(e,t){return!e||!Ca(t)?!1:(t=t.slice(2).replace(/Once$/,""),ze(e,t[0].toLowerCase()+t.slice(1))||ze(e,xn(t))||ze(e,t))}function Yl(e){const{type:t,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:p,setupState:d,ctx:v,inheritAttrs:h}=e,g=na(e);let w,E;try{if(r.shapeFlag&4){const O=s||n,B=O;w=Dr(c.call(B,O,u,f,d,p,v)),E=o}else{const O=t;w=Dr(O.length>1?O(f,{attrs:o,slots:a,emit:l}):O(f,null)),E=t.props?o:hp(o)}}catch(O){Ks.length=0,Na(O,e,1),w=Rt(pn)}let _=w;if(E&&h!==!1){const O=Object.keys(E),{shapeFlag:B}=_;O.length&&B&7&&(i&&O.some(Zo)&&(E=dp(E,i)),_=xs(_,E,!1,!0))}return r.dirs&&(_=xs(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(r.dirs):r.dirs),r.transition&&hl(_,r.transition),w=_,na(g),w}const hp=e=>{let t;for(const r in e)(r==="class"||r==="style"||Ca(r))&&((t||(t={}))[r]=e[r]);return t},dp=(e,t)=>{const r={};for(const n in e)(!Zo(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function pp(e,t,r){const{props:n,children:s,component:i}=e,{props:a,children:o,patchFlag:l}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?Ql(n,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let f=0;f<u.length;f++){const p=u[f];if(a[p]!==n[p]&&!Ba(c,p))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?Ql(n,a,c):!0:!!a;return!1}function Ql(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(t[i]!==e[i]&&!Ba(r,i))return!0}return!1}function gp({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const g0={},v0=()=>Object.create(g0),m0=e=>Object.getPrototypeOf(e)===g0;function vp(e,t,r,n=!1){const s={},i=v0();e.propsDefaults=Object.create(null),x0(e,t,s,i);for(const a in e.propsOptions[0])a in s||(s[a]=void 0);r?e.props=n?s:Ed(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function mp(e,t,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=e,o=qe(s),[l]=e.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let f=0;f<u.length;f++){let p=u[f];if(Ba(e.emitsOptions,p))continue;const d=t[p];if(l)if(ze(i,p))d!==i[p]&&(i[p]=d,c=!0);else{const v=dn(p);s[v]=No(l,o,v,d,e,!1)}else d!==i[p]&&(i[p]=d,c=!0)}}}else{x0(e,t,s,i)&&(c=!0);let u;for(const f in o)(!t||!ze(t,f)&&((u=xn(f))===f||!ze(t,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(s[f]=No(l,o,f,void 0,e,!0)):delete s[f]);if(i!==o)for(const f in i)(!t||!ze(t,f))&&(delete i[f],c=!0)}c&&Wr(e.attrs,"set","")}function x0(e,t,r,n){const[s,i]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(Us(l))continue;const c=t[l];let u;s&&ze(s,u=dn(l))?!i||!i.includes(u)?r[u]=c:(o||(o={}))[u]=c:Ba(e.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(i){const l=qe(r),c=o||rt;for(let u=0;u<i.length;u++){const f=i[u];r[f]=No(s,l,f,c[f],e,!ze(c,f))}}return a}function No(e,t,r,n,s,i){const a=e[r];if(a!=null){const o=ze(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&Ne(l)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const u=yi(s);n=c[r]=l.call(null,t),u()}}else n=l;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===xn(r))&&(n=!0))}return n}const xp=new WeakMap;function _0(e,t,r=!1){const n=r?xp:t.propsCache,s=n.get(e);if(s)return s;const i=e.props,a={},o=[];let l=!1;if(!Ne(e)){const u=f=>{l=!0;const[p,d]=_0(f,t,!0);Wt(a,p),d&&o.push(...d)};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!i&&!l)return it(e)&&n.set(e,os),os;if(De(i))for(let u=0;u<i.length;u++){const f=dn(i[u]);Zl(f)&&(a[f]=rt)}else if(i)for(const u in i){const f=dn(u);if(Zl(f)){const p=i[u],d=a[f]=De(p)||Ne(p)?{type:p}:Wt({},p),v=d.type;let h=!1,g=!0;if(De(v))for(let w=0;w<v.length;++w){const E=v[w],_=Ne(E)&&E.name;if(_==="Boolean"){h=!0;break}else _==="String"&&(g=!1)}else h=Ne(v)&&v.name==="Boolean";d[0]=h,d[1]=g,(h||ze(d,"default"))&&o.push(f)}}const c=[a,o];return it(e)&&n.set(e,c),c}function Zl(e){return e[0]!=="$"&&!Us(e)}const dl=e=>e==="_"||e==="_ctx"||e==="$stable",pl=e=>De(e)?e.map(Dr):[Dr(e)],_p=(e,t,r)=>{if(t._n)return t;const n=Nd((...s)=>pl(t(...s)),r);return n._c=!1,n},w0=(e,t,r)=>{const n=e._ctx;for(const s in e){if(dl(s))continue;const i=e[s];if(Ne(i))t[s]=_p(s,i,n);else if(i!=null){const a=pl(i);t[s]=()=>a}}},y0=(e,t)=>{const r=pl(t);e.slots.default=()=>r},E0=(e,t,r)=>{for(const n in t)(r||!dl(n))&&(e[n]=t[n])},wp=(e,t,r)=>{const n=e.slots=v0();if(e.vnode.shapeFlag&32){const s=t._;s?(E0(n,t,r),r&&Du(n,"_",s,!0)):w0(t,n)}else t&&y0(e,t)},yp=(e,t,r)=>{const{vnode:n,slots:s}=e;let i=!0,a=rt;if(n.shapeFlag&32){const o=t._;o?r&&o===1?i=!1:E0(s,t,r):(i=!t.$stable,w0(t,s)),a=t}else t&&(y0(e,t),a={default:1});if(i)for(const o in s)!dl(o)&&a[o]==null&&delete s[o]},nr=Ap;function Ep(e){return Tp(e)}function Tp(e,t){const r=Fa();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:p,setScopeId:d=Pr,insertStaticContent:v}=e,h=(A,I,M,ee=null,z=null,L=null,fe=void 0,le=null,ae=!!I.dynamicChildren)=>{if(A===I)return;A&&!Is(A,I)&&(ee=_e(A),R(A,z,L,!0),A=null),I.patchFlag===-2&&(ae=!1,I.dynamicChildren=null);const{type:re,ref:Oe,shapeFlag:me}=I;switch(re){case Ma:g(A,I,M,ee);break;case pn:w(A,I,M,ee);break;case Qi:A==null&&E(I,M,ee,fe);break;case We:ne(A,I,M,ee,z,L,fe,le,ae);break;default:me&1?B(A,I,M,ee,z,L,fe,le,ae):me&6?ve(A,I,M,ee,z,L,fe,le,ae):(me&64||me&128)&&re.process(A,I,M,ee,z,L,fe,le,ae,pe)}Oe!=null&&z?Ws(Oe,A&&A.ref,L,I||A,!I):Oe==null&&A&&A.ref!=null&&Ws(A.ref,null,L,A,!0)},g=(A,I,M,ee)=>{if(A==null)n(I.el=o(I.children),M,ee);else{const z=I.el=A.el;I.children!==A.children&&c(z,I.children)}},w=(A,I,M,ee)=>{A==null?n(I.el=l(I.children||""),M,ee):I.el=A.el},E=(A,I,M,ee)=>{[A.el,A.anchor]=v(A.children,I,M,ee,A.el,A.anchor)},_=({el:A,anchor:I},M,ee)=>{let z;for(;A&&A!==I;)z=p(A),n(A,M,ee),A=z;n(I,M,ee)},O=({el:A,anchor:I})=>{let M;for(;A&&A!==I;)M=p(A),s(A),A=M;s(I)},B=(A,I,M,ee,z,L,fe,le,ae)=>{if(I.type==="svg"?fe="svg":I.type==="math"&&(fe="mathml"),A==null)N(I,M,ee,z,L,fe,le,ae);else{const re=A.el&&A.el._isVueCE?A.el:null;try{re&&re._beginPatch(),P(A,I,z,L,fe,le,ae)}finally{re&&re._endPatch()}}},N=(A,I,M,ee,z,L,fe,le)=>{let ae,re;const{props:Oe,shapeFlag:me,transition:Te,dirs:Re}=A;if(ae=A.el=a(A.type,L,Oe&&Oe.is,Oe),me&8?u(ae,A.children):me&16&&K(A.children,ae,null,ee,z,oo(A,L),fe,le),Re&&yn(A,null,ee,"created"),k(ae,A,A.scopeId,fe,ee),Oe){for(const Ge in Oe)Ge!=="value"&&!Us(Ge)&&i(ae,Ge,null,Oe[Ge],L,ee);"value"in Oe&&i(ae,"value",null,Oe.value,L),(re=Oe.onVnodeBeforeMount)&&Or(re,ee,A)}Re&&yn(A,null,ee,"beforeMount");const Me=bp(z,Te);Me&&Te.beforeEnter(ae),n(ae,I,M),((re=Oe&&Oe.onVnodeMounted)||Me||Re)&&nr(()=>{re&&Or(re,ee,A),Me&&Te.enter(ae),Re&&yn(A,null,ee,"mounted")},z)},k=(A,I,M,ee,z)=>{if(M&&d(A,M),ee)for(let L=0;L<ee.length;L++)d(A,ee[L]);if(z){let L=z.subTree;if(I===L||A0(L.type)&&(L.ssContent===I||L.ssFallback===I)){const fe=z.vnode;k(A,fe,fe.scopeId,fe.slotScopeIds,z.parent)}}},K=(A,I,M,ee,z,L,fe,le,ae=0)=>{for(let re=ae;re<A.length;re++){const Oe=A[re]=le?on(A[re]):Dr(A[re]);h(null,Oe,I,M,ee,z,L,fe,le)}},P=(A,I,M,ee,z,L,fe)=>{const le=I.el=A.el;let{patchFlag:ae,dynamicChildren:re,dirs:Oe}=I;ae|=A.patchFlag&16;const me=A.props||rt,Te=I.props||rt;let Re;if(M&&En(M,!1),(Re=Te.onVnodeBeforeUpdate)&&Or(Re,M,I,A),Oe&&yn(I,A,M,"beforeUpdate"),M&&En(M,!0),(me.innerHTML&&Te.innerHTML==null||me.textContent&&Te.textContent==null)&&u(le,""),re?q(A.dynamicChildren,re,le,M,ee,oo(I,z),L):fe||we(A,I,le,null,M,ee,oo(I,z),L,!1),ae>0){if(ae&16)Q(le,me,Te,M,z);else if(ae&2&&me.class!==Te.class&&i(le,"class",null,Te.class,z),ae&4&&i(le,"style",me.style,Te.style,z),ae&8){const Me=I.dynamicProps;for(let Ge=0;Ge<Me.length;Ge++){const Ue=Me[Ge],Nt=me[Ue],St=Te[Ue];(St!==Nt||Ue==="value")&&i(le,Ue,Nt,St,z,M)}}ae&1&&A.children!==I.children&&u(le,I.children)}else!fe&&re==null&&Q(le,me,Te,M,z);((Re=Te.onVnodeUpdated)||Oe)&&nr(()=>{Re&&Or(Re,M,I,A),Oe&&yn(I,A,M,"updated")},ee)},q=(A,I,M,ee,z,L,fe)=>{for(let le=0;le<I.length;le++){const ae=A[le],re=I[le],Oe=ae.el&&(ae.type===We||!Is(ae,re)||ae.shapeFlag&198)?f(ae.el):M;h(ae,re,Oe,null,ee,z,L,fe,!0)}},Q=(A,I,M,ee,z)=>{if(I!==M){if(I!==rt)for(const L in I)!Us(L)&&!(L in M)&&i(A,L,I[L],null,z,ee);for(const L in M){if(Us(L))continue;const fe=M[L],le=I[L];fe!==le&&L!=="value"&&i(A,L,le,fe,z,ee)}"value"in M&&i(A,"value",I.value,M.value,z)}},ne=(A,I,M,ee,z,L,fe,le,ae)=>{const re=I.el=A?A.el:o(""),Oe=I.anchor=A?A.anchor:o("");let{patchFlag:me,dynamicChildren:Te,slotScopeIds:Re}=I;Re&&(le=le?le.concat(Re):Re),A==null?(n(re,M,ee),n(Oe,M,ee),K(I.children||[],M,Oe,z,L,fe,le,ae)):me>0&&me&64&&Te&&A.dynamicChildren&&A.dynamicChildren.length===Te.length?(q(A.dynamicChildren,Te,M,z,L,fe,le),(I.key!=null||z&&I===z.subTree)&&T0(A,I,!0)):we(A,I,M,Oe,z,L,fe,le,ae)},ve=(A,I,M,ee,z,L,fe,le,ae)=>{I.slotScopeIds=le,A==null?I.shapeFlag&512?z.ctx.activate(I,M,ee,fe,ae):je(I,M,ee,z,L,fe,ae):J(A,I,ae)},je=(A,I,M,ee,z,L,fe)=>{const le=A.component=Np(A,ee,z);if(o0(A)&&(le.ctx.renderer=pe),Bp(le,!1,fe),le.asyncDep){if(z&&z.registerDep(le,te,fe),!A.el){const ae=le.subTree=Rt(pn);w(null,ae,I,M),A.placeholder=ae.el}}else te(le,A,I,M,z,L,fe)},J=(A,I,M)=>{const ee=I.component=A.component;if(pp(A,I,M))if(ee.asyncDep&&!ee.asyncResolved){se(ee,I,M);return}else ee.next=I,ee.update();else I.el=A.el,ee.vnode=I},te=(A,I,M,ee,z,L,fe)=>{const le=()=>{if(A.isMounted){let{next:me,bu:Te,u:Re,parent:Me,vnode:Ge}=A;{const tr=b0(A);if(tr){me&&(me.el=Ge.el,se(A,me,fe)),tr.asyncDep.then(()=>{A.isUnmounted||le()});return}}let Ue=me,Nt;En(A,!1),me?(me.el=Ge.el,se(A,me,fe)):me=Ge,Te&&Ji(Te),(Nt=me.props&&me.props.onVnodeBeforeUpdate)&&Or(Nt,Me,me,Ge),En(A,!0);const St=Yl(A),er=A.subTree;A.subTree=St,h(er,St,f(er.el),_e(er),A,z,L),me.el=St.el,Ue===null&&gp(A,St.el),Re&&nr(Re,z),(Nt=me.props&&me.props.onVnodeUpdated)&&nr(()=>Or(Nt,Me,me,Ge),z)}else{let me;const{el:Te,props:Re}=I,{bm:Me,m:Ge,parent:Ue,root:Nt,type:St}=A,er=Hs(I);En(A,!1),Me&&Ji(Me),!er&&(me=Re&&Re.onVnodeBeforeMount)&&Or(me,Ue,I),En(A,!0);{Nt.ce&&Nt.ce._def.shadowRoot!==!1&&Nt.ce._injectChildStyle(St);const tr=A.subTree=Yl(A);h(null,tr,M,ee,A,z,L),I.el=tr.el}if(Ge&&nr(Ge,z),!er&&(me=Re&&Re.onVnodeMounted)){const tr=I;nr(()=>Or(me,Ue,tr),z)}(I.shapeFlag&256||Ue&&Hs(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&A.a&&nr(A.a,z),A.isMounted=!0,I=M=ee=null}};A.scope.on();const ae=A.effect=new Bu(le);A.scope.off();const re=A.update=ae.run.bind(ae),Oe=A.job=ae.runIfDirty.bind(ae);Oe.i=A,Oe.id=A.uid,ae.scheduler=()=>fl(Oe),En(A,!0),re()},se=(A,I,M)=>{I.component=A;const ee=A.vnode.props;A.vnode=I,A.next=null,mp(A,I.props,ee,M),yp(A,I.children,M),zr(),Kl(A),Xr()},we=(A,I,M,ee,z,L,fe,le,ae=!1)=>{const re=A&&A.children,Oe=A?A.shapeFlag:0,me=I.children,{patchFlag:Te,shapeFlag:Re}=I;if(Te>0){if(Te&128){$e(re,me,M,ee,z,L,fe,le,ae);return}else if(Te&256){ke(re,me,M,ee,z,L,fe,le,ae);return}}Re&8?(Oe&16&&Y(re,z,L),me!==re&&u(M,me)):Oe&16?Re&16?$e(re,me,M,ee,z,L,fe,le,ae):Y(re,z,L,!0):(Oe&8&&u(M,""),Re&16&&K(me,M,ee,z,L,fe,le,ae))},ke=(A,I,M,ee,z,L,fe,le,ae)=>{A=A||os,I=I||os;const re=A.length,Oe=I.length,me=Math.min(re,Oe);let Te;for(Te=0;Te<me;Te++){const Re=I[Te]=ae?on(I[Te]):Dr(I[Te]);h(A[Te],Re,M,null,z,L,fe,le,ae)}re>Oe?Y(A,z,L,!0,!1,me):K(I,M,ee,z,L,fe,le,ae,me)},$e=(A,I,M,ee,z,L,fe,le,ae)=>{let re=0;const Oe=I.length;let me=A.length-1,Te=Oe-1;for(;re<=me&&re<=Te;){const Re=A[re],Me=I[re]=ae?on(I[re]):Dr(I[re]);if(Is(Re,Me))h(Re,Me,M,null,z,L,fe,le,ae);else break;re++}for(;re<=me&&re<=Te;){const Re=A[me],Me=I[Te]=ae?on(I[Te]):Dr(I[Te]);if(Is(Re,Me))h(Re,Me,M,null,z,L,fe,le,ae);else break;me--,Te--}if(re>me){if(re<=Te){const Re=Te+1,Me=Re<Oe?I[Re].el:ee;for(;re<=Te;)h(null,I[re]=ae?on(I[re]):Dr(I[re]),M,Me,z,L,fe,le,ae),re++}}else if(re>Te)for(;re<=me;)R(A[re],z,L,!0),re++;else{const Re=re,Me=re,Ge=new Map;for(re=Me;re<=Te;re++){const Lt=I[re]=ae?on(I[re]):Dr(I[re]);Lt.key!=null&&Ge.set(Lt.key,re)}let Ue,Nt=0;const St=Te-Me+1;let er=!1,tr=0;const rn=new Array(St);for(re=0;re<St;re++)rn[re]=0;for(re=Re;re<=me;re++){const Lt=A[re];if(Nt>=St){R(Lt,z,L,!0);continue}let hr;if(Lt.key!=null)hr=Ge.get(Lt.key);else for(Ue=Me;Ue<=Te;Ue++)if(rn[Ue-Me]===0&&Is(Lt,I[Ue])){hr=Ue;break}hr===void 0?R(Lt,z,L,!0):(rn[hr-Me]=re+1,hr>=tr?tr=hr:er=!0,h(Lt,I[hr],M,null,z,L,fe,le,ae),Nt++)}const Ss=er?Sp(rn):os;for(Ue=Ss.length-1,re=St-1;re>=0;re--){const Lt=Me+re,hr=I[Lt],Ri=I[Lt+1],As=Lt+1<Oe?Ri.el||S0(Ri):ee;rn[re]===0?h(null,hr,M,As,z,L,fe,le,ae):er&&(Ue<0||re!==Ss[Ue]?Se(hr,M,As,2):Ue--)}}},Se=(A,I,M,ee,z=null)=>{const{el:L,type:fe,transition:le,children:ae,shapeFlag:re}=A;if(re&6){Se(A.component.subTree,I,M,ee);return}if(re&128){A.suspense.move(I,M,ee);return}if(re&64){fe.move(A,I,M,pe);return}if(fe===We){n(L,I,M);for(let me=0;me<ae.length;me++)Se(ae[me],I,M,ee);n(A.anchor,I,M);return}if(fe===Qi){_(A,I,M);return}if(ee!==2&&re&1&&le)if(ee===0)le.beforeEnter(L),n(L,I,M),nr(()=>le.enter(L),z);else{const{leave:me,delayLeave:Te,afterLeave:Re}=le,Me=()=>{A.ctx.isUnmounted?s(L):n(L,I,M)},Ge=()=>{L._isLeaving&&L[Wd](!0),me(L,()=>{Me(),Re&&Re()})};Te?Te(L,Me,Ge):Ge()}else n(L,I,M)},R=(A,I,M,ee=!1,z=!1)=>{const{type:L,props:fe,ref:le,children:ae,dynamicChildren:re,shapeFlag:Oe,patchFlag:me,dirs:Te,cacheIndex:Re}=A;if(me===-2&&(z=!1),le!=null&&(zr(),Ws(le,null,M,A,!0),Xr()),Re!=null&&(I.renderCache[Re]=void 0),Oe&256){I.ctx.deactivate(A);return}const Me=Oe&1&&Te,Ge=!Hs(A);let Ue;if(Ge&&(Ue=fe&&fe.onVnodeBeforeUnmount)&&Or(Ue,I,A),Oe&6)D(A.component,M,ee);else{if(Oe&128){A.suspense.unmount(M,ee);return}Me&&yn(A,null,I,"beforeUnmount"),Oe&64?A.type.remove(A,I,M,pe,ee):re&&!re.hasOnce&&(L!==We||me>0&&me&64)?Y(re,I,M,!1,!0):(L===We&&me&384||!z&&Oe&16)&&Y(ae,I,M),ee&&U(A)}(Ge&&(Ue=fe&&fe.onVnodeUnmounted)||Me)&&nr(()=>{Ue&&Or(Ue,I,A),Me&&yn(A,null,I,"unmounted")},M)},U=A=>{const{type:I,el:M,anchor:ee,transition:z}=A;if(I===We){F(M,ee);return}if(I===Qi){O(A);return}const L=()=>{s(M),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(A.shapeFlag&1&&z&&!z.persisted){const{leave:fe,delayLeave:le}=z,ae=()=>fe(M,L);le?le(A.el,L,ae):ae()}else L()},F=(A,I)=>{let M;for(;A!==I;)M=p(A),s(A),A=M;s(I)},D=(A,I,M)=>{const{bum:ee,scope:z,job:L,subTree:fe,um:le,m:ae,a:re}=A;ec(ae),ec(re),ee&&Ji(ee),z.stop(),L&&(L.flags|=8,R(fe,A,I,M)),le&&nr(le,I),nr(()=>{A.isUnmounted=!0},I)},Y=(A,I,M,ee=!1,z=!1,L=0)=>{for(let fe=L;fe<A.length;fe++)R(A[fe],I,M,ee,z)},_e=A=>{if(A.shapeFlag&6)return _e(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const I=p(A.anchor||A.el),M=I&&I[$d];return M?p(M):I};let Ae=!1;const Ee=(A,I,M)=>{let ee;A==null?I._vnode&&(R(I._vnode,null,null,!0),ee=I._vnode.component):h(I._vnode||null,A,I,null,null,null,M),I._vnode=A,Ae||(Ae=!0,Kl(ee),t0(),Ae=!1)},pe={p:h,um:R,m:Se,r:U,mt:je,mc:K,pc:we,pbc:q,n:_e,o:e};return{render:Ee,hydrate:void 0,createApp:lp(Ee)}}function oo({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function En({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function bp(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function T0(e,t,r=!1){const n=e.children,s=t.children;if(De(n)&&De(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=on(s[i]),o.el=a.el),!r&&o.patchFlag!==-2&&T0(a,o)),o.type===Ma&&(o.patchFlag!==-1?o.el=a.el:o.__elIndex=i+(e.type===We?1:0)),o.type===pn&&!o.el&&(o.el=a.el)}}function Sp(e){const t=e.slice(),r=[0];let n,s,i,a,o;const l=e.length;for(n=0;n<l;n++){const c=e[n];if(c!==0){if(s=r[r.length-1],e[s]<c){t[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,e[r[o]]<c?i=o+1:a=o;c<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}function b0(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:b0(t)}function ec(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function S0(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?S0(t.subTree):null}const A0=e=>e.__isSuspense;function Ap(e,t){t&&t.pendingBranch?De(e)?t.effects.push(...e):t.effects.push(e):Pd(e)}const We=Symbol.for("v-fgt"),Ma=Symbol.for("v-txt"),pn=Symbol.for("v-cmt"),Qi=Symbol.for("v-stc"),Ks=[];let cr=null;function oe(e=!1){Ks.push(cr=e?null:[])}function kp(){Ks.pop(),cr=Ks[Ks.length-1]||null}let ni=1;function tc(e,t=!1){ni+=e,e<0&&cr&&t&&(cr.hasOnce=!0)}function k0(e){return e.dynamicChildren=ni>0?cr||os:null,kp(),ni>0&&cr&&cr.push(e),e}function ce(e,t,r,n,s,i){return k0(x(e,t,r,n,s,i,!0))}function Cp(e,t,r,n,s){return k0(Rt(e,t,r,n,s,!0))}function C0(e){return e?e.__v_isVNode===!0:!1}function Is(e,t){return e.type===t.type&&e.key===t.key}const O0=({key:e})=>e??null,Zi=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?mt(e)||Ut(e)||Ne(e)?{i:gr,r:e,k:t,f:!!r}:e:null);function x(e,t=null,r=null,n=0,s=null,i=e===We?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&O0(t),ref:t&&Zi(t),scopeId:n0,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:gr};return o?(gl(l,r),i&128&&e.normalize(l)):r&&(l.shapeFlag|=mt(r)?8:16),ni>0&&!a&&cr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&cr.push(l),l}const Rt=Op;function Op(e,t=null,r=null,n=0,s=null,i=!1){if((!e||e===ep)&&(e=pn),C0(e)){const o=xs(e,t,!0);return r&&gl(o,r),ni>0&&!i&&cr&&(o.shapeFlag&6?cr[cr.indexOf(e)]=o:cr.push(o)),o.patchFlag=-2,o}if(jp(e)&&(e=e.__vccOpts),t){t=Rp(t);let{class:o,style:l}=t;o&&!mt(o)&&(t.class=qr(o)),it(l)&&(ul(l)&&!De(l)&&(l=Wt({},l)),t.style=rl(l))}const a=mt(e)?1:A0(e)?128:jd(e)?64:it(e)?4:Ne(e)?2:0;return x(e,t,r,n,s,a,i,!0)}function Rp(e){return e?ul(e)||m0(e)?Wt({},e):e:null}function xs(e,t,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:o,transition:l}=e,c=t?Fp(s||{},t):s,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&O0(c),ref:t&&t.ref?r&&i?De(i)?i.concat(Zi(t)):[i,Zi(t)]:Zi(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==We?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&xs(e.ssContent),ssFallback:e.ssFallback&&xs(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&hl(u,l.clone(u)),u}function ur(e=" ",t=0){return Rt(Ma,null,e,t)}function Ip(e,t){const r=Rt(Qi,null,e);return r.staticCount=t,r}function dt(e="",t=!1){return t?(oe(),Cp(pn,null,e)):Rt(pn,null,e)}function Dr(e){return e==null||typeof e=="boolean"?Rt(pn):De(e)?Rt(We,null,e.slice()):C0(e)?on(e):Rt(Ma,null,String(e))}function on(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:xs(e)}function gl(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(De(t))r=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),gl(e,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!m0(t)?t._ctx=gr:s===3&&gr&&(gr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Ne(t)?(t={default:t,_ctx:gr},r=32):(t=String(t),n&64?(r=16,t=[ur(t)]):r=8);e.children=t,e.shapeFlag|=r}function Fp(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=qr([t.class,n.class]));else if(s==="style")t.style=rl([t.style,n.style]);else if(Ca(s)){const i=t[s],a=n[s];a&&i!==a&&!(De(i)&&i.includes(a))&&(t[s]=i?[].concat(i,a):a)}else s!==""&&(t[s]=n[s])}return t}function Or(e,t,r,n=null){Lr(e,t,7,[r,n])}const Dp=d0();let Pp=0;function Np(e,t,r){const n=e.type,s=(t?t.appContext:e.appContext)||Dp,i={uid:Pp++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new rd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_0(n,s),emitsOptions:p0(n,s),emit:null,emitted:null,propsDefaults:rt,inheritAttrs:n.inheritAttrs,ctx:rt,data:rt,props:rt,attrs:rt,slots:rt,refs:rt,setupState:rt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=up.bind(null,i),e.ce&&e.ce(i),i}let qt=null;const Lp=()=>qt||gr;let aa,Lo;{const e=Fa(),t=(r,n)=>{let s;return(s=e[r])||(s=e[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};aa=t("__VUE_INSTANCE_SETTERS__",r=>qt=r),Lo=t("__VUE_SSR_SETTERS__",r=>si=r)}const yi=e=>{const t=qt;return aa(e),e.scope.on(),()=>{e.scope.off(),aa(t)}},rc=()=>{qt&&qt.scope.off(),aa(null)};function R0(e){return e.vnode.shapeFlag&4}let si=!1;function Bp(e,t=!1,r=!1){t&&Lo(t);const{props:n,children:s}=e.vnode,i=R0(e);vp(e,n,i,t),wp(e,s,r||t);const a=i?Mp(e,t):void 0;return t&&Lo(!1),a}function Mp(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,tp);const{setup:n}=r;if(n){zr();const s=e.setupContext=n.length>1?$p(e):null,i=yi(e),a=wi(n,e,0,[e.props,s]),o=Ou(a);if(Xr(),i(),(o||e.sp)&&!Hs(e)&&a0(e),o){if(a.then(rc,rc),t)return a.then(l=>{nc(e,l)}).catch(l=>{Na(l,e,0)});e.asyncDep=a}else nc(e,a)}else I0(e)}function nc(e,t,r){Ne(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:it(t)&&(e.setupState=Yu(t)),I0(e)}function I0(e,t,r){const n=e.type;e.render||(e.render=n.render||Pr);{const s=yi(e);zr();try{rp(e)}finally{Xr(),s()}}}const Up={get(e,t){return Mt(e,"get",""),e[t]}};function $p(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,Up),slots:e.slots,emit:e.emit,expose:t}}function Ua(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Yu(Td(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Vs)return Vs[r](e)},has(t,r){return r in t||r in Vs}})):e.proxy}function jp(e){return Ne(e)&&"__vccOpts"in e}const yt=(e,t)=>Od(e,t,si),Wp="3.5.27";let Bo;const sc=typeof window<"u"&&window.trustedTypes;if(sc)try{Bo=sc.createPolicy("vue",{createHTML:e=>e})}catch{}const F0=Bo?e=>Bo.createHTML(e):e=>e,Hp="http://www.w3.org/2000/svg",Vp="http://www.w3.org/1998/Math/MathML",$r=typeof document<"u"?document:null,ic=$r&&$r.createElement("template"),Kp={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const s=t==="svg"?$r.createElementNS(Hp,e):t==="mathml"?$r.createElementNS(Vp,e):r?$r.createElement(e,{is:r}):$r.createElement(e);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>$r.createTextNode(e),createComment:e=>$r.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>$r.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,s,i){const a=r?r.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{ic.innerHTML=F0(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const o=ic.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Gp=Symbol("_vtc");function qp(e,t,r){const n=e[Gp];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const oa=Symbol("_vod"),D0=Symbol("_vsh"),Fs={name:"show",beforeMount(e,{value:t},{transition:r}){e[oa]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Ds(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),Ds(e,!0),n.enter(e)):n.leave(e,()=>{Ds(e,!1)}):Ds(e,t))},beforeUnmount(e,{value:t}){Ds(e,t)}};function Ds(e,t){e.style.display=t?e[oa]:"none",e[D0]=!t}const zp=Symbol(""),Xp=/(?:^|;)\s*display\s*:/;function Jp(e,t,r){const n=e.style,s=mt(r);let i=!1;if(r&&!s){if(t)if(mt(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&ea(n,o,"")}else for(const a in t)r[a]==null&&ea(n,a,"");for(const a in r)a==="display"&&(i=!0),ea(n,a,r[a])}else if(s){if(t!==r){const a=n[zp];a&&(r+=";"+a),n.cssText=r,i=Xp.test(r)}}else t&&e.removeAttribute("style");oa in e&&(e[oa]=i?n.display:"",e[D0]&&(n.display="none"))}const ac=/\s*!important$/;function ea(e,t,r){if(De(r))r.forEach(n=>ea(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=Yp(e,t);ac.test(r)?e.setProperty(xn(n),r.replace(ac,""),"important"):e[n]=r}}const oc=["Webkit","Moz","ms"],lo={};function Yp(e,t){const r=lo[t];if(r)return r;let n=dn(t);if(n!=="filter"&&n in e)return lo[t]=n;n=Fu(n);for(let s=0;s<oc.length;s++){const i=oc[s]+n;if(i in e)return lo[t]=i}return t}const lc="http://www.w3.org/1999/xlink";function cc(e,t,r,n,s,i=Zh(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(lc,t.slice(6,t.length)):e.setAttributeNS(lc,t,r):r==null||i&&!Pu(r)?e.removeAttribute(t):e.setAttribute(t,i?"":Nr(r)?String(r):r)}function uc(e,t,r,n,s){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?F0(r):r);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=Pu(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(s||t)}function Cn(e,t,r,n){e.addEventListener(t,r,n)}function Qp(e,t,r,n){e.removeEventListener(t,r,n)}const fc=Symbol("_vei");function Zp(e,t,r,n,s=null){const i=e[fc]||(e[fc]={}),a=i[t];if(n&&a)a.value=n;else{const[o,l]=e1(t);if(n){const c=i[t]=n1(n,s);Cn(e,o,c,l)}else a&&(Qp(e,o,a,l),i[t]=void 0)}}const hc=/(?:Once|Passive|Capture)$/;function e1(e){let t;if(hc.test(e)){t={};let n;for(;n=e.match(hc);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):xn(e.slice(2)),t]}let co=0;const t1=Promise.resolve(),r1=()=>co||(t1.then(()=>co=0),co=Date.now());function n1(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Lr(s1(n,r.value),t,5,[n])};return r.value=e,r.attached=r1(),r}function s1(e,t){if(De(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const dc=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,i1=(e,t,r,n,s,i)=>{const a=s==="svg";t==="class"?qp(e,n,a):t==="style"?Jp(e,r,n):Ca(t)?Zo(t)||Zp(e,t,r,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):a1(e,t,n,a))?(uc(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&cc(e,t,n,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!mt(n))?uc(e,dn(t),n,i,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),cc(e,t,n,a))};function a1(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&dc(t)&&Ne(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return dc(t)&&mt(r)?!1:t in e}const la=e=>{const t=e.props["onUpdate:modelValue"]||!1;return De(t)?r=>Ji(t,r):t};function o1(e){e.target.composing=!0}function pc(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const fs=Symbol("_assign");function gc(e,t,r){return t&&(e=e.trim()),r&&(e=Ia(e)),e}const zt={created(e,{modifiers:{lazy:t,trim:r,number:n}},s){e[fs]=la(s);const i=n||s.props&&s.props.type==="number";Cn(e,t?"change":"input",a=>{a.target.composing||e[fs](gc(e.value,r,i))}),(r||i)&&Cn(e,"change",()=>{e.value=gc(e.value,r,i)}),t||(Cn(e,"compositionstart",o1),Cn(e,"compositionend",pc),Cn(e,"change",pc))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(e[fs]=la(a),e.composing)return;const o=(i||e.type==="number")&&!/^0\d/.test(e.value)?Ia(e.value):e.value,l=t??"";o!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||s&&e.value.trim()===l)||(e.value=l))}},br={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const s=Oa(t);Cn(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?Ia(ca(a)):ca(a));e[fs](e.multiple?s?new Set(i):i:i[0]),e._assigning=!0,Zu(()=>{e._assigning=!1})}),e[fs]=la(n)},mounted(e,{value:t}){vc(e,t)},beforeUpdate(e,t,r){e[fs]=la(r)},updated(e,{value:t}){e._assigning||vc(e,t)}};function vc(e,t){const r=e.multiple,n=De(t);if(!(r&&!n&&!Oa(t))){for(let s=0,i=e.options.length;s<i;s++){const a=e.options[s],o=ca(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=t.some(c=>String(c)===String(o)):a.selected=td(t,o)>-1}else a.selected=t.has(o);else if(Da(ca(a),t)){e.selectedIndex!==s&&(e.selectedIndex=s);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function ca(e){return"_value"in e?e._value:e.value}const l1=["ctrl","shift","alt","meta"],c1={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>l1.some(r=>e[`${r}Key`]&&!t.includes(r))},Ei=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=((s,...i)=>{for(let a=0;a<t.length;a++){const o=c1[t[a]];if(o&&o(s,t))return}return e(s,...i)}))},u1={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},uo=(e,t)=>{const r=e._withKeys||(e._withKeys={}),n=t.join(".");return r[n]||(r[n]=(s=>{if(!("key"in s))return;const i=xn(s.key);if(t.some(a=>a===i||u1[a]===i))return e(s)}))},f1=Wt({patchProp:i1},Kp);let mc;function h1(){return mc||(mc=Ep(f1))}const d1=((...e)=>{const t=h1().createApp(...e),{mount:r}=t;return t.mount=n=>{const s=g1(n);if(!s)return;const i=t._component;!Ne(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,p1(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t});function p1(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function g1(e){return mt(e)?document.querySelector(e):e}function $a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function v1(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}const m1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class vl extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class x1 extends vl{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class xc extends vl{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class _c extends vl{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Mo;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Mo||(Mo={}));class _1{constructor(t,{headers:r={},customFetch:n,region:s=Mo.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=m1(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return v1(this,arguments,void 0,function*(r,n={}){var s;let i,a;try{const{headers:o,method:l,body:c,signal:u,timeout:f}=n;let p={},{region:d}=n;d||(d=this.region);const v=new URL(`${this.url}/${r}`);d&&d!=="any"&&(p["x-region"]=d,v.searchParams.set("forceFunctionRegion",d));let h;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",h=c):typeof c=="string"?(p["Content-Type"]="text/plain",h=c):typeof FormData<"u"&&c instanceof FormData?h=c:(p["Content-Type"]="application/json",h=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?h=JSON.stringify(c):h=c;let g=u;f&&(a=new AbortController,i=setTimeout(()=>a.abort(),f),u?(g=a.signal,u.addEventListener("abort",()=>a.abort())):g=a.signal);const w=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),o),body:h,signal:g}).catch(B=>{throw new x1(B)}),E=w.headers.get("x-relay-error");if(E&&E==="true")throw new xc(w);if(!w.ok)throw new _c(w);let _=((s=w.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),O;return _==="application/json"?O=yield w.json():_==="application/octet-stream"||_==="application/pdf"?O=yield w.blob():_==="text/event-stream"?O=w:_==="multipart/form-data"?O=yield w.formData():O=yield w.text(),{data:O,error:null,response:w}}catch(o){return{data:null,error:o,response:o instanceof _c||o instanceof xc?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var w1=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},y1=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(n=e.urlLengthLimit)!==null&&n!==void 0?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let a=null,o=null,l=null,c=i.status,u=i.statusText;if(i.ok){var f,p;if(r.method!=="HEAD"){var d;const w=await i.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((d=r.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?o=w:o=JSON.parse(w))}const h=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),g=(p=i.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");h&&g&&g.length>1&&(l=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,u="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var v;const h=await i.text();try{a=JSON.parse(h),Array.isArray(a)&&i.status===404&&(o=[],a=null,c=200,u="OK")}catch{i.status===404&&h===""?(c=204,u="No Content"):a={message:h}}if(a&&r.isMaybeSingle&&(!(a==null||(v=a.details)===null||v===void 0)&&v.includes("0 rows"))&&(a=null,c=200,u="OK"),a&&r.shouldThrowOnError)throw new w1(a)}return{error:a,data:o,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(s=s.catch(i=>{var a;let o="",l="",c="";const u=i?.cause;if(u){var f,p,d,v;const w=(f=u?.message)!==null&&f!==void 0?f:"",E=(p=u?.code)!==null&&p!==void 0?p:"";o=`${(d=i?.name)!==null&&d!==void 0?d:"FetchError"}: ${i?.message}`,o+=`

Caused by: ${(v=u?.name)!==null&&v!==void 0?v:"Error"}: ${w}`,E&&(o+=` (${E})`),u?.stack&&(o+=`
${u.stack}`)}else{var h;o=(h=i?.stack)!==null&&h!==void 0?h:""}const g=this.url.toString().length;return i?.name==="AbortError"||i?.code==="ABORT_ERR"?(c="",l="Request was aborted (timeout or manual cancellation)",g>this.urlLengthLimit&&(l+=`. Note: Your request URL is ${g} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(u?.name==="HeadersOverflowError"||u?.code==="UND_ERR_HEADERS_OVERFLOW")&&(c="",l="HTTP headers exceeded server limits (typically 16KB)",g>this.urlLengthLimit&&(l+=`. Your request URL is ${g} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:o,hint:l,code:c},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},E1=class extends y1{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const wc=new RegExp("[,()]");var ts=class extends E1{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&wc.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&wc.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},T1=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:s=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},s=r?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",a),n&&l.append("Prefer",`count=${n}`),new ts({method:s,url:o,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const s="POST",{url:i,headers:a}=this.cloneRequestState();if(t&&a.append("Prefer",`count=${t}`),r||a.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);i.searchParams.set("columns",l.join(","))}}return new ts({method:s,url:i,headers:a,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var i;const a="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),s||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);o.searchParams.set("columns",u.join(","))}}return new ts({method:a,url:o,headers:l,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const n="PATCH",{url:s,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new ts({method:n,url:s,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new ts({method:r,url:n,headers:s,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function ii(e){"@babel/helpers - typeof";return ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(e)}function b1(e,t){if(ii(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ii(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S1(e){var t=b1(e,"string");return ii(t)=="symbol"?t:t+""}function A1(e,t,r){return(t=S1(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yc(Object(r),!0).forEach(function(n){A1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yc(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var k1=class P0{constructor(t,{headers:r={},schema:n,fetch:s,timeout:i,urlLengthLimit:a=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.urlLengthLimit=a;const o=s??globalThis.fetch;i!==void 0&&i>0?this.fetch=(l,c)=>{const u=new AbortController,f=setTimeout(()=>u.abort(),i),p=c?.signal;if(p){if(p.aborted)return clearTimeout(f),o(l,c);const d=()=>{clearTimeout(f),u.abort()};return p.addEventListener("abort",d,{once:!0}),o(l,Ni(Ni({},c),{},{signal:u.signal})).finally(()=>{clearTimeout(f),p.removeEventListener("abort",d)})}return o(l,Ni(Ni({},c),{},{signal:u.signal})).finally(()=>clearTimeout(f))}:this.fetch=o}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new T1(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new P0(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;const u=d=>d!==null&&typeof d=="object"&&(!Array.isArray(d)||d.some(u)),f=n&&Object.values(r).some(u);f?(o="POST",c=r):n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,v])=>v!==void 0).map(([d,v])=>[d,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([d,v])=>{l.searchParams.append(d,v)})):(o="POST",c=r);const p=new Headers(this.headers);return f?p.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&p.set("Prefer",`count=${i}`),new ts({method:o,url:l,headers:p,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class C1{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const s=n.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const O1="2.95.2",R1=`realtime-js/${O1}`,I1="1.0.0",N0="2.0.0",Ec=N0,Uo=1e4,F1=1e3,D1=100;var ln;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ln||(ln={}));var _t;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(_t||(_t={}));var Er;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Er||(Er={}));var $o;(function(e){e.websocket="websocket"})($o||($o={}));var On;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(On||(On={}));class P1{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(t,r,n){var s,i;const a=t.topic,o=(s=t.ref)!==null&&s!==void 0?s:"",l=(i=t.join_ref)!==null&&i!==void 0?i:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+f.length,d=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(d),h=0;v.setUint8(h++,this.KINDS.userBroadcastPush),v.setUint8(h++,l.length),v.setUint8(h++,o.length),v.setUint8(h++,a.length),v.setUint8(h++,c.length),v.setUint8(h++,f.length),v.setUint8(h++,r),Array.from(l,w=>v.setUint8(h++,w.charCodeAt(0))),Array.from(o,w=>v.setUint8(h++,w.charCodeAt(0))),Array.from(a,w=>v.setUint8(h++,w.charCodeAt(0))),Array.from(c,w=>v.setUint8(h++,w.charCodeAt(0))),Array.from(f,w=>v.setUint8(h++,w.charCodeAt(0)));var g=new Uint8Array(d.byteLength+n.byteLength);return g.set(new Uint8Array(d),0),g.set(new Uint8Array(n),d.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,i,a,o,l]=n;return r({join_ref:s,ref:i,topic:a,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,s)}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),a=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const f=n.decode(t.slice(l,l+a));l=l+a;const p=t.slice(l,t.byteLength),d=o===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,v={type:this.BROADCAST_EVENT,event:u,payload:d};return a>0&&(v.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class L0{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(nt||(nt={}));const Tc=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,a)=>(i[a]=N1(a,e,t,s),i),{}):{}},N1=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s?.type,a=r[e];return i&&!n.includes(i)?B0(i,a):jo(a)},B0=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return U1(t,r)}switch(e){case nt.bool:return L1(t);case nt.float4:case nt.float8:case nt.int2:case nt.int4:case nt.int8:case nt.numeric:case nt.oid:return B1(t);case nt.json:case nt.jsonb:return M1(t);case nt.timestamp:return $1(t);case nt.abstime:case nt.date:case nt.daterange:case nt.int4range:case nt.int8range:case nt.money:case nt.reltime:case nt.text:case nt.time:case nt.timestamptz:case nt.timetz:case nt.tsrange:case nt.tstzrange:return jo(t);default:return jo(t)}},jo=e=>e,L1=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},B1=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},M1=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},U1=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>B0(t,o))}return e},$1=e=>typeof e=="string"?e.replace(" ","T"):e,M0=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class fo{constructor(t,r,n={},s=Uo){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var bc;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(bc||(bc={}));class Gs{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Gs.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=Gs.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Gs.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=i[c];if(f){const p=u.map(g=>g.presence_ref),d=f.map(g=>g.presence_ref),v=u.filter(g=>d.indexOf(g.presence_ref)<0),h=f.filter(g=>p.indexOf(g.presence_ref)<0);v.length>0&&(o[c]=v),h.length>0&&(l[c]=h)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(d=>d.presence_ref),p=u.filter(d=>f.indexOf(d.presence_ref)<0);t[o].unshift(...p)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,s(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sc;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Sc||(Sc={}));var qs;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(qs||(qs={}));var jr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(jr||(jr={}));class is{constructor(t,r={config:{}},n){var s,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=_t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new fo(this,Er.join,this.params,this.timeout),this.rejoinTimer=new L0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_t.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Er.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Gs(this),this.broadcastEndpointURL=M0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==_t.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[qs.PRESENCE]&&this.bindings[qs.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},p={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(d=>t?.(jr.CHANNEL_ERROR,d)),this._onClose(()=>t?.(jr.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){t?.(jr.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,g=(v=h?.length)!==null&&v!==void 0?v:0,w=[];for(let E=0;E<g;E++){const _=h[E],{filter:{event:O,schema:B,table:N,filter:k}}=_,K=d&&d[E];if(K&&K.event===O&&is.isFilterValueEqual(K.schema,B)&&is.isFilterValueEqual(K.table,N)&&is.isFilterValueEqual(K.filter,k))w.push(Object.assign(Object.assign({},_),{id:K.id}));else{this.unsubscribe(),this.state=_t.errored,t?.(jr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(jr.SUBSCRIBED);return}}).receive("error",d=>{this.state=_t.errored,t?.(jr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t?.(jr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===_t.joined&&t===qs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=_t.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Er.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new fo(this,Er.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_t.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new fo(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>D1){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Er;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let p=this._onMessage(a,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(d=>{var v,h,g;return((v=d.filter)===null||v===void 0?void 0:v.event)==="*"||((g=(h=d.filter)===null||h===void 0?void 0:h.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(d=>d.callback(p,n)):(i=this.bindings[a])===null||i===void 0||i.filter(d=>{var v,h,g,w,E,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const O=d.id,B=(v=d.filter)===null||v===void 0?void 0:v.event;return O&&((h=r.ids)===null||h===void 0?void 0:h.includes(O))&&(B==="*"||B?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const O=(E=(w=d?.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return O==="*"||O===((_=r?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:h,table:g,commit_timestamp:w,type:E,errors:_}=v;p=Object.assign(Object.assign({},{schema:h,table:g,commit_timestamp:w,eventType:E,new:{},old:{},errors:_}),this._getPayloadRecords(v))}d.callback(p,n)})}_isClosed(){return this.state===_t.closed}_isJoined(){return this.state===_t.joined}_isJoining(){return this.state===_t.joining}_isLeaving(){return this.state===_t.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&is.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Er.close,{},t)}_onError(t){this._on(Er.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_t.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Tc(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Tc(t.columns,t.old_record)),r}}const ho=()=>{},Li={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},j1=[1e3,2e3,5e3,1e4],W1=1e4,H1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class V1{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Uo,this.transport=null,this.heartbeatIntervalMs=Li.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ho,this.ref=0,this.reconnectTimer=null,this.vsn=Ec,this.logger=ho,this.conn=null,this.sendBuffer=[],this.serializer=new P1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${$o.websocket}`,this.httpEndpoint=M0(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=C1.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ln.connecting:return On.Connecting;case ln.open:return On.Open;case ln.closing:return On.Closing;default:return On.Closed}}isConnected(){return this.connectionState()===On.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new is(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(F1,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Li.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:s,payload:i,ref:a}=r,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${s} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===ln.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ln.open||this.conn.readyState===ln.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(Er.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([H1],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const i={access_token:r,version:R1};r&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Er.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new L0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Li.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,a,o,l,c,u,f,p,d;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Uo,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:Li.HEARTBEAT_INTERVAL,this.worker=(i=t?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=t?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=t?.heartbeatCallback)!==null&&o!==void 0?o:ho,this.vsn=(l=t?.vsn)!==null&&l!==void 0?l:Ec,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:(v=>j1[v-1]||W1),this.vsn){case I1:this.encode=(u=t?.encode)!==null&&u!==void 0?u:((v,h)=>h(JSON.stringify(v))),this.decode=(f=t?.decode)!==null&&f!==void 0?f:((v,h)=>h(JSON.parse(v)));break;case N0:this.encode=(p=t?.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(d=t?.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var ai=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function K1(e,t,r){const n=new URL(t,e);if(r)for(const[s,i]of Object.entries(r))i!==void 0&&n.searchParams.set(s,i);return n.toString()}async function G1(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function q1(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:i,headers:a}){const o=K1(e.baseUrl,n,s),l=await G1(e.auth),c=await t(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...a},body:i?JSON.stringify(i):void 0}),u=await c.text(),f=(c.headers.get("content-type")||"").includes("application/json"),p=f&&u?JSON.parse(u):u;if(!c.ok){const d=f?p:void 0,v=d?.error;throw new ai(v?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:v?.type,icebergCode:v?.code,details:d})}return{status:c.status,headers:c.headers,data:p}}}}function Bi(e){return e.join("")}var z1=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Bi(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Bi(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bi(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Bi(e.namespace)}`}),!0}catch(t){if(t instanceof ai&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof ai&&r.status===409)return;throw r}}};function Kn(e){return e.join("")}var X1=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Kn(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof ai&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof ai&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},J1=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=q1({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new z1(this.client,t),this.tableOps=new X1(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},ja=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Wa(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Mi=class extends ja{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},U0=class extends ja{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Y1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Q1=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Wo=e=>{if(Array.isArray(e))return e.map(r=>Wo(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Wo(n)}),t},Z1=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function oi(e){"@babel/helpers - typeof";return oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oi(e)}function eg(e,t){if(oi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(oi(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tg(e){var t=eg(e,"string");return oi(t)=="symbol"?t:t+""}function rg(e,t,r){return(t=tg(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ac(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ac(Object(r),!0).forEach(function(n){rg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const kc=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},ng=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const s=e,i=s.status||500;if(typeof s.json=="function")s.json().then(a=>{const o=a?.statusCode||a?.code||i+"";t(new Mi(kc(a),i,o,n))}).catch(()=>{if(n==="vectors"){const a=i+"";t(new Mi(s.statusText||`HTTP ${i} error`,i,a,n))}else{const a=i+"";t(new Mi(s.statusText||`HTTP ${i} error`,i,a,n))}});else{const a=i+"";t(new Mi(s.statusText||`HTTP ${i} error`,i,a,n))}}else t(new U0(kc(e),e,n))},sg=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||e==="HEAD"||!n?Fe(Fe({},s),r):(Q1(n)?(s.headers=Fe({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Fe(Fe({},s),r))};async function Ps(e,t,r,n,s,i,a){return new Promise((o,l)=>{e(r,sg(t,n,s,i)).then(c=>{if(!c.ok)throw c;if(n?.noResolveJson)return c;if(a==="vectors"){const u=c.headers.get("content-type");if(c.headers.get("content-length")==="0"||c.status===204)return{};if(!u||!u.includes("application/json"))return{}}return c.json()}).then(c=>o(c)).catch(c=>ng(c,l,n,a))})}function $0(e="storage"){return{get:async(t,r,n,s)=>Ps(t,"GET",r,n,s,void 0,e),post:async(t,r,n,s,i)=>Ps(t,"POST",r,s,i,n,e),put:async(t,r,n,s,i)=>Ps(t,"PUT",r,s,i,n,e),head:async(t,r,n,s)=>Ps(t,"HEAD",r,Fe(Fe({},n),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,n,s,i)=>Ps(t,"DELETE",r,s,i,n,e)}}const ig=$0("storage"),{get:li,post:yr,put:Ho,head:ag,remove:ml}=ig,lr=$0("vectors");var ws=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=Y1(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wa(r))return{data:null,error:r};throw r}}},og=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}};let j0;j0=Symbol.toStringTag;var lg=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[j0]="BlobDownloadBuilder",this.promise=null}asStream(){return new og(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}};const cg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ug=class extends ws{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var s=this;return s.handleOperation(async()=>{let i;const a=Fe(Fe({},Cc),n);let o=Fe(Fe({},s.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",s.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),l&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=s.toBase64(s.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),n?.headers&&(o=Fe(Fe({},o),n.headers));const c=s._removeEmptyFolders(t),u=s._getFinalPath(c),f=await(e=="PUT"?Ho:yr)(s.fetch,`${s.url}/object/${u}`,i,Fe({headers:o},a?.duplex?{duplex:a.duplex}:{}));return{path:c,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;const i=s._removeEmptyFolders(e),a=s._getFinalPath(i),o=new URL(s.url+`/object/upload/sign/${a}`);return o.searchParams.set("token",t),s.handleOperation(async()=>{let l;const c=Fe({upsert:Cc.upsert},n),u=Fe(Fe({},s.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{path:i,fullPath:(await Ho(s.fetch,o.toString(),l,{headers:u})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const s=Fe({},r.headers);t?.upsert&&(s["x-upsert"]="true");const i=await yr(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(r.url+i.url),o=a.searchParams.get("token");if(!o)throw new ja("No token returned by API");return{signedUrl:a.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await yr(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await yr(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(e),i=await yr(n.fetch,`${n.url}/object/sign/${s}`,Fe({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${i.signedURL}${a}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const s=await yr(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return s.map(a=>Fe(Fe({},a),{},{signedUrl:a.signedURL?encodeURI(`${n.url}${a.signedURL}${i}`):null}))})}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(t?.transform||{}),s=n?`?${n}`:"",i=this._getFinalPath(e),a=()=>li(this.fetch,`${this.url}/${r}/${i}${s}`,{headers:this.headers,noResolveJson:!0});return new lg(a,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>Wo(await li(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await ag(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Wa(n)&&n instanceof U0){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=t?.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&n.push(s);const i=typeof t?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(t?.transform||{});a!==""&&n.push(a);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await ml(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const s=Fe(Fe(Fe({},cg),t),{},{prefix:e||""});return await yr(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Fe({},e);return await yr(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const fg="2.95.2",Ti={"X-Client-Info":`storage-js/${fg}`};var hg=class extends ws{constructor(e,t={},r,n){const s=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const i=s.href.replace(/\/$/,""),a=Fe(Fe({},Ti),t);super(i,a,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await li(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await li(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await yr(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Ho(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await yr(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ml(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},dg=class extends ws{constructor(e,t={},r){const n=e.replace(/\/$/,""),s=Fe(Fe({},Ti),t);super(n,s,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await yr(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await li(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ml(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!Z1(e))throw new ja("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new J1({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,i){const a=s[i];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(s,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}},pg=class extends ws{constructor(e,t={},r){const n=e.replace(/\/$/,""),s=Fe(Fe({},Ti),{},{"Content-Type":"application/json"},t);super(n,s,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await lr.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await lr.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},gg=class extends ws{constructor(e,t={},r){const n=e.replace(/\/$/,""),s=Fe(Fe({},Ti),{},{"Content-Type":"application/json"},t);super(n,s,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},vg=class extends ws{constructor(e,t={},r){const n=e.replace(/\/$/,""),s=Fe(Fe({},Ti),{},{"Content-Type":"application/json"},t);super(n,s,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await lr.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},mg=class extends vg{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new xg(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},xg=class extends pg{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new _g(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},_g=class extends gg{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Fe(Fe({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},wg=class extends hg{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new ug(this.url,this.headers,e,this.fetch)}get vectors(){return new mg(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new dg(this.url+"/iceberg",this.headers,this.fetch)}};const W0="2.95.2",rs=30*1e3,Vo=3,po=Vo*rs,yg="http://localhost:9999",Eg="supabase.auth.token",Tg={"X-Client-Info":`gotrue-js/${W0}`},Ko="X-Supabase-Api-Version",H0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bg=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Sg=600*1e3;class ci extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ce(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ag extends ci{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function kg(e){return Ce(e)&&e.name==="AuthApiError"}class Rn extends ci{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class en extends ci{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class rr extends en{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function go(e){return Ce(e)&&e.name==="AuthSessionMissingError"}class Gn extends en{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ui extends en{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class $i extends en{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Cg(e){return Ce(e)&&e.name==="AuthImplicitGrantRedirectError"}class Oc extends en{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Og extends en{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Go extends en{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function vo(e){return Ce(e)&&e.name==="AuthRetryableFetchError"}class Rc extends en{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class qo extends en{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ic=` 	
\r=`.split(""),Rg=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ic.length;t+=1)e[Ic[t].charCodeAt(0)]=-2;for(let t=0;t<ua.length;t+=1)e[ua[t].charCodeAt(0)]=t;return e})();function Fc(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ua[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ua[n]),t.queuedBits-=6}}function V0(e,t,r){const n=Rg[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Dc(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{Dg(a,n,r)};for(let a=0;a<e.length;a+=1)V0(e.charCodeAt(a),s,i);return t.join("")}function Ig(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Fg(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Ig(n,t)}}function Dg(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function hs(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)V0(e.charCodeAt(s),r,n);return new Uint8Array(t)}function Pg(e){const t=[];return Fg(e,r=>t.push(r)),new Uint8Array(t)}function Fn(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Fc(s,r,n)),Fc(null,r,n),t.join("")}function Ng(e){return Math.round(Date.now()/1e3)+e}function Lg(){return Symbol("auth-callback")}const kt=()=>typeof window<"u"&&typeof document<"u",Tn={tested:!1,writable:!1},K0=()=>{if(!kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tn.tested)return Tn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Tn.tested=!0,Tn.writable=!0}catch{Tn.tested=!0,Tn.writable=!1}return Tn.writable};function Bg(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const G0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Mg=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ns=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},bn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},At=async(e,t)=>{await e.removeItem(t)};class Ha{constructor(){this.promise=new Ha.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ha.promiseConstructor=Promise;function ji(e){const t=e.split(".");if(t.length!==3)throw new qo("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!bg.test(t[n]))throw new qo("JWT not in base64url format");return{header:JSON.parse(Dc(t[0])),payload:JSON.parse(Dc(t[1])),signature:hs(t[2]),raw:{header:t[0],payload:t[1]}}}async function Ug(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function $g(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function jg(e){return("0"+e.toString(16)).substr(-2)}function Wg(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,jg).join("")}async function Hg(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Vg(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Hg(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function qn(e,t,r=!1){const n=Wg();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await ns(e,`${t}-code-verifier`,s);const i=await Vg(n);return[i,n===i?"plain":"s256"]}const Kg=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Gg(e){const t=e.headers.get(Ko);if(!t||!t.match(Kg))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function qg(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function zg(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Xg=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zn(e){if(!Xg.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mo(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Jg(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function Pc(e){return JSON.parse(JSON.stringify(e))}const kn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Yg=[502,503,504];async function Nc(e){var t;if(!Mg(e))throw new Go(kn(e),0);if(Yg.includes(e.status))throw new Go(kn(e),e.status);let r;try{r=await e.json()}catch(i){throw new Rn(kn(i),i)}let n;const s=Gg(e);if(s&&s.getTime()>=H0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Rc(kn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new rr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Rc(kn(r),e.status,r.weak_password.reasons);throw new Ag(kn(r),e.status||500,n)}const Qg=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Ie(e,t,r,n){var s;const i=Object.assign({},n?.headers);i[Ko]||(i[Ko]=H0["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Zg(e,t,r+o,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function Zg(e,t,r,n,s,i){const a=Qg(t,n,s,i);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new Go(kn(l),0)}if(o.ok||await Nc(o),n?.noResolveJson)return o;try{return await o.json()}catch(l){await Nc(l)}}function wr(e){var t;let r=null;rv(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ng(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Lc(e){const t=wr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function cn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ev(e){return{data:e,error:null}}function tv(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=$a(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Bc(e){return e}function rv(e){return e.access_token&&e.refresh_token&&e.expires_in}const xo=["global","local","others"];class nv{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=G0(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=xo[0]){if(xo.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xo.join(", ")}`);try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:cn})}catch(n){if(Ce(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=$a(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:tv,redirectTo:r?.redirectTo})}catch(r){if(Ce(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cn})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Bc});if(u.error)throw u.error;const f=await u.json(),p=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(v=>{const h=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);c[`${g}Page`]=h}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ce(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){zn(t);try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cn})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){zn(t);try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:cn})}catch(n){if(Ce(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){zn(t);try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:cn})}catch(n){if(Ce(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){zn(t.userId);try{const{data:r,error:n}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async _deleteFactor(t){zn(t.userId),zn(t.id);try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Bc});if(u.error)throw u.error;const f=await u.json(),p=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(v=>{const h=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);c[`${g}Page`]=h}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ce(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ce(r))return{data:null,error:r};throw r}}}function Mc(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Xn={debug:!!(globalThis&&K0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class q0 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sv extends q0{}async function iv(e,t,r){Xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Xn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Xn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function av(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function z0(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function ov(e){return parseInt(e,16)}function lv(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function cv(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:f,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=z0(e.address),v=u?`${u}://${n}`:n,h=e.statement?`${e.statement}
`:"",g=`${v} wants you to sign in with your Ethereum account:
${d}

${h}`;let w=`URI: ${f}
Version: ${p}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(s&&(w+=`
Expiration Time: ${s.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let E=`
Resources:`;for(const _ of c){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);E+=`
- ${_}`}w+=E}return`${g}
${w}`}class gt extends Error{constructor({message:t,code:r,cause:n,name:s}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class fa extends gt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function uv({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new gt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new gt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new gt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new gt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new gt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new gt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new gt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new gt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(X0(a)){if(i.rp.id!==a)return new gt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new gt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new gt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new gt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function fv({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new gt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new gt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(X0(n)){if(r.rpId!==n)return new gt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new gt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new gt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class hv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const dv=new hv;function pv(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=$a(e,["challenge","user","excludeCredentials"]),i=hs(t).buffer,a=Object.assign(Object.assign({},r),{id:hs(r.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:i,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:hs(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function gv(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=$a(e,["challenge","allowCredentials"]),s=hs(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const o=r[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:hs(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function vv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Fn(new Uint8Array(e.response.attestationObject)),clientDataJSON:Fn(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function mv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Fn(new Uint8Array(s.authenticatorData)),clientDataJSON:Fn(new Uint8Array(s.clientDataJSON)),signature:Fn(new Uint8Array(s.signature)),userHandle:s.userHandle?Fn(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function X0(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Uc(){var e,t;return!!(kt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function xv(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new fa("Browser returned unexpected credential type",t)}:{data:null,error:new fa("Empty credential response",t)}}catch(t){return{data:null,error:uv({error:t,options:e})}}}async function _v(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new fa("Browser returned unexpected credential type",t)}:{data:null,error:new fa("Empty credential response",t)}}catch(t){return{data:null,error:fv({error:t,options:e})}}}const wv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},yv={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ha(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const i in s){const a=s[i];if(a!==void 0)if(Array.isArray(a))n[i]=a;else if(r(a))n[i]=a;else if(t(a)){const o=n[i];t(o)?n[i]=ha(o,a):n[i]=ha(a)}else n[i]=a}return n}function Ev(e,t){return ha(wv,e,t||{})}function Tv(e,t){return ha(yv,e,t||{})}class bv{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},i){var a;try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=s??dv.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;if(!u.name){const f=n;if(f)u.name=`${u.id}:${f}`;else{const d=(await this.client.getUser()).data.user,v=((a=d?.user_metadata)===null||a===void 0?void 0:a.name)||d?.email||d?.id||"User";u.name=`${u.id}:${v}`}}u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=Ev(o.webauthn.credential_options.publicKey,i?.create),{data:f,error:p}=await xv({publicKey:u,signal:c});return f?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:p}}case"request":{const u=Tv(o.webauthn.credential_options.publicKey,i?.request),{data:f,error:p}=await _v(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return f?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:p}}}}catch(o){return Ce(o)?{data:null,error:o}:{data:null,error:new Rn("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ci("rpId is required for WebAuthn authentication")};try{if(!Uc())return{data:null,error:new Rn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return Ce(a)?{data:null,error:a}:{data:null,error:new Rn("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ci("rpId is required for WebAuthn registration")};try{if(!Uc())return{data:null,error:new Rn("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return Ce(a)?{data:null,error:a}:{data:null,error:new Rn("Unexpected error in register",a)}}}}av();const Sv={url:yg,storageKey:Eg,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Tg,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function $c(e,t,r){return await r()}const Jn={};class ui{get jwks(){var t,r;return(r=(t=Jn[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Jn[this.storageKey]=Object.assign(Object.assign({},Jn[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Jn[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Jn[this.storageKey]=Object.assign(Object.assign({},Jn[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Sv),t);if(this.storageKey=i.storageKey,this.instanceID=(r=ui.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ui.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&kt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new nv({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=G0(i.fetch),this.lock=i.lock||$c,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&kt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=iv:this.lock=$c,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new bv(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:K0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Mc(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Mc(this.memoryStorage)),kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${W0}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(kt()&&(r=Bg(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),kt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Cg(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ce(r)?this._returnResult({error:r}):this._returnResult({error:new Rn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:wr}),{data:a,error:o}=i;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(Ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:u,password:f,options:p}=t;let d=null,v=null;this.flowType==="pkce"&&([d,v]=await qn(this.storage,this.storageKey)),i=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:u,password:f,data:(r=p?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:d,code_challenge_method:v},xform:wr})}else if("phone"in t){const{phone:u,password:f,options:p}=t;i=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=p?.data)!==null&&n!==void 0?n:{},channel:(s=p?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:wr})}else throw new Ui("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return await At(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Lc})}else if("phone"in t){const{phone:i,password:a,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Lc})}else throw new Ui("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new Gn;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Ce(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,i,a,o,l,c,u,f,p;let d,v;if("message"in t)d=t.message,v=t.signature;else{const{chain:h,wallet:g,statement:w,options:E}=t;let _;if(kt())if(typeof g=="object")_=g;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")_=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=g}const O=new URL((r=E?.url)!==null&&r!==void 0?r:window.location.href),B=await _.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!B||B.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const N=z0(B[0]);let k=(n=E?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const P=await _.request({method:"eth_chainId"});k=ov(P)}const K={domain:O.host,address:N,statement:w,uri:O.href,version:"1",chainId:k,nonce:(s=E?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(i=E?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=E?.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=E?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=E?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=E?.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=cv(K),v=await _.request({method:"personal_sign",params:[lv(d),N]})}try{const{data:h,error:g}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:wr});if(g)throw g;if(!h||!h.session||!h.user){const w=new Gn;return this._returnResult({data:{user:null,session:null},error:w})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:Object.assign({},h),error:g})}catch(h){if(Ce(h))return this._returnResult({data:{user:null,session:null},error:h});throw h}}async signInWithSolana(t){var r,n,s,i,a,o,l,c,u,f,p,d;let v,h;if("message"in t)v=t.message,h=t.signature;else{const{chain:g,wallet:w,statement:E,options:_}=t;let O;if(kt())if(typeof w=="object")O=w;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))O=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=w}const B=new URL((r=_?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const N=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_?.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),E?{statement:E}:null));let k;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")k=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)k=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)v=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),h=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${B.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(s=(n=_?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=_?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((a=_?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_?.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((l=_?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((c=_?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(u=_?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const N=await O.signMessage(new TextEncoder().encode(v),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");h=N}}try{const{data:g,error:w}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Fn(h)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:wr});if(w)throw w;if(!g||!g.session||!g.user){const E=new Gn;return this._returnResult({data:{user:null,session:null},error:E})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:w})}catch(g){if(Ce(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await bn(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Og;const{data:i,error:a}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:wr});if(await At(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const o=new Gn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,o=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:wr}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Gn;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Ce(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await qn(this.storage,this.storageKey));const{error:f}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new Ui("You must provide either an email or phone number.")}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:wr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,i,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await qn(this.storage,this.storageKey));const c=await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:ev});return!((i=c.data)===null||i===void 0)&&i.url&&kt()&&!(!((a=t.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new rr;const{error:s}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:o})}throw new Ui("You must provide either an email or phone number and a type")}catch(r){if(Ce(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await bn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<po:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await bn(this.userStorage,this.storageKey+"-user");a?.user?t.user=a.user:t.user=mo()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=Jg(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cn}):await this._useSession(async r=>{var n,s,i;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new rr}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:cn})})}catch(r){if(Ce(r))return go(r)&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new rr;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await qn(this.storage,this.storageKey));const{data:c,error:u}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:cn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new rr;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=ji(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Ce(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new rr;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ce(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!kt())throw new $i("No browser detected.");if(t.error||t.error_description||t.error_code)throw new $i(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Oc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $i("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Oc("No code detected.");const{data:E,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!a||!c)throw new $i("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let p=u+f;l&&(p=parseInt(l));const d=p-u;d*1e3<=rs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const v=p-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,u);const{data:h,error:g}=await this._getUser(i);if(g)throw g;const w={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:p,refresh_token:a,token_type:c,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Ce(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await bn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i&&!go(i))return this._returnResult({error:i});const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(kg(o)&&(o.status===404||o.status===401||o.status===403)||go(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Lg(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await qn(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,l,c,u;const{data:f,error:p}=i;if(p)throw p;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return kt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Ce(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:a,provider:o,token:l,access_token:c,nonce:u}=t,f=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:wr}),{data:p,error:d}=f;return d?this._returnResult({data:{user:null,session:null},error:d}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Gn}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:d}))}catch(s){if(await At(this.storage,`${this.storageKey}-code-verifier`),Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await $g(async s=>(s>0&&await Ug(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:wr})),(s,i)=>{const a=200*Math.pow(2,s);return i&&vo(i)&&Date.now()+a-n<rs})}catch(n){if(this._debug(r,"error",n),Ce(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),kt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await bn(this.storage,this.storageKey);if(s&&this.userStorage){let a=await bn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await ns(this.userStorage,this.storageKey+"-user",a)),s.user=(t=a?.user)!==null&&t!==void 0?t:mo()}else if(s&&!s.user&&!s.user){const a=await bn(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,await At(this.storage,this.storageKey+"-user"),await ns(this.storage,this.storageKey,s)):s.user=mo()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<po;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${po}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),vo(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&a?.user?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new rr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ha;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new rr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Ce(i)){const a={data:null,error:i};return vo(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await At(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ns(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=Pc(s);await ns(this.storage,this.storageKey,i)}else{const s=Pc(r);await ns(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await At(this.storage,this.storageKey),await At(this.storage,this.storageKey+"-code-verifier"),await At(this.storage,this.storageKey+"-user"),this.userStorage&&await At(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&kt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),rs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/rs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${rs}ms, refresh threshold is ${Vo} ticks`),s<=Vo&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof q0)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await qn(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((s=l?.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?vv(t.webauthn.credential_response):mv(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:pv(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:gv(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,s,i;if(t)try{const{payload:d}=ji(t);let v=null;d.aal&&(v=d.aal);let h=v;const{data:{user:g},error:w}=await this.getUser(t);if(w)return this._returnResult({data:null,error:w});((n=(r=g?.factors)===null||r===void 0?void 0:r.filter(O=>O.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(h="aal2");const _=d.amr||[];return{data:{currentLevel:v,nextLevel:h,currentAuthenticationMethods:_},error:null}}catch(d){if(Ce(d))return this._returnResult({data:null,error:d});throw d}const{data:{session:a},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=ji(a.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((i=(s=a.user.factors)===null||s===void 0?void 0:s.filter(d=>d.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(u="aal2");const p=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await Ie(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new rr})})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new rr});const a=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&kt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Ce(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new rr});const a=await Ie(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&kt()&&!r?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(Ce(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ie(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new rr})})}catch(t){if(Ce(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await Ie(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new rr})})}catch(r){if(Ce(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+Sg>s)return n;const{data:i,error:a}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:d,error:v}=await this.getSession();if(v||!d.session)return this._returnResult({data:null,error:v});n=d.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=ji(n);r?.allowExpired||qg(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:i,header:s,signature:a},error:null}}const u=zg(s.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,Pg(`${o}.${l}`)))throw new qo("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Ce(n))return this._returnResult({data:null,error:n});throw n}}}ui.nextInstanceID={};const Av=ui,kv="2.95.2";let Bs="";typeof Deno<"u"?Bs="deno":typeof document<"u"?Bs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bs="react-native":Bs="node";const Cv={"X-Client-Info":`supabase-js-${Bs}/${kv}`},Ov={headers:Cv},Rv={schema:"public"},Iv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Fv={};function fi(e){"@babel/helpers - typeof";return fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fi(e)}function Dv(e,t){if(fi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fi(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pv(e){var t=Dv(e,"string");return fi(t)=="symbol"?t:t+""}function Nv(e,t,r){return(t=Pv(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jc(Object(r),!0).forEach(function(n){Nv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jc(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Lv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Bv=()=>Headers,Mv=(e,t,r)=>{const n=Lv(r),s=Bv();return async(i,a)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let c=new s(a?.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,ut(ut({},a),{},{headers:c}))}};function Uv(e){return e.endsWith("/")?e:e+"/"}function $v(e,t){var r,n;const{db:s,auth:i,realtime:a,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,p={db:ut(ut({},l),s),auth:ut(ut({},c),i),realtime:ut(ut({},u),a),storage:{},global:ut(ut(ut({},f),o),{},{headers:ut(ut({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=o?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function jv(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Uv(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Wv=class extends Av{constructor(e){super(e)}},Hv=class{constructor(e,t,r){var n,s;this.supabaseUrl=e,this.supabaseKey=t;const i=jv(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const a=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:Rv,realtime:Fv,auth:ut(ut({},Iv),{},{storageKey:a}),global:Ov},l=$v(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=l.global.headers)!==null&&s!==void 0?s:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=Mv(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(ut({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new k1(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch,timeout:l.db.timeout,urlLengthLimit:l.db.urlLengthLimit}),this.storage=new wg(this.storageUrl.href,this.headers,this.fetch,r?.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new _1(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:i,flowType:a,lock:o,debug:l,throwOnError:c},u,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wv({url:this.authUrl.href,headers:ut(ut({},p),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:a,lock:o,debug:l,throwOnError:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(d=>d.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new V1(this.realtimeUrl.href,ut(ut({},e),{},{params:ut(ut({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Vv=(e,t,r)=>new Hv(e,t,r);function Kv(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Kv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Gv="https://uakrcftgyigetreqhwmo.supabase.co",qv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVha3JjZnRneWlnZXRyZXFod21vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAyNTEzNDMsImV4cCI6MjA4NTgyNzM0M30.AJrXvziR_y71YMkIWQloQhIiZEw4-h2Eyhx7kLJxGBQ",Xe=Vv(Gv,qv),zv={class:"min-h-screen bg-slate-900 flex items-center justify-center p-4"},Xv={class:"bg-white w-full max-w-md rounded-xl shadow-2xl overflow-hidden"},Jv={key:0,class:"bg-red-50 text-red-600 p-3 rounded-lg text-sm flex items-center gap-2"},Yv=["disabled"],Qv={key:0,class:"flex items-center gap-2"},Zv={key:1},em={__name:"Login",setup(e){const t=Be(""),r=Be(""),n=Be(!1),s=Be(""),i=async()=>{n.value=!0,s.value="";const{error:a}=await Xe.auth.signInWithPassword({email:t.value,password:r.value});a&&(s.value=a.message),n.value=!1};return(a,o)=>(oe(),ce("div",zv,[x("div",Xv,[o[6]||(o[6]=x("div",{class:"bg-gradient-to-r from-blue-600 to-indigo-600 p-8 text-center text-white"},[x("h1",{class:"text-3xl font-bold mb-2"},"PCS v2.0"),x("p",{class:"text-blue-100"},"Puttalam Central Storage")],-1)),x("form",{onSubmit:Ei(i,["prevent"]),class:"p-8 space-y-6"},[s.value?(oe(),ce("div",Jv,[o[2]||(o[2]=x("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),ur(" "+be(s.value),1)])):dt("",!0),x("div",null,[o[3]||(o[3]=x("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"Email Address",-1)),Ke(x("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),type:"email",required:"",class:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"admin@example.com"},null,512),[[zt,t.value]])]),x("div",null,[o[4]||(o[4]=x("label",{class:"block text-sm font-medium text-slate-700 mb-1"},"Password",-1)),Ke(x("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>r.value=l),type:"password",required:"",class:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:""},null,512),[[zt,r.value]])]),x("button",{type:"submit",disabled:n.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg shadow-lg shadow-blue-500/30 transition-all disabled:opacity-70 disabled:cursor-not-allowed flex justify-center"},[n.value?(oe(),ce("span",Qv,[...o[5]||(o[5]=[x("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[x("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),x("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ur(" Signing In... ",-1)])])):(oe(),ce("span",Zv,"Sign In"))],8,Yv)],32),o[7]||(o[7]=x("div",{class:"px-8 pb-8 text-center text-xs text-slate-400"},[ur("  2026 McLarens Holdings Limited. "),x("br"),ur(" Authorized Access Only. ")],-1))])]))}};var da={};da.version="0.18.5";var J0=1252,tm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Y0=function(e){tm.indexOf(e)!=-1&&(J0=e)};function rm(){Y0(1252)}var hi=function(e){Y0(e)};function nm(){hi(1200),rm()}var Wi=function(t){return String.fromCharCode(t)},Wc=function(t){return String.fromCharCode(t)},pa,un="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function di(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=un.charAt(i)+un.charAt(a)+un.charAt(o)+un.charAt(l);return t}function Yr(e){var t="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=un.indexOf(e.charAt(c++)),a=un.indexOf(e.charAt(c++)),r=i<<2|a>>4,t+=String.fromCharCode(r),o=un.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=un.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Ve=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),tn=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ln(e){return Ve?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Hc(e){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Tr=function(t){return Ve?tn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Va(e){if(typeof ArrayBuffer>"u")return Tr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function bi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function sm(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var It=Ve?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:tn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function im(e){for(var t=[],r=0,n=e.length+250,s=Ln(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Ln(65535),n=65530)}return t.push(s.slice(0,r)),It(t)}var zs=/\u0000/g,Hi=/[\u0001-\u0006]/g;function ds(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Sr(e,t){var r=""+e;return r.length>=t?r:ft("0",t-r.length)+r}function xl(e,t){var r=""+e;return r.length>=t?r:ft(" ",t-r.length)+r}function ga(e,t){var r=""+e;return r.length>=t?r:r+ft(" ",t-r.length)}function am(e,t){var r=""+Math.round(e);return r.length>=t?r:ft("0",t-r.length)+r}function om(e,t){var r=""+e;return r.length>=t?r:ft("0",t-r.length)+r}var Vc=Math.pow(2,32);function Yn(e,t){if(e>Vc||e<-Vc)return am(e,t);var r=Math.round(e);return om(r,t)}function va(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Kc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_o=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lm(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cm={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ma(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(s);c<t&&(f=Math.floor(s),o=f*a+i,u=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function Vi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=vm(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var Q0=new Date(1899,11,31,0,0,0),um=Q0.getTime(),fm=new Date(1900,2,1,0,0,0);function Z0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=fm&&(r+=1440*60*1e3),(r-(um+(e.getTimezoneOffset()-Q0.getTimezoneOffset())*6e4))/(1440*60*1e3)}function _l(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hm(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dm(e){var t=e<0?12:11,r=_l(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function pm(e){var t=_l(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function gm(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=dm(e):t===10?r=e.toFixed(10).substr(0,12):r=pm(e),_l(hm(r.toUpperCase()))}function zo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gm(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gn(14,Z0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function vm(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mm(e,t,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return _o[r.m-1][1];case 5:return _o[r.m-1][0];default:return _o[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Kc[r.q][0];default:return Kc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Sr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=Sr(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Sr(l,c):"";return u}function fn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ef=/%/g;function xm(e,t,r){var n=t.replace(ef,""),s=t.length-n.length;return Vr(e,n,r*Math.pow(10,2*s))+ft("%",s)}function _m(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Vr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tf(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tf(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rf=/# (\?+)( ?)\/( ?)(\d+)/;function wm(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?ft(" ",e[1].length+1+e[4].length):xl(a,e[1].length)+e[2]+"/"+e[3]+Sr(o,e[4].length))}function ym(e,t,r){return r+(t===0?"":""+t)+ft(" ",e[1].length+2+e[4].length)}var nf=/^#*0*\.([0#]+)/,sf=/\).*[0#]/,af=/\(###\) ###\\?-####/;function Vt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function qc(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function zc(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Em(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Tm(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function dr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sf)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?dr("n",n,r):"("+dr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _m(e,t,r);if(t.indexOf("%")!==-1)return xm(e,t,r);if(t.indexOf("E")!==-1)return tf(t,r);if(t.charCodeAt(0)===36)return"$"+dr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Yn(l,t.length);if(t.match(/^[#?]+$/))return s=Yn(r,0),s==="0"&&(s=""),s.length>t.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(rf))return wm(i,l,c);if(t.match(/^#+0+$/))return c+Yn(l,t.length-t.indexOf("0"));if(i=t.match(nf))return s=qc(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Vt(i[1])).replace(/\.$/,"."+Vt(i[1])).replace(/\.(\d*)$/,function(v,h){return"."+h+ft("0",Vt(i[1]).length-h.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+qc(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+fn(Yn(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+dr(e,t,-r):fn(""+(Math.floor(r)+Em(r,i[1].length)))+"."+Sr(zc(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return dr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ds(dr(e,t.replace(/[\\-]/g,""),r)),a=0,ds(ds(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(t.match(af))return s=dr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=ma(l,Math.pow(10,a)-1,!1),s=""+c,u=Vr("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=ga(o[2],a),u.length<i[4].length&&(u=Vt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=ma(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xl(o[1],a)+i[2]+"/"+i[3]+ga(o[2],a):ft(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Yn(r,0),t.length<=s.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,p=t.length-s.length-f;return Vt(t.substr(0,f)+s+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=zc(r,i[1].length),r<0?"-"+dr(e,t,-r):fn(Tm(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Sr(0,3-v.length):"")+v})+"."+Sr(a,i[1].length);switch(t){case"###,##0.00":return dr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=fn(Yn(l,0));return d!=="0"?c+d:"";case"###,###.00":return dr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return dr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function bm(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Vr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Sm(e,t,r){var n=t.replace(ef,""),s=t.length-n.length;return Vr(e,n,r*Math.pow(10,2*s))+ft("%",s)}function of(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+of(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Rr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sf)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rr("n",n,r):"("+Rr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bm(e,t,r);if(t.indexOf("%")!==-1)return Sm(e,t,r);if(t.indexOf("E")!==-1)return of(t,r);if(t.charCodeAt(0)===36)return"$"+Rr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Sr(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(rf))return ym(i,l,c);if(t.match(/^#+0+$/))return c+Sr(l,t.length-t.indexOf("0"));if(i=t.match(nf))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Vt(i[1])).replace(/\.$/,"."+Vt(i[1])),s=s.replace(/\.(\d*)$/,function(v,h){return"."+h+ft("0",Vt(i[1]).length-h.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+fn(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rr(e,t,-r):fn(""+r)+"."+ft("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Rr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ds(Rr(e,t.replace(/[\\-]/g,""),r)),a=0,ds(ds(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(t.match(af))return s=Rr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=ma(l,Math.pow(10,a)-1,!1),s=""+c,u=Vr("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=ga(o[2],a),u.length<i[4].length&&(u=Vt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=ma(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?xl(o[1],a)+i[2]+"/"+i[3]+ga(o[2],a):ft(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Vt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=t.indexOf(".")-a,p=t.length-s.length-f;return Vt(t.substr(0,f)+s+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Rr(e,t,-r):fn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Sr(0,3-v.length):"")+v})+"."+Sr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=fn(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Rr(e,t.slice(0,t.lastIndexOf(".")),r)+Vt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Vr(e,t,r){return(r|0)===r?Rr(e,t,r):dr(e,t,r)}function Am(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lf=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cf(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":va(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(lf))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function km(e,t,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,f,p="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!va(e,a))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var d=e.charAt(++a),v=d==="("||d===")"?d:"t";s[s.length]={t:v,v:d},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Vi(t,r,e.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Vi(t,r),c==null))return"";for(i=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var h={t:o,v:o};if(c==null&&(c=Vi(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(h.v=c.H>=12?"P":"A"),h.t="T",p="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(h.v=c.H>=12?"PM":"AM"),h.t="T",a+=5,p="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(h.v=c.H>=12?"":""),h.t="T",a+=5,p="h"):(h.t="t",++a),c==null&&h.t==="T")return"";s[s.length]=h,l=o;break;case"[":for(i=o;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(lf)){if(c==null&&(c=Vi(t,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",cf(e)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<e.length&&(o=e.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++a;break}var g=0,w=0,E;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=p,l="h",g<1&&(g=1);break;case"s":(E=s[a].v.match(/\.0+$/))&&(w=Math.max(w,E[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[a].v.match(/[Hh]/)&&(g=1),g<2&&s[a].v.match(/[Mm]/)&&(g=2),g<3&&s[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",O;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=mm(s[a].t.charCodeAt(0),s[a].v,c,w),s[a].t="t";break;case"n":case"?":for(O=a+1;s[O]!=null&&((o=s[O].t)==="?"||o==="D"||(o===" "||o==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[a].v+=s[O].v,s[O]={v:"",t:";"},++O;_+=s[a].v,a=O-1;break;case"G":s[a].t="t",s[a].v=zo(t,r);break}var B="",N,k;if(_.length>0){_.charCodeAt(0)==40?(N=t<0&&_.charCodeAt(0)===45?-t:t,k=Vr("n",_,N)):(N=t<0&&n>1?-t:t,k=Vr("n",_,N),N<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),O=k.length-1;var K=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){K=a;break}var P=s.length;if(K===s.length&&k.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(O>=s[a].v.length-1?(O-=s[a].v.length,s[a].v=k.substr(O+1,s[a].v.length)):O<0?s[a].v="":(s[a].v=k.substr(0,O+1),O=-1),s[a].t="t",P=a);O>=0&&P<s.length&&(s[P].v=k.substr(0,O+1)+s[P].v)}else if(K!==s.length&&k.indexOf("E")===-1){for(O=k.indexOf(".")-1,a=K;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===K?s[a].v.indexOf(".")-1:s[a].v.length-1,B=s[a].v.substr(u+1);u>=0;--u)O>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(B=k.charAt(O--)+B);s[a].v=B,s[a].t="t",P=a}for(O>=0&&P<s.length&&(s[P].v=k.substr(0,O+1)+s[P].v),O=k.indexOf(".")+1,a=K;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==K)){for(u=s[a].v.indexOf(".")>-1&&a===K?s[a].v.indexOf(".")+1:0,B=s[a].v.substr(0,u);u<s[a].v.length;++u)O<k.length&&(B+=k.charAt(O++));s[a].v=B,s[a].t="t",P=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(N=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=Vr(s[a].t,s[a].v,N),s[a].t="t");var q="";for(a=0;a!==s.length;++a)s[a]!=null&&(q+=s[a].v);return q}var Xc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jc(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Cm(e,t){var r=Am(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Xc),o=r[1].match(Xc);return Jc(t,a)?[n,r[0]]:Jc(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function gn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[e],n==null&&(n=r.table&&r.table[Gc[e]]||ht[Gc[e]]),n==null&&(n=cm[e]||"General");break}if(va(n,0))return zo(t,r);t instanceof Date&&(t=Z0(t,r.date1904));var s=Cm(n,t);if(va(s[1]))return zo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return km(s[1],t,r,s[0])}function uf(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ht[r]==null){t<0&&(t=r);continue}if(ht[r]==e){t=r;break}}t<0&&(t=391)}return ht[t]=e,t}function Ka(e){for(var t=0;t!=392;++t)e[t]!==void 0&&uf(e[t],t)}function Ga(){ht=lm()}var ff=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Om(e){var t=typeof e=="number"?ht[e]:e;return t=t.replace(ff,"(\\d+)"),new RegExp("^"+t+"$")}function Rm(e,t,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(t.match(ff)||[]).forEach(function(f,p){var d=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:s=d;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var Im=(function(){var e={};e.version="1.2.0";function t(){for(var k=0,K=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,K[P]=k;return typeof Int32Array<"u"?new Int32Array(K):K}var r=t();function n(k){var K=0,P=0,q=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)Q[q]=k[q];for(q=0;q!=256;++q)for(P=k[q],K=256+q;K<4096;K+=256)P=Q[K]=P>>>8^k[P&255];var ne=[];for(q=1;q!=16;++q)ne[q-1]=typeof Int32Array<"u"?Q.subarray(q*256,q*256+256):Q.slice(q*256,q*256+256);return ne}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],f=s[6],p=s[7],d=s[8],v=s[9],h=s[10],g=s[11],w=s[12],E=s[13],_=s[14];function O(k,K){for(var P=K^-1,q=0,Q=k.length;q<Q;)P=P>>>8^r[(P^k.charCodeAt(q++))&255];return~P}function B(k,K){for(var P=K^-1,q=k.length-15,Q=0;Q<q;)P=_[k[Q++]^P&255]^E[k[Q++]^P>>8&255]^w[k[Q++]^P>>16&255]^g[k[Q++]^P>>>24]^h[k[Q++]]^v[k[Q++]]^d[k[Q++]]^p[k[Q++]]^f[k[Q++]]^u[k[Q++]]^c[k[Q++]]^l[k[Q++]]^o[k[Q++]]^a[k[Q++]]^i[k[Q++]]^r[k[Q++]];for(q+=15;Q<q;)P=P>>>8^r[(P^k[Q++])&255];return~P}function N(k,K){for(var P=K^-1,q=0,Q=k.length,ne=0,ve=0;q<Q;)ne=k.charCodeAt(q++),ne<128?P=P>>>8^r[(P^ne)&255]:ne<2048?(P=P>>>8^r[(P^(192|ne>>6&31))&255],P=P>>>8^r[(P^(128|ne&63))&255]):ne>=55296&&ne<57344?(ne=(ne&1023)+64,ve=k.charCodeAt(q++)&1023,P=P>>>8^r[(P^(240|ne>>8&7))&255],P=P>>>8^r[(P^(128|ne>>2&63))&255],P=P>>>8^r[(P^(128|ve>>6&15|(ne&3)<<4))&255],P=P>>>8^r[(P^(128|ve&63))&255]):(P=P>>>8^r[(P^(224|ne>>12&15))&255],P=P>>>8^r[(P^(128|ne>>6&63))&255],P=P>>>8^r[(P^(128|ne&63))&255]);return~P}return e.table=r,e.bstr=O,e.buf=B,e.str=N,e})(),tt=(function(){var t={};t.version="1.2.1";function r(m,b){for(var y=m.split("/"),T=b.split("/"),S=0,C=0,W=Math.min(y.length,T.length);S<W;++S){if(C=y[S].length-T[S].length)return C;if(y[S]!=T[S])return y[S]<T[S]?-1:1}return y.length-T.length}function n(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:n(m.slice(0,-1));var b=m.lastIndexOf("/");return b===-1?m:m.slice(0,b+1)}function s(m){if(m.charAt(m.length-1)=="/")return s(m.slice(0,-1));var b=m.lastIndexOf("/");return b===-1?m:m.slice(b+1)}function i(m,b){typeof b=="string"&&(b=new Date(b));var y=b.getHours();y=y<<6|b.getMinutes(),y=y<<5|b.getSeconds()>>>1,m.write_shift(2,y);var T=b.getFullYear()-1980;T=T<<4|b.getMonth()+1,T=T<<5|b.getDate(),m.write_shift(2,T)}function a(m){var b=m.read_shift(2)&65535,y=m.read_shift(2)&65535,T=new Date,S=y&31;y>>>=5;var C=y&15;y>>>=4,T.setMilliseconds(0),T.setFullYear(y+1980),T.setMonth(C-1),T.setDate(S);var W=b&31;b>>>=5;var X=b&63;return b>>>=6,T.setHours(b),T.setMinutes(X),T.setSeconds(W<<1),T}function o(m){ir(m,0);for(var b={},y=0;m.l<=m.length-4;){var T=m.read_shift(2),S=m.read_shift(2),C=m.l+S,W={};T===21589&&(y=m.read_shift(1),y&1&&(W.mtime=m.read_shift(4)),S>5&&(y&2&&(W.atime=m.read_shift(4)),y&4&&(W.ctime=m.read_shift(4))),W.mtime&&(W.mt=new Date(W.mtime*1e3))),m.l=C,b[T]=W}return b}var l;function c(){return l||(l={})}function u(m,b){if(m[0]==80&&m[1]==75)return $l(m,b);if((m[0]|32)==109&&(m[1]|32)==105)return Mh(m,b);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var y=3,T=512,S=0,C=0,W=0,X=0,j=0,H=[],V=m.slice(0,512);ir(V,0);var ie=f(V);switch(y=ie[0],y){case 3:T=512;break;case 4:T=4096;break;case 0:if(ie[1]==0)return $l(m,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+y)}T!==512&&(V=m.slice(0,T),ir(V,28));var ge=m.slice(0,T);p(V,y);var ye=V.read_shift(4,"i");if(y===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);V.l+=4,W=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),X=V.read_shift(4,"i"),S=V.read_shift(4,"i"),j=V.read_shift(4,"i"),C=V.read_shift(4,"i");for(var ue=-1,xe=0;xe<109&&(ue=V.read_shift(4,"i"),!(ue<0));++xe)H[xe]=ue;var Pe=d(m,T);g(j,C,Pe,T,H);var ot=E(Pe,W,H,T);ot[W].name="!Directory",S>0&&X!==ve&&(ot[X].name="!MiniFAT"),ot[H[0]].name="!FAT",ot.fat_addrs=H,ot.ssz=T;var lt={},Bt=[],ks=[],Cs=[];_(W,ot,Pe,Bt,S,lt,ks,X),v(ks,Cs,Bt),Bt.shift();var Os={FileIndex:ks,FullPaths:Cs};return b&&b.raw&&(Os.raw={header:ge,sectors:Pe}),Os}function f(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(je,"Header Signature: "),m.l+=16;var b=m.read_shift(2,"u");return[m.read_shift(2,"u"),b]}function p(m,b){var y=9;switch(m.l+=2,y=m.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+y);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+y)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function d(m,b){for(var y=Math.ceil(m.length/b)-1,T=[],S=1;S<y;++S)T[S-1]=m.slice(S*b,(S+1)*b);return T[y-1]=m.slice(y*b),T}function v(m,b,y){for(var T=0,S=0,C=0,W=0,X=0,j=y.length,H=[],V=[];T<j;++T)H[T]=V[T]=T,b[T]=y[T];for(;X<V.length;++X)T=V[X],S=m[T].L,C=m[T].R,W=m[T].C,H[T]===T&&(S!==-1&&H[S]!==S&&(H[T]=H[S]),C!==-1&&H[C]!==C&&(H[T]=H[C])),W!==-1&&(H[W]=T),S!==-1&&T!=H[T]&&(H[S]=H[T],V.lastIndexOf(S)<X&&V.push(S)),C!==-1&&T!=H[T]&&(H[C]=H[T],V.lastIndexOf(C)<X&&V.push(C));for(T=1;T<j;++T)H[T]===T&&(C!==-1&&H[C]!==C?H[T]=H[C]:S!==-1&&H[S]!==S&&(H[T]=H[S]));for(T=1;T<j;++T)if(m[T].type!==0){if(X=T,X!=H[X])do X=H[X],b[T]=b[X]+"/"+b[T];while(X!==0&&H[X]!==-1&&X!=H[X]);H[T]=-1}for(b[0]+="/",T=1;T<j;++T)m[T].type!==2&&(b[T]+="/")}function h(m,b,y){for(var T=m.start,S=m.size,C=[],W=T;y&&S>0&&W>=0;)C.push(b.slice(W*ne,W*ne+ne)),S-=ne,W=In(y,W*4);return C.length===0?G(0):It(C).slice(0,m.size)}function g(m,b,y,T,S){var C=ve;if(m===ve){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var W=y[m],X=(T>>>2)-1;if(!W)return;for(var j=0;j<X&&(C=In(W,j*4))!==ve;++j)S.push(C);g(In(W,T-4),b-1,y,T,S)}}function w(m,b,y,T,S){var C=[],W=[];S||(S=[]);var X=T-1,j=0,H=0;for(j=b;j>=0;){S[j]=!0,C[C.length]=j,W.push(m[j]);var V=y[Math.floor(j*4/T)];if(H=j*4&X,T<4+H)throw new Error("FAT boundary crossed: "+j+" 4 "+T);if(!m[V])break;j=In(m[V],H)}return{nodes:C,data:su([W])}}function E(m,b,y,T){var S=m.length,C=[],W=[],X=[],j=[],H=T-1,V=0,ie=0,ge=0,ye=0;for(V=0;V<S;++V)if(X=[],ge=V+b,ge>=S&&(ge-=S),!W[ge]){j=[];var ue=[];for(ie=ge;ie>=0;){ue[ie]=!0,W[ie]=!0,X[X.length]=ie,j.push(m[ie]);var xe=y[Math.floor(ie*4/T)];if(ye=ie*4&H,T<4+ye)throw new Error("FAT boundary crossed: "+ie+" 4 "+T);if(!m[xe]||(ie=In(m[xe],ye),ue[ie]))break}C[ge]={nodes:X,data:su([j])}}return C}function _(m,b,y,T,S,C,W,X){for(var j=0,H=T.length?2:0,V=b[m].data,ie=0,ge=0,ye;ie<V.length;ie+=128){var ue=V.slice(ie,ie+128);ir(ue,64),ge=ue.read_shift(2),ye=bl(ue,0,ge-H),T.push(ye);var xe={name:ye,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},Pe=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);Pe!==0&&(xe.ct=O(ue,ue.l-8));var ot=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);ot!==0&&(xe.mt=O(ue,ue.l-8)),xe.start=ue.read_shift(4,"i"),xe.size=ue.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=ve,xe.name=""),xe.type===5?(j=xe.start,S>0&&j!==ve&&(b[j].name="!StreamData")):xe.size>=4096?(xe.storage="fat",b[xe.start]===void 0&&(b[xe.start]=w(y,xe.start,b.fat_addrs,b.ssz)),b[xe.start].name=xe.name,xe.content=b[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:j!==ve&&xe.start!==ve&&b[j]&&(xe.content=h(xe,b[j].data,(b[X]||{}).data))),xe.content&&ir(xe.content,0),C[ye]=xe,W.push(xe)}}function O(m,b){return new Date((or(m,b+4)/1e7*Math.pow(2,32)+or(m,b)/1e7-11644473600)*1e3)}function B(m,b){return c(),u(l.readFileSync(m),b)}function N(m,b){var y=b&&b.type;switch(y||Ve&&Buffer.isBuffer(m)&&(y="buffer"),y||"base64"){case"file":return B(m,b);case"base64":return u(Tr(Yr(m)),b);case"binary":return u(Tr(m),b)}return u(m,b)}function k(m,b){var y=b||{},T=y.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=T+"/",m.FileIndex[0]={name:T,type:5}),y.CLSID&&(m.FileIndex[0].clsid=y.CLSID),K(m)}function K(m){var b="Sh33tJ5";if(!tt.find(m,"/"+b)){var y=G(4);y[0]=55,y[1]=y[3]=50,y[2]=54,m.FileIndex.push({name:b,type:2,content:y,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+b),P(m)}}function P(m,b){k(m);for(var y=!1,T=!1,S=m.FullPaths.length-1;S>=0;--S){var C=m.FileIndex[S];switch(C.type){case 0:T?y=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(C.R*C.L*C.C)&&(y=!0),C.R>-1&&C.L>-1&&C.R==C.L&&(y=!0);break;default:y=!0;break}}if(!(!y&&!b)){var W=new Date(1987,1,19),X=0,j=Object.create?Object.create(null):{},H=[];for(S=0;S<m.FullPaths.length;++S)j[m.FullPaths[S]]=!0,m.FileIndex[S].type!==0&&H.push([m.FullPaths[S],m.FileIndex[S]]);for(S=0;S<H.length;++S){var V=n(H[S][0]);T=j[V],T||(H.push([V,{name:s(V).replace("/",""),type:1,clsid:te,ct:W,mt:W,content:null}]),j[V]=!0)}for(H.sort(function(ye,ue){return r(ye[0],ue[0])}),m.FullPaths=[],m.FileIndex=[],S=0;S<H.length;++S)m.FullPaths[S]=H[S][0],m.FileIndex[S]=H[S][1];for(S=0;S<H.length;++S){var ie=m.FileIndex[S],ge=m.FullPaths[S];if(ie.name=s(ge).replace("/",""),ie.L=ie.R=ie.C=-(ie.color=1),ie.size=ie.content?ie.content.length:0,ie.start=0,ie.clsid=ie.clsid||te,S===0)ie.C=H.length>1?1:-1,ie.size=0,ie.type=5;else if(ge.slice(-1)=="/"){for(X=S+1;X<H.length&&n(m.FullPaths[X])!=ge;++X);for(ie.C=X>=H.length?-1:X,X=S+1;X<H.length&&n(m.FullPaths[X])!=n(ge);++X);ie.R=X>=H.length?-1:X,ie.type=1}else n(m.FullPaths[S+1]||"")==n(ge)&&(ie.R=S+1),ie.type=2}}}function q(m,b){var y=b||{};if(y.fileType=="mad")return Uh(m,y);if(P(m),y.fileType==="zip")return Fh(m,y);var T=(function(ye){for(var ue=0,xe=0,Pe=0;Pe<ye.FileIndex.length;++Pe){var ot=ye.FileIndex[Pe];if(ot.content){var lt=ot.content.length;lt>0&&(lt<4096?ue+=lt+63>>6:xe+=lt+511>>9)}}for(var Bt=ye.FullPaths.length+3>>2,ks=ue+7>>3,Cs=ue+127>>7,Os=ks+xe+Bt+Cs,wn=Os+127>>7,Za=wn<=109?0:Math.ceil((wn-109)/127);Os+wn+Za+127>>7>wn;)Za=++wn<=109?0:Math.ceil((wn-109)/127);var Mr=[1,Za,wn,Cs,Bt,xe,ue,0];return ye.FileIndex[0].size=ue<<6,Mr[7]=(ye.FileIndex[0].start=Mr[0]+Mr[1]+Mr[2]+Mr[3]+Mr[4]+Mr[5])+(Mr[6]+7>>3),Mr})(m),S=G(T[7]<<9),C=0,W=0;{for(C=0;C<8;++C)S.write_shift(1,J[C]);for(C=0;C<8;++C)S.write_shift(2,0);for(S.write_shift(2,62),S.write_shift(2,3),S.write_shift(2,65534),S.write_shift(2,9),S.write_shift(2,6),C=0;C<3;++C)S.write_shift(2,0);for(S.write_shift(4,0),S.write_shift(4,T[2]),S.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),S.write_shift(4,0),S.write_shift(4,4096),S.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:ve),S.write_shift(4,T[3]),S.write_shift(-4,T[1]?T[0]-1:ve),S.write_shift(4,T[1]),C=0;C<109;++C)S.write_shift(-4,C<T[2]?T[1]+C:-1)}if(T[1])for(W=0;W<T[1];++W){for(;C<236+W*127;++C)S.write_shift(-4,C<T[2]?T[1]+C:-1);S.write_shift(-4,W===T[1]-1?ve:W+1)}var X=function(ye){for(W+=ye;C<W-1;++C)S.write_shift(-4,C+1);ye&&(++C,S.write_shift(-4,ve))};for(W=C=0,W+=T[1];C<W;++C)S.write_shift(-4,se.DIFSECT);for(W+=T[2];C<W;++C)S.write_shift(-4,se.FATSECT);X(T[3]),X(T[4]);for(var j=0,H=0,V=m.FileIndex[0];j<m.FileIndex.length;++j)V=m.FileIndex[j],V.content&&(H=V.content.length,!(H<4096)&&(V.start=W,X(H+511>>9)));for(X(T[6]+7>>3);S.l&511;)S.write_shift(-4,se.ENDOFCHAIN);for(W=C=0,j=0;j<m.FileIndex.length;++j)V=m.FileIndex[j],V.content&&(H=V.content.length,!(!H||H>=4096)&&(V.start=W,X(H+63>>6)));for(;S.l&511;)S.write_shift(-4,se.ENDOFCHAIN);for(C=0;C<T[4]<<2;++C){var ie=m.FullPaths[C];if(!ie||ie.length===0){for(j=0;j<17;++j)S.write_shift(4,0);for(j=0;j<3;++j)S.write_shift(4,-1);for(j=0;j<12;++j)S.write_shift(4,0);continue}V=m.FileIndex[C],C===0&&(V.start=V.size?V.start-1:ve);var ge=C===0&&y.root||V.name;if(H=2*(ge.length+1),S.write_shift(64,ge,"utf16le"),S.write_shift(2,H),S.write_shift(1,V.type),S.write_shift(1,V.color),S.write_shift(-4,V.L),S.write_shift(-4,V.R),S.write_shift(-4,V.C),V.clsid)S.write_shift(16,V.clsid,"hex");else for(j=0;j<4;++j)S.write_shift(4,0);S.write_shift(4,V.state||0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,V.start),S.write_shift(4,V.size),S.write_shift(4,0)}for(C=1;C<m.FileIndex.length;++C)if(V=m.FileIndex[C],V.size>=4096)if(S.l=V.start+1<<9,Ve&&Buffer.isBuffer(V.content))V.content.copy(S,S.l,0,V.size),S.l+=V.size+511&-512;else{for(j=0;j<V.size;++j)S.write_shift(1,V.content[j]);for(;j&511;++j)S.write_shift(1,0)}for(C=1;C<m.FileIndex.length;++C)if(V=m.FileIndex[C],V.size>0&&V.size<4096)if(Ve&&Buffer.isBuffer(V.content))V.content.copy(S,S.l,0,V.size),S.l+=V.size+63&-64;else{for(j=0;j<V.size;++j)S.write_shift(1,V.content[j]);for(;j&63;++j)S.write_shift(1,0)}if(Ve)S.l=S.length;else for(;S.l<S.length;)S.write_shift(1,0);return S}function Q(m,b){var y=m.FullPaths.map(function(j){return j.toUpperCase()}),T=y.map(function(j){var H=j.split("/");return H[H.length-(j.slice(-1)=="/"?2:1)]}),S=!1;b.charCodeAt(0)===47?(S=!0,b=y[0].slice(0,-1)+b):S=b.indexOf("/")!==-1;var C=b.toUpperCase(),W=S===!0?y.indexOf(C):T.indexOf(C);if(W!==-1)return m.FileIndex[W];var X=!C.match(Hi);for(C=C.replace(zs,""),X&&(C=C.replace(Hi,"!")),W=0;W<y.length;++W)if((X?y[W].replace(Hi,"!"):y[W]).replace(zs,"")==C||(X?T[W].replace(Hi,"!"):T[W]).replace(zs,"")==C)return m.FileIndex[W];return null}var ne=64,ve=-2,je="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function we(m,b,y){c();var T=q(m,y);l.writeFileSync(b,T)}function ke(m){for(var b=new Array(m.length),y=0;y<m.length;++y)b[y]=String.fromCharCode(m[y]);return b.join("")}function $e(m,b){var y=q(m,b);switch(b&&b.type||"buffer"){case"file":return c(),l.writeFileSync(b.filename,y),y;case"binary":return typeof y=="string"?y:ke(y);case"base64":return di(typeof y=="string"?y:ke(y));case"buffer":if(Ve)return Buffer.isBuffer(y)?y:tn(y);case"array":return typeof y=="string"?Tr(y):y}return y}var Se;function R(m){try{var b=m.InflateRaw,y=new b;if(y._processChunk(new Uint8Array([3,0]),y._finishFlushFlag),y.bytesRead)Se=m;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function U(m,b){if(!Se)return As(m,b);var y=Se.InflateRaw,T=new y,S=T._processChunk(m.slice(m.l),T._finishFlushFlag);return m.l+=T.bytesRead,S}function F(m){return Se?Se.deflateRawSync(m):St(m)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(m){var b=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(b>>16|b>>8|b)&255}for(var Ee=typeof Uint8Array<"u",pe=Ee?new Uint8Array(256):[],et=0;et<256;++et)pe[et]=Ae(et);function A(m,b){var y=pe[m&255];return b<=8?y>>>8-b:(y=y<<8|pe[m>>8&255],b<=16?y>>>16-b:(y=y<<8|pe[m>>16&255],y>>>24-b))}function I(m,b){var y=b&7,T=b>>>3;return(m[T]|(y<=6?0:m[T+1]<<8))>>>y&3}function M(m,b){var y=b&7,T=b>>>3;return(m[T]|(y<=5?0:m[T+1]<<8))>>>y&7}function ee(m,b){var y=b&7,T=b>>>3;return(m[T]|(y<=4?0:m[T+1]<<8))>>>y&15}function z(m,b){var y=b&7,T=b>>>3;return(m[T]|(y<=3?0:m[T+1]<<8))>>>y&31}function L(m,b){var y=b&7,T=b>>>3;return(m[T]|(y<=1?0:m[T+1]<<8))>>>y&127}function fe(m,b,y){var T=b&7,S=b>>>3,C=(1<<y)-1,W=m[S]>>>T;return y<8-T||(W|=m[S+1]<<8-T,y<16-T)||(W|=m[S+2]<<16-T,y<24-T)||(W|=m[S+3]<<24-T),W&C}function le(m,b,y){var T=b&7,S=b>>>3;return T<=5?m[S]|=(y&7)<<T:(m[S]|=y<<T&255,m[S+1]=(y&7)>>8-T),b+3}function ae(m,b,y){var T=b&7,S=b>>>3;return y=(y&1)<<T,m[S]|=y,b+1}function re(m,b,y){var T=b&7,S=b>>>3;return y<<=T,m[S]|=y&255,y>>>=8,m[S+1]=y,b+8}function Oe(m,b,y){var T=b&7,S=b>>>3;return y<<=T,m[S]|=y&255,y>>>=8,m[S+1]=y&255,m[S+2]=y>>>8,b+16}function me(m,b){var y=m.length,T=2*y>b?2*y:b+5,S=0;if(y>=b)return m;if(Ve){var C=Hc(T);if(m.copy)m.copy(C);else for(;S<m.length;++S)C[S]=m[S];return C}else if(Ee){var W=new Uint8Array(T);if(W.set)W.set(m);else for(;S<y;++S)W[S]=m[S];return W}return m.length=T,m}function Te(m){for(var b=new Array(m),y=0;y<m;++y)b[y]=0;return b}function Re(m,b,y){var T=1,S=0,C=0,W=0,X=0,j=m.length,H=Ee?new Uint16Array(32):Te(32);for(C=0;C<32;++C)H[C]=0;for(C=j;C<y;++C)m[C]=0;j=m.length;var V=Ee?new Uint16Array(j):Te(j);for(C=0;C<j;++C)H[S=m[C]]++,T<S&&(T=S),V[C]=0;for(H[0]=0,C=1;C<=T;++C)H[C+16]=X=X+H[C-1]<<1;for(C=0;C<j;++C)X=m[C],X!=0&&(V[C]=H[X+16]++);var ie=0;for(C=0;C<j;++C)if(ie=m[C],ie!=0)for(X=A(V[C],T)>>T-ie,W=(1<<T+4-ie)-1;W>=0;--W)b[X|W<<ie]=ie&15|C<<4;return T}var Me=Ee?new Uint16Array(512):Te(512),Ge=Ee?new Uint16Array(32):Te(32);if(!Ee){for(var Ue=0;Ue<512;++Ue)Me[Ue]=0;for(Ue=0;Ue<32;++Ue)Ge[Ue]=0}(function(){for(var m=[],b=0;b<32;b++)m.push(5);Re(m,Ge,32);var y=[];for(b=0;b<=143;b++)y.push(8);for(;b<=255;b++)y.push(9);for(;b<=279;b++)y.push(7);for(;b<=287;b++)y.push(8);Re(y,Me,288)})();var Nt=(function(){for(var b=Ee?new Uint8Array(32768):[],y=0,T=0;y<_e.length-1;++y)for(;T<_e[y+1];++T)b[T]=y;for(;T<32768;++T)b[T]=29;var S=Ee?new Uint8Array(259):[];for(y=0,T=0;y<Y.length-1;++y)for(;T<Y[y+1];++T)S[T]=y;function C(X,j){for(var H=0;H<X.length;){var V=Math.min(65535,X.length-H),ie=H+V==X.length;for(j.write_shift(1,+ie),j.write_shift(2,V),j.write_shift(2,~V&65535);V-- >0;)j[j.l++]=X[H++]}return j.l}function W(X,j){for(var H=0,V=0,ie=Ee?new Uint16Array(32768):[];V<X.length;){var ge=Math.min(65535,X.length-V);if(ge<10){for(H=le(j,H,+(V+ge==X.length)),H&7&&(H+=8-(H&7)),j.l=H/8|0,j.write_shift(2,ge),j.write_shift(2,~ge&65535);ge-- >0;)j[j.l++]=X[V++];H=j.l*8;continue}H=le(j,H,+(V+ge==X.length)+2);for(var ye=0;ge-- >0;){var ue=X[V];ye=(ye<<5^ue)&32767;var xe=-1,Pe=0;if((xe=ie[ye])&&(xe|=V&-32768,xe>V&&(xe-=32768),xe<V))for(;X[xe+Pe]==X[V+Pe]&&Pe<250;)++Pe;if(Pe>2){ue=S[Pe],ue<=22?H=re(j,H,pe[ue+1]>>1)-1:(re(j,H,3),H+=5,re(j,H,pe[ue-23]>>5),H+=3);var ot=ue<8?0:ue-4>>2;ot>0&&(Oe(j,H,Pe-Y[ue]),H+=ot),ue=b[V-xe],H=re(j,H,pe[ue]>>3),H-=3;var lt=ue<4?0:ue-2>>1;lt>0&&(Oe(j,H,V-xe-_e[ue]),H+=lt);for(var Bt=0;Bt<Pe;++Bt)ie[ye]=V&32767,ye=(ye<<5^X[V])&32767,++V;ge-=Pe-1}else ue<=143?ue=ue+48:H=ae(j,H,1),H=re(j,H,pe[ue]),ie[ye]=V&32767,++V}H=re(j,H,0)-1}return j.l=(H+7)/8|0,j.l}return function(j,H){return j.length<8?C(j,H):W(j,H)}})();function St(m){var b=G(50+Math.floor(m.length*1.1)),y=Nt(m,b);return b.slice(0,y)}var er=Ee?new Uint16Array(32768):Te(32768),tr=Ee?new Uint16Array(32768):Te(32768),rn=Ee?new Uint16Array(128):Te(128),Ss=1,Lt=1;function hr(m,b){var y=z(m,b)+257;b+=5;var T=z(m,b)+1;b+=5;var S=ee(m,b)+4;b+=4;for(var C=0,W=Ee?new Uint8Array(19):Te(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],j=1,H=Ee?new Uint8Array(8):Te(8),V=Ee?new Uint8Array(8):Te(8),ie=W.length,ge=0;ge<S;++ge)W[D[ge]]=C=M(m,b),j<C&&(j=C),H[C]++,b+=3;var ye=0;for(H[0]=0,ge=1;ge<=j;++ge)V[ge]=ye=ye+H[ge-1]<<1;for(ge=0;ge<ie;++ge)(ye=W[ge])!=0&&(X[ge]=V[ye]++);var ue=0;for(ge=0;ge<ie;++ge)if(ue=W[ge],ue!=0){ye=pe[X[ge]]>>8-ue;for(var xe=(1<<7-ue)-1;xe>=0;--xe)rn[ye|xe<<ue]=ue&7|ge<<3}var Pe=[];for(j=1;Pe.length<y+T;)switch(ye=rn[L(m,b)],b+=ye&7,ye>>>=3){case 16:for(C=3+I(m,b),b+=2,ye=Pe[Pe.length-1];C-- >0;)Pe.push(ye);break;case 17:for(C=3+M(m,b),b+=3;C-- >0;)Pe.push(0);break;case 18:for(C=11+L(m,b),b+=7;C-- >0;)Pe.push(0);break;default:Pe.push(ye),j<ye&&(j=ye);break}var ot=Pe.slice(0,y),lt=Pe.slice(y);for(ge=y;ge<286;++ge)ot[ge]=0;for(ge=T;ge<30;++ge)lt[ge]=0;return Ss=Re(ot,er,286),Lt=Re(lt,tr,30),b}function Ri(m,b){if(m[0]==3&&!(m[1]&3))return[Ln(b),2];for(var y=0,T=0,S=Hc(b||1<<18),C=0,W=S.length>>>0,X=0,j=0;(T&1)==0;){if(T=M(m,y),y+=3,T>>>1)T>>1==1?(X=9,j=5):(y=hr(m,y),X=Ss,j=Lt);else{y&7&&(y+=8-(y&7));var H=m[y>>>3]|m[(y>>>3)+1]<<8;if(y+=32,H>0)for(!b&&W<C+H&&(S=me(S,C+H),W=S.length);H-- >0;)S[C++]=m[y>>>3],y+=8;continue}for(;;){!b&&W<C+32767&&(S=me(S,C+32767),W=S.length);var V=fe(m,y,X),ie=T>>>1==1?Me[V]:er[V];if(y+=ie&15,ie>>>=4,(ie>>>8&255)===0)S[C++]=ie;else{if(ie==256)break;ie-=257;var ge=ie<8?0:ie-4>>2;ge>5&&(ge=0);var ye=C+Y[ie];ge>0&&(ye+=fe(m,y,ge),y+=ge),V=fe(m,y,j),ie=T>>>1==1?Ge[V]:tr[V],y+=ie&15,ie>>>=4;var ue=ie<4?0:ie-2>>1,xe=_e[ie];for(ue>0&&(xe+=fe(m,y,ue),y+=ue),!b&&W<ye&&(S=me(S,ye+100),W=S.length);C<ye;)S[C]=S[C-xe],++C}}}return b?[S,y+7>>>3]:[S.slice(0,C),y+7>>>3]}function As(m,b){var y=m.slice(m.l||0),T=Ri(y,b);return m.l+=T[1],T[0]}function Ul(m,b){if(m)typeof console<"u"&&console.error(b);else throw new Error(b)}function $l(m,b){var y=m;ir(y,0);var T=[],S=[],C={FileIndex:T,FullPaths:S};k(C,{root:b.root});for(var W=y.length-4;(y[W]!=80||y[W+1]!=75||y[W+2]!=5||y[W+3]!=6)&&W>=0;)--W;y.l=W+4,y.l+=4;var X=y.read_shift(2);y.l+=6;var j=y.read_shift(4);for(y.l=j,W=0;W<X;++W){y.l+=20;var H=y.read_shift(4),V=y.read_shift(4),ie=y.read_shift(2),ge=y.read_shift(2),ye=y.read_shift(2);y.l+=8;var ue=y.read_shift(4),xe=o(y.slice(y.l+ie,y.l+ie+ge));y.l+=ie+ge+ye;var Pe=y.l;y.l=ue+4,Ih(y,H,V,C,xe),y.l=Pe}return C}function Ih(m,b,y,T,S){m.l+=2;var C=m.read_shift(2),W=m.read_shift(2),X=a(m);if(C&8257)throw new Error("Unsupported ZIP encryption");for(var j=m.read_shift(4),H=m.read_shift(4),V=m.read_shift(4),ie=m.read_shift(2),ge=m.read_shift(2),ye="",ue=0;ue<ie;++ue)ye+=String.fromCharCode(m[m.l++]);if(ge){var xe=o(m.slice(m.l,m.l+ge));(xe[21589]||{}).mt&&(X=xe[21589].mt),((S||{})[21589]||{}).mt&&(X=S[21589].mt)}m.l+=ge;var Pe=m.slice(m.l,m.l+H);switch(W){case 8:Pe=U(m,V);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+W)}var ot=!1;C&8&&(j=m.read_shift(4),j==134695760&&(j=m.read_shift(4),ot=!0),H=m.read_shift(4),V=m.read_shift(4)),H!=b&&Ul(ot,"Bad compressed size: "+b+" != "+H),V!=y&&Ul(ot,"Bad uncompressed size: "+y+" != "+V),Qa(T,ye,Pe,{unsafe:!0,mt:X})}function Fh(m,b){var y=b||{},T=[],S=[],C=G(1),W=y.compression?8:0,X=0,j=0,H=0,V=0,ie=0,ge=m.FullPaths[0],ye=ge,ue=m.FileIndex[0],xe=[],Pe=0;for(j=1;j<m.FullPaths.length;++j)if(ye=m.FullPaths[j].slice(ge.length),ue=m.FileIndex[j],!(!ue.size||!ue.content||ye=="Sh33tJ5")){var ot=V,lt=G(ye.length);for(H=0;H<ye.length;++H)lt.write_shift(1,ye.charCodeAt(H)&127);lt=lt.slice(0,lt.l),xe[ie]=Im.buf(ue.content,0);var Bt=ue.content;W==8&&(Bt=F(Bt)),C=G(30),C.write_shift(4,67324752),C.write_shift(2,20),C.write_shift(2,X),C.write_shift(2,W),ue.mt?i(C,ue.mt):C.write_shift(4,0),C.write_shift(-4,xe[ie]),C.write_shift(4,Bt.length),C.write_shift(4,ue.content.length),C.write_shift(2,lt.length),C.write_shift(2,0),V+=C.length,T.push(C),V+=lt.length,T.push(lt),V+=Bt.length,T.push(Bt),C=G(46),C.write_shift(4,33639248),C.write_shift(2,0),C.write_shift(2,20),C.write_shift(2,X),C.write_shift(2,W),C.write_shift(4,0),C.write_shift(-4,xe[ie]),C.write_shift(4,Bt.length),C.write_shift(4,ue.content.length),C.write_shift(2,lt.length),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(4,0),C.write_shift(4,ot),Pe+=C.l,S.push(C),Pe+=lt.length,S.push(lt),++ie}return C=G(22),C.write_shift(4,101010256),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(2,ie),C.write_shift(2,ie),C.write_shift(4,Pe),C.write_shift(4,V),C.write_shift(2,0),It([It(T),It(S),C])}var Ii={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Dh(m,b){if(m.ctype)return m.ctype;var y=m.name||"",T=y.match(/\.([^\.]+)$/);return T&&Ii[T[1]]||b&&(T=(y=b).match(/[\.\\]([^\.\\])+$/),T&&Ii[T[1]])?Ii[T[1]]:"application/octet-stream"}function Ph(m){for(var b=di(m),y=[],T=0;T<b.length;T+=76)y.push(b.slice(T,T+76));return y.join(`\r
`)+`\r
`}function Nh(m){var b=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var V=H.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var y=[],T=b.split(`\r
`),S=0;S<T.length;++S){var C=T[S];if(C.length==0){y.push("");continue}for(var W=0;W<C.length;){var X=76,j=C.slice(W,W+X);j.charAt(X-1)=="="?X--:j.charAt(X-2)=="="?X-=2:j.charAt(X-3)=="="&&(X-=3),j=C.slice(W,W+X),W+=X,W<C.length&&(j+="="),y.push(j)}}return y.join(`\r
`)}function Lh(m){for(var b=[],y=0;y<m.length;++y){for(var T=m[y];y<=m.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+m[++y];b.push(T)}for(var S=0;S<b.length;++S)b[S]=b[S].replace(/[=][0-9A-Fa-f]{2}/g,function(C){return String.fromCharCode(parseInt(C.slice(1),16))});return Tr(b.join(`\r
`))}function Bh(m,b,y){for(var T="",S="",C="",W,X=0;X<10;++X){var j=b[X];if(!j||j.match(/^\s*$/))break;var H=j.match(/^(.*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":T=H[2].trim();break;case"content-type":C=H[2].trim();break;case"content-transfer-encoding":S=H[2].trim();break}}switch(++X,S.toLowerCase()){case"base64":W=Tr(Yr(b.slice(X).join("")));break;case"quoted-printable":W=Lh(b.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+S)}var V=Qa(m,T.slice(y.length),W,{unsafe:!0});C&&(V.ctype=C)}function Mh(m,b){if(ke(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var y=b&&b.root||"",T=(Ve&&Buffer.isBuffer(m)?m.toString("binary"):ke(m)).split(`\r
`),S=0,C="";for(S=0;S<T.length;++S)if(C=T[S],!!/^Content-Location:/i.test(C)&&(C=C.slice(C.indexOf("file")),y||(y=C.slice(0,C.lastIndexOf("/")+1)),C.slice(0,y.length)!=y))for(;y.length>0&&(y=y.slice(0,y.length-1),y=y.slice(0,y.lastIndexOf("/")+1),C.slice(0,y.length)!=y););var W=(T[1]||"").match(/boundary="(.*?)"/);if(!W)throw new Error("MAD cannot find boundary");var X="--"+(W[1]||""),j=[],H=[],V={FileIndex:j,FullPaths:H};k(V);var ie,ge=0;for(S=0;S<T.length;++S){var ye=T[S];ye!==X&&ye!==X+"--"||(ge++&&Bh(V,T.slice(ie,S),y),ie=S)}return V}function Uh(m,b){var y=b||{},T=y.boundary||"SheetJS";T="------="+T;for(var S=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],C=m.FullPaths[0],W=C,X=m.FileIndex[0],j=1;j<m.FullPaths.length;++j)if(W=m.FullPaths[j].slice(C.length),X=m.FileIndex[j],!(!X.size||!X.content||W=="Sh33tJ5")){W=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var H=X.content,V=Ve&&Buffer.isBuffer(H)?H.toString("binary"):ke(H),ie=0,ge=Math.min(1024,V.length),ye=0,ue=0;ue<=ge;++ue)(ye=V.charCodeAt(ue))>=32&&ye<128&&++ie;var xe=ie>=ge*4/5;S.push(T),S.push("Content-Location: "+(y.root||"file:///C:/SheetJS/")+W),S.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),S.push("Content-Type: "+Dh(X,W)),S.push(""),S.push(xe?Nh(V):Ph(V))}return S.push(T+`--\r
`),S.join(`\r
`)}function $h(m){var b={};return k(b,m),b}function Qa(m,b,y,T){var S=T&&T.unsafe;S||k(m);var C=!S&&tt.find(m,b);if(!C){var W=m.FullPaths[0];b.slice(0,W.length)==W?W=b:(W.slice(-1)!="/"&&(W+="/"),W=(W+b).replace("//","/")),C={name:s(b),type:2},m.FileIndex.push(C),m.FullPaths.push(W),S||tt.utils.cfb_gc(m)}return C.content=y,C.size=y?y.length:0,T&&(T.CLSID&&(C.clsid=T.CLSID),T.mt&&(C.mt=T.mt),T.ct&&(C.ct=T.ct)),C}function jh(m,b){k(m);var y=tt.find(m,b);if(y){for(var T=0;T<m.FileIndex.length;++T)if(m.FileIndex[T]==y)return m.FileIndex.splice(T,1),m.FullPaths.splice(T,1),!0}return!1}function Wh(m,b,y){k(m);var T=tt.find(m,b);if(T){for(var S=0;S<m.FileIndex.length;++S)if(m.FileIndex[S]==T)return m.FileIndex[S].name=s(y),m.FullPaths[S]=y,!0}return!1}function Hh(m){P(m,!0)}return t.find=Q,t.read=N,t.parse=u,t.write=$e,t.writeFile=we,t.utils={cfb_new:$h,cfb_add:Qa,cfb_del:jh,cfb_mov:Wh,cfb_gc:Hh,ReadShift:Js,CheckField:Of,prep_blob:ir,bconcat:It,use_zlib:R,_deflateRaw:St,_inflateRaw:As,consts:se},t})();function Fm(e){return typeof e=="string"?Va(e):Array.isArray(e)?sm(e):e}function Si(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Va(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?gi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Fm(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=bi(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yc(e,t){for(var r=[],n=Pt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function wl(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function qa(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Dm(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var xa=new Date(1899,11,30,0,0,0);function Qt(e,t){var r=e.getTime(),n=xa.getTime()+(e.getTimezoneOffset()-xa.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var hf=new Date,Pm=xa.getTime()+(hf.getTimezoneOffset()-xa.getTimezoneOffset())*6e4,Qc=hf.getTimezoneOffset();function df(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Pm),t.getTimezoneOffset()!==Qc&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Qc)*6e4),t}var Zc=new Date("2017-02-19T19:06:09.000Z"),pf=isNaN(Zc.getFullYear())?new Date("2/19/17"):Zc,Nm=pf.getFullYear()==2017;function Xt(e,t){var r=new Date(e);if(Nm)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(pf.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function za(e,t){if(Ve&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zt(e[r]));return t}function ft(e,t){for(var r="";r.length<t;)r+=e;return r}function Kr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Lm=["january","february","march","april","may","june","july","august","september","october","november","december"];function pi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Lm.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Le(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ve?n=tn(r):n=im(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function yl(){return tt.utils.cfb_new()}var xt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Bm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},El=wl(Bm),Tl=/[&<>'"]/g,Mm=/[\u0000-\u0008\u000b-\u001f]/g;function Qe(e){var t=e+"";return t.replace(Tl,function(r){return El[r]}).replace(Mm,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eu(e){return Qe(e).replace(/ /g,"_x0020_")}var gf=/[\u0000-\u001f]/g;function Um(e){var t=e+"";return t.replace(Tl,function(r){return El[r]}).replace(/\n/g,"<br/>").replace(gf,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $m(e){var t=e+"";return t.replace(Tl,function(r){return El[r]}).replace(gf,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function jm(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wm(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wo(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function tu(e){var t=Ln(2*e.length),r,n,s=1,i=0,a=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ru(e){return tn(e,"binary").toString("utf8")}var Ki="foo bar baz",Xs=Ve&&(ru(Ki)==wo(Ki)&&ru||tu(Ki)==wo(Ki)&&tu)||wo,gi=Ve?function(e){return tn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Hm=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),vf=/(^\s|\s$|\n)/;function Ft(e,t){return"<"+e+(t.match(vf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function vi(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function he(e,t,r){return"<"+e+(r!=null?vi(r):"")+(t!=null?(t.match(vf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xo(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Vm(e,t){switch(typeof e){case"string":var r=he("vt:lpwstr",Qe(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return he((e|0)==e?"vt:i4":"vt:r8",Qe(String(e)));case"boolean":return he("vt:bool",e?"true":"false")}if(e instanceof Date)return he("vt:filetime",Xo(e));throw new Error("Unable to serialize "+e)}var Et={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ys=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Km(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Gm(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var nu=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},su=Ve?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:tn(t)})):nu(e)}:nu,iu=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ms(e,s)));return n.join("").replace(zs,"")},bl=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(zs,""):iu(e,t,r)}:iu,au=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},mf=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):au(e,t,r)}:au,ou=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(ss(e,s)));return n.join("")},Ai=Ve?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ou(t,r,n)}:ou,xf=function(e,t){var r=or(e,t);return r>0?Ai(e,t+4,t+4+r-1):""},_f=xf,wf=function(e,t){var r=or(e,t);return r>0?Ai(e,t+4,t+4+r-1):""},yf=wf,Ef=function(e,t){var r=2*or(e,t);return r>0?Ai(e,t+4,t+4+r-1):""},Tf=Ef,bf=function(t,r){var n=or(t,r);return n>0?bl(t,r+4,r+4+n):""},Sf=bf,Af=function(e,t){var r=or(e,t);return r>0?Ai(e,t+4,t+4+r):""},kf=Af,Cf=function(e,t){return Km(e,t)},_a=Cf,Sl=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ve&&(_f=function(t,r){if(!Buffer.isBuffer(t))return xf(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},yf=function(t,r){if(!Buffer.isBuffer(t))return wf(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Tf=function(t,r){if(!Buffer.isBuffer(t))return Ef(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Sf=function(t,r){if(!Buffer.isBuffer(t))return bf(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},kf=function(t,r){if(!Buffer.isBuffer(t))return Af(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},_a=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Cf(t,r)},Sl=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ss=function(e,t){return e[t]},Ms=function(e,t){return e[t+1]*256+e[t]},qm=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},or=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},In=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zm=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Js(e,t){var r="",n,s,i=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Ve&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ms(this,c)),c+=2;e*=2;break;case"utf8":r=Ai(this,this.l,this.l+e);break;case"utf16le":e*=2,r=bl(this,this.l,this.l+e);break;case"wstr":return Js.call(this,e,"dbcs");case"lpstr-ansi":r=_f(this,this.l),e=4+or(this,this.l);break;case"lpstr-cp":r=yf(this,this.l),e=4+or(this,this.l);break;case"lpwstr":r=Tf(this,this.l),e=4+2*or(this,this.l);break;case"lpp4":e=4+or(this,this.l),r=Sf(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+or(this,this.l),r=kf(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=ss(this,this.l+e++))!==0;)i.push(Wi(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=Ms(this,this.l+e))!==0;)i.push(Wi(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ss(this,c),this.l=c+1,o=Js.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Wi(Ms(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=ss(this,c),this.l=c+1,o=Js.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Wi(ss(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=ss(this,this.l),this.l++,n;case 2:return n=(t==="i"?qm:Ms)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?In:zm)(this,this.l),this.l+=4,n):(s=or(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=_a(this,this.l):s=_a([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=mf(this,this.l,e);break}}return this.l+=e,r}var Xm=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Jm=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ym=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Qm(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)Ym(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Xm(this,t,this.l);break;case 8:if(n=8,r==="f"){Gm(this,t,this.l);break}case 16:break;case-4:n=4,Jm(this,t,this.l);break}return this.l+=n,this}function Of(e,t){var r=mf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ir(e,t){e.l=t,e.read_shift=Js,e.chk=Of,e.write_shift=Qm}function Br(e,t){e.l+=t}function G(e){var t=Ln(e);return ir(t,0),t}function Yt(){var e=[],t=Ve?256:2048,r=function(c){var u=G(c);return ir(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},a=function(){return s(),It(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:a,_bufs:e}}function Z(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=KE[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Sl(r)&&e.push(r)}}function Ys(e,t,r){var n=Zt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function lu(e,t,r){var n=Zt(e);return n.s=Ys(n.s,t.s,r),n.e=Ys(n.e,t.s,r),n}function Qs(e,t){if(e.cRel&&e.c<0)for(e=Zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ze(e);return!e.cRel&&e.cRel!=null&&(r=tx(r)),!e.rRel&&e.rRel!=null&&(r=Zm(r)),r}function yo(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dt(e.s.r)+":"+(e.e.rRel?"":"$")+Dt(e.e.r):Qs(e.s,t.biff)+":"+Qs(e.e,t.biff)}function Al(e){return parseInt(ex(e),10)-1}function Dt(e){return""+(e+1)}function Zm(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ex(e){return e.replace(/\$(\d+)$/,"$1")}function kl(e){for(var t=rx(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tx(e){return e.replace(/^([A-Z])/,"$$$1")}function rx(e){return e.replace(/^\$([A-Z])/,"$1")}function nx(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ze(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fr(e){var t=e.indexOf(":");return t==-1?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,t)),e:Tt(e.slice(t+1))}}function vt(e,t){return typeof t>"u"||typeof t=="number"?vt(e.s,e.e):(typeof e!="string"&&(e=Ze(e)),typeof t!="string"&&(t=Ze(t)),e==t?e:e+":"+t)}function at(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function cu(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gn(e.z,r?Qt(t):t)}catch{}try{return e.w=gn((e.XF||{}).numFmtId||(r?14:0),r?Qt(t):t)}catch{return""+t}}function Qr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ki[e.v]||e.v:t==null?cu(e,e.v):cu(e,t))}function Un(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Rf(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=at(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var d={v:t[f][p]},v=a+f,h=o+p;if(c.s.r>v&&(c.s.r=v),c.s.c>h&&(c.s.c=h),c.e.r<v&&(c.e.r=v),c.e.c<h&&(c.e.c=h),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))d=t[f][p];else if(Array.isArray(d.v)&&(d.f=t[f][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||ht[14],n.cellDates?(d.t="d",d.w=gn(d.z,Qt(d.v))):(d.t="n",d.v=Qt(d.v),d.w=gn(d.z,d.v))):d.t="s";if(s)i[v]||(i[v]=[]),i[v][h]&&i[v][h].z&&(d.z=i[v][h].z),i[v][h]=d;else{var g=Ze({c:h,r:v});i[g]&&i[g].z&&(d.z=i[g].z),i[g]=d}}}return c.s.c<1e7&&(i["!ref"]=vt(c)),i}function Es(e,t){return Rf(null,e,t)}function sx(e){return e.read_shift(4,"i")}function kr(e,t){return t||(t=G(4)),t.write_shift(4,e),t}function jt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function bt(e,t){var r=!1;return t==null&&(r=!0,t=G(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ix(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ax(e,t){return t||(t=G(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Cl(e,t){var r=e.l,n=e.read_shift(1),s=jt(e),i=[],a={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(ix(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function ox(e,t){var r=!1;return t==null&&(r=!0,t=G(15+4*e.t.length)),t.write_shift(1,0),bt(e.t,t),r?t.slice(0,t.l):t}var lx=Cl;function cx(e,t){var r=!1;return t==null&&(r=!0,t=G(23+4*e.t.length)),t.write_shift(1,1),bt(e.t,t),t.write_shift(4,1),ax({},t),r?t.slice(0,t.l):t}function mr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function $n(e,t){return t==null&&(t=G(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function jn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Wn(e,t){return t==null&&(t=G(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var ux=jt,If=bt;function Ol(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wa(e,t){var r=!1;return t==null&&(r=!0,t=G(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fx=jt,Jo=Ol,Rl=wa;function Ff(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?_a([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):In(t,0)>>2;return r?s/100:s}function Df(e,t){t==null&&(t=G(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Pf(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function hx(e,t){return t||(t=G(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Hn=Pf,Ts=hx;function bs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Bn(e,t){return(t||G(8)).write_shift(8,e,"f")}function dx(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Ex[s];c&&(t.rgb=wu(c));break;case 2:t.rgb=wu([a,o,l]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ya(e,t){if(t||(t=G(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function px(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function gx(e,t){t||(t=G(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Nf=2,sr=3,Gi=11,Ea=19,qi=64,vx=65,mx=71,xx=4108,_x=4126,Ot=80,uu={1:{n:"CodePage",t:Nf},2:{n:"Category",t:Ot},3:{n:"PresentationFormat",t:Ot},4:{n:"ByteCount",t:sr},5:{n:"LineCount",t:sr},6:{n:"ParagraphCount",t:sr},7:{n:"SlideCount",t:sr},8:{n:"NoteCount",t:sr},9:{n:"HiddenCount",t:sr},10:{n:"MultimediaClipCount",t:sr},11:{n:"ScaleCrop",t:Gi},12:{n:"HeadingPairs",t:xx},13:{n:"TitlesOfParts",t:_x},14:{n:"Manager",t:Ot},15:{n:"Company",t:Ot},16:{n:"LinksUpToDate",t:Gi},17:{n:"CharacterCount",t:sr},19:{n:"SharedDoc",t:Gi},22:{n:"HyperlinksChanged",t:Gi},23:{n:"AppVersion",t:sr,p:"version"},24:{n:"DigSig",t:vx},26:{n:"ContentType",t:Ot},27:{n:"ContentStatus",t:Ot},28:{n:"Language",t:Ot},29:{n:"Version",t:Ot},255:{},2147483648:{n:"Locale",t:Ea},2147483651:{n:"Behavior",t:Ea},1919054434:{}},fu={1:{n:"CodePage",t:Nf},2:{n:"Title",t:Ot},3:{n:"Subject",t:Ot},4:{n:"Author",t:Ot},5:{n:"Keywords",t:Ot},6:{n:"Comments",t:Ot},7:{n:"Template",t:Ot},8:{n:"LastAuthor",t:Ot},9:{n:"RevNumber",t:Ot},10:{n:"EditTime",t:qi},11:{n:"LastPrinted",t:qi},12:{n:"CreatedDate",t:qi},13:{n:"ModifiedDate",t:qi},14:{n:"PageCount",t:sr},15:{n:"WordCount",t:sr},16:{n:"CharCount",t:sr},17:{n:"Thumbnail",t:mx},18:{n:"Application",t:Ot},19:{n:"DocSecurity",t:sr},255:{},2147483648:{n:"Locale",t:Ea},2147483651:{n:"Behavior",t:Ea},1919054434:{}};function wx(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var yx=wx([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ex=Zt(yx),ki={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Tx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},zi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Lf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bf(e,t){var r=Dm(Tx),n=[],s;n[n.length]=xt,n[n.length]=he("Types",null,{xmlns:Et.CT,"xmlns:xsd":Et.xsd,"xmlns:xsi":Et.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return he("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(s=e[l][0],n[n.length]=he("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:zi[l][t.bookType]||zi[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=he("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:zi[l][t.bookType]||zi[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=he("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var He={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ps(e){var t=[xt,he("Relationships",null,{xmlns:Et.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=he("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ye(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[He.HLINK,He.XPATH,He.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function bx(e){var t=[xt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function hu(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Sx(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Ax(e){var t=[xt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(hu(e[r][0],e[r][1])),t.push(Sx("",e[r][0]));return t.push(hu("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Uf(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+da.version+"</meta:generator></office:meta></office:document-meta>"}var Nn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Eo(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Qe(t),n[n.length]=r?he(e,t,r):Ft(e,t))}function $f(e,t){var r=t||{},n=[xt,he("cp:coreProperties",null,{"xmlns:cp":Et.CORE_PROPS,"xmlns:dc":Et.dc,"xmlns:dcterms":Et.dcterms,"xmlns:dcmitype":Et.dcmitype,"xmlns:xsi":Et.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Eo("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Xo(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Eo("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Xo(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Nn.length;++i){var a=Nn[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Eo(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jf=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wf(e){var t=[],r=he;return e||(e={}),e.Application="SheetJS",t[t.length]=xt,t[t.length]=he("Properties",null,{xmlns:Et.EXT_PROPS,"xmlns:vt":Et.vt}),gs.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Qe(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Qe(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Hf(e){var t=[xt,he("Properties",null,{xmlns:Et.CUST_PROPS,"xmlns:vt":Et.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(s){++r,t[t.length]=he("property",Vm(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Qe(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var du={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function kx(e,t){var r=[];return Pt(du).map(function(n){for(var s=0;s<Nn.length;++s)if(Nn[s][1]==n)return Nn[s];for(s=0;s<gs.length;++s)if(gs[s][1]==n)return gs[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ft(du[n[1]]||n[1],s))}}),he("DocumentProperties",r.join(""),{xmlns:ar.o})}function Cx(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Pt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<Nn.length;++a)if(i==Nn[a][1])return;for(a=0;a<gs.length;++a)if(i==gs[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(he(eu(i),o,{"dt:dt":l}))}}),t&&Pt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=t[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(he(eu(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ar.o+'">'+s.join("")+"</"+n+">"}function Ox(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=G(8);return a.write_shift(4,n),a.write_shift(4,s),a}function pu(e,t){var r=G(4),n=G(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=G(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Ox(t);break;case 31:case 80:for(n=G(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return It([r,n])}var Vf=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Rx(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function gu(e,t,r){var n=G(8),s=[],i=[],a=8,o=0,l=G(8),c=G(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),s.push(c),a+=8+l.length,!t){c=G(8),c.write_shift(4,0),s.unshift(c);var u=[G(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=G(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=It(u),i.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Vf.indexOf(e[o][0])>-1||jf.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],d=0;if(t){d=+t[e[o][0]];var v=r[d];if(v.p=="version"&&typeof p=="string"){var h=p.split(".");p=(+h[0]<<16)+(+h[1]||0)}l=pu(v.t,p)}else{var g=Rx(p);g==-1&&(g=31,p=String(p)),l=pu(g,p)}i.push(l),c=G(8),c.write_shift(4,t?d:2+o),s.push(c),a+=8+l.length}var w=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,w),w+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),It([n].concat(s).concat(i))}function vu(e,t,r,n,s,i){var a=G(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,tt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,s?68:48);var l=gu(e,r,n);if(o.push(l),s){var c=gu(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(c)}return It(o)}function Ix(e,t){t||(t=G(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Fx(e,t){return e.read_shift(t)===1}function Kt(e,t){return t||(t=G(2)),t.write_shift(2,+!!e),t}function Kf(e){return e.read_shift(2,"u")}function pr(e,t){return t||(t=G(2)),t.write_shift(2,e),t}function Gf(e,t,r){return r||(r=G(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function Dx(e){var t=e.t||"",r=G(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=G(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return It(s)}function Px(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Nx(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Px(e,n,r)}function Lx(e,t,r){if(r.biff>5)return Nx(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zf(e,t,r){return r||(r=G(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function mu(e,t){t||(t=G(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Bx(e){var t=G(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(i==28)n=n.slice(1),mu(n,t);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&mu(s>-1?n.slice(s+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Mn(e,t,r,n){return n||(n=G(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Mx(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function Ux(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Xf(e,t){return t||(t=G(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Il(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=G(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function $x(e,t){var r=!t||t.biff==8,n=G(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function jx(e,t){var r=!t||t.biff>=8?2:1,n=G(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Wx(e,t){var r=G(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=Dx(e[s]);var i=It([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function Hx(){var e=G(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Vx(e){var t=G(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Kx(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=G(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Gx(e,t,r,n){var s=G(10);return Mn(e,t,n,s),s.write_shift(4,r),s}function qx(e,t,r,n,s){var i=!s||s.biff==8,a=G(8+ +i+(1+i)*r.length);return Mn(e,t,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function zx(e,t,r,n){var s=r&&r.biff==5;n||(n=G(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Xx(e,t){var r=t.biff==8||!t.biff?4:2,n=G(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function xu(e,t,r,n){var s=r&&r.biff==5;n||(n=G(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Jx(e){var t=G(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Yx(e,t,r,n,s,i){var a=G(8);return Mn(e,t,n,a),Gf(r,i,a),a}function Qx(e,t,r,n){var s=G(14);return Mn(e,t,n,s),Bn(r,s),s}function Zx(e,t,r){if(r.biff<8)return e_(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Mx(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function e_(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=qf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function t_(e){var t=G(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Xf(e[r],t);return t}function r_(e){var t=G(24),r=Tt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return It([t,Bx(e[1])])}function n_(e){var t=e[1].Tooltip,r=G(10+2*(t.length+1));r.write_shift(2,2048);var n=Tt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function s_(e){return e||(e=G(4)),e.write_shift(2,1),e.write_shift(2,1),e}function i_(e,t,r){if(!r.cellStyles)return Br(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function a_(e,t){var r=G(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function o_(e){for(var t=G(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function l_(e,t,r){var n=G(15);return Oi(n,e,t),n.write_shift(8,r,"f"),n}function c_(e,t,r){var n=G(9);return Oi(n,e,t),n.write_shift(2,r),n}var u_=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Ln(1);switch(l.type){case"base64":u=Tr(Yr(o));break;case"binary":u=Tr(o);break;case"buffer":case"array":u=o;break}ir(u,0);var f=u.read_shift(1),p=!!(f&136),d=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var h=0,g=521;f==2&&(h=u.read_shift(2)),u.l+=3,f!=2&&(h=u.read_shift(4)),h>1048576&&(h=1e6),f!=2&&(g=u.read_shift(2));var w=u.read_shift(2),E=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(E=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var _=[],O={},B=Math.min(u.length,f==2?521:g-10-(d?264:0)),N=v?32:11;u.l<B&&u[u.l]!=13;)switch(O={},O.name=pa.utils.decode(E,u.slice(u.l,u.l+N)).replace(/[\u0000\r\n].*$/g,""),u.l+=N,O.type=String.fromCharCode(u.read_shift(1)),f!=2&&!v&&(O.offset=u.read_shift(4)),O.len=u.read_shift(1),f==2&&(O.offset=u.read_shift(2)),O.dec=u.read_shift(1),O.name.length&&_.push(O),f!=2&&(u.l+=v?13:14),O.type){case"B":(!d||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var k=0,K=0;for(c[0]=[],K=0;K!=_.length;++K)c[0][K]=_[K].name;for(;h-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++k]=[],K=0,K=0;K!=_.length;++K){var P=u.slice(u.l,u.l+_[K].len);u.l+=_[K].len,ir(P,0);var q=pa.utils.decode(E,P);switch(_[K].type){case"C":q.trim().length&&(c[k][K]=q.replace(/\s+$/,""));break;case"D":q.length===8?c[k][K]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):c[k][K]=q;break;case"F":c[k][K]=parseFloat(q.trim());break;case"+":case"I":c[k][K]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":c[k][K]=!0;break;case"N":case"F":c[k][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[k][K]="##MEMO##"+(v?parseInt(q.trim(),10):P.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(c[k][K]=+q||0);break;case"@":c[k][K]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[k][K]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[k][K]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][K]=-P.read_shift(-8,"f");break;case"B":if(d&&_[K].len==8){c[k][K]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[K].len;break;case"0":if(_[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[K].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Es(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(o,l){try{return Un(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&hi(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Yt(),f=ka(o,{header:1,raw:!0,cellDates:!0}),p=f[0],d=f.slice(1),v=o["!cols"]||[],h=0,g=0,w=0,E=1;for(h=0;h<p.length;++h){if(((v[h]||{}).DBF||{}).name){p[h]=v[h].DBF.name,++w;continue}if(p[h]!=null){if(++w,typeof p[h]=="number"&&(p[h]=p[h].toString(10)),typeof p[h]!="string")throw new Error("DBF Invalid column name "+p[h]+" |"+typeof p[h]+"|");if(p.indexOf(p[h])!==h){for(g=0;g<1024;++g)if(p.indexOf(p[h]+"_"+g)==-1){p[h]+="_"+g;break}}}}var _=at(o["!ref"]),O=[],B=[],N=[];for(h=0;h<=_.e.c-_.s.c;++h){var k="",K="",P=0,q=[];for(g=0;g<d.length;++g)d[g][h]!=null&&q.push(d[g][h]);if(q.length==0||p[h]==null){O[h]="?";continue}for(g=0;g<q.length;++g){switch(typeof q[g]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=q[g]instanceof Date?"D":"C";break;default:K="C"}P=Math.max(P,String(q[g]).length),k=k&&k!=K?"C":K}P>250&&(P=250),K=((v[h]||{}).DBF||{}).type,K=="C"&&v[h].DBF.len>P&&(P=v[h].DBF.len),k=="B"&&K=="N"&&(k="N",N[h]=v[h].DBF.dec,P=v[h].DBF.len),B[h]=k=="C"||K=="N"?P:i[k]||0,E+=B[h],O[h]=k}var Q=u.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,d.length),Q.write_shift(2,296+32*w),Q.write_shift(2,E),h=0;h<4;++h)Q.write_shift(4,0);for(Q.write_shift(4,0|(+t[J0]||3)<<8),h=0,g=0;h<p.length;++h)if(p[h]!=null){var ne=u.next(32),ve=(p[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ne.write_shift(1,ve,"sbcs"),ne.write_shift(1,O[h]=="?"?"C":O[h],"sbcs"),ne.write_shift(4,g),ne.write_shift(1,B[h]||i[O[h]]||0),ne.write_shift(1,N[h]||0),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(1,0),ne.write_shift(4,0),ne.write_shift(4,0),g+=B[h]||i[O[h]]||0}var je=u.next(264);for(je.write_shift(4,13),h=0;h<65;++h)je.write_shift(4,0);for(h=0;h<d.length;++h){var J=u.next(E);for(J.write_shift(1,0),g=0;g<p.length;++g)if(p[g]!=null)switch(O[g]){case"L":J.write_shift(1,d[h][g]==null?63:d[h][g]?84:70);break;case"B":J.write_shift(8,d[h][g]||0,"f");break;case"N":var te="0";for(typeof d[h][g]=="number"&&(te=d[h][g].toFixed(N[g]||0)),w=0;w<B[g]-te.length;++w)J.write_shift(1,32);J.write_shift(1,te,"sbcs");break;case"D":d[h][g]?(J.write_shift(4,("0000"+d[h][g].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(d[h][g].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+d[h][g].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var se=String(d[h][g]!=null?d[h][g]:"").slice(0,B[g]);for(J.write_shift(1,se,"sbcs"),w=0;w<B[g]-se.length;++w)J.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}})(),f_=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var v=e[d];return typeof v=="number"?Wc(v):v},n=function(p,d,v){var h=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return h==59?p:Wc(h)};e["|"]=254;function s(p,d){switch(d.type){case"base64":return i(Yr(p),d);case"binary":return i(p,d);case"buffer":return i(Ve&&Buffer.isBuffer(p)?p.toString("binary"):bi(p),d);case"array":return i(za(p),d)}throw new Error("Unrecognized type "+d.type)}function i(p,d){var v=p.split(/[\n\r]+/),h=-1,g=-1,w=0,E=0,_=[],O=[],B=null,N={},k=[],K=[],P=[],q=0,Q;for(+d.codepage>=0&&hi(+d.codepage);w!==v.length;++w){q=0;var ne=v[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ve=ne.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),je=ve[0],J;if(ne.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&O.push(ne.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,se=!1,we=!1,ke=!1,$e=-1,Se=-1;for(E=1;E<ve.length;++E)switch(ve[E].charAt(0)){case"A":break;case"X":g=parseInt(ve[E].slice(1))-1,se=!0;break;case"Y":for(h=parseInt(ve[E].slice(1))-1,se||(g=0),Q=_.length;Q<=h;++Q)_[Q]=[];break;case"K":J=ve[E].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(Kr(J))?isNaN(pi(J).getDate())||(J=Xt(J)):(J=Kr(J),B!==null&&cf(B)&&(J=df(J))),te=!0;break;case"E":ke=!0;var R=cw(ve[E].slice(1),{r:h,c:g});_[h][g]=[_[h][g],R];break;case"S":we=!0,_[h][g]=[_[h][g],"S5S"];break;case"G":break;case"R":$e=parseInt(ve[E].slice(1))-1;break;case"C":Se=parseInt(ve[E].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+ne)}if(te&&(_[h][g]&&_[h][g].length==2?_[h][g][0]=J:_[h][g]=J,B=null),we){if(ke)throw new Error("SYLK shared formula cannot have own formula");var U=$e>-1&&_[$e][Se];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[h][g][1]=uw(U[1],{r:h-$e,c:g-Se})}break;case"F":var F=0;for(E=1;E<ve.length;++E)switch(ve[E].charAt(0)){case"X":g=parseInt(ve[E].slice(1))-1,++F;break;case"Y":for(h=parseInt(ve[E].slice(1))-1,Q=_.length;Q<=h;++Q)_[Q]=[];break;case"M":q=parseInt(ve[E].slice(1))/20;break;case"F":break;case"G":break;case"P":B=O[parseInt(ve[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=ve[E].slice(1).split(" "),Q=parseInt(P[0],10);Q<=parseInt(P[1],10);++Q)q=parseInt(P[2],10),K[Q-1]=q===0?{hidden:!0}:{wch:q},Fl(K[Q-1]);break;case"C":g=parseInt(ve[E].slice(1))-1,K[g]||(K[g]={});break;case"R":h=parseInt(ve[E].slice(1))-1,k[h]||(k[h]={}),q>0?(k[h].hpt=q,k[h].hpx=eh(q)):q===0&&(k[h].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+ne)}F<1&&(B=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+ne)}}return k.length>0&&(N["!rows"]=k),K.length>0&&(N["!cols"]=K),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,N]}function a(p,d){var v=s(p,d),h=v[0],g=v[1],w=Es(h,d);return Pt(g).forEach(function(E){w[E]=g[E]}),w}function o(p,d){return Un(a(p,d),d)}function l(p,d,v,h){var g="C;Y"+(v+1)+";X"+(h+1)+";K";switch(p.t){case"n":g+=p.v||0,p.f&&!p.F&&(g+=";E"+Pl(p.f,{r:v,c:h}));break;case"b":g+=p.v?"TRUE":"FALSE";break;case"e":g+=p.w||p.v;break;case"d":g+='"'+(p.w||p.v)+'"';break;case"s":g+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(p,d){d.forEach(function(v,h){var g="F;W"+(h+1)+" "+(h+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ta(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ba(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&p.push(g)})}function u(p,d){d.forEach(function(v,h){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*Sa(v.hpx)+";"),g.length>2&&p.push(g+"R"+(h+1))})}function f(p,d){var v=["ID;PWXL;N;E"],h=[],g=at(p["!ref"]),w,E=Array.isArray(p),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&c(v,p["!cols"]),p["!rows"]&&u(v,p["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var O=g.s.r;O<=g.e.r;++O)for(var B=g.s.c;B<=g.e.c;++B){var N=Ze({r:O,c:B});w=E?(p[O]||[])[B]:p[N],!(!w||w.v==null&&(!w.f||w.F))&&h.push(l(w,p,O,B))}return v.join(_)+_+h.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:f}})(),h_=(function(){function e(i,a){switch(a.type){case"base64":return t(Yr(i),a);case"binary":return t(i,a);case"buffer":return t(Ve&&Buffer.isBuffer(i)?i.toString("binary"):bi(i),a);case"array":return t(za(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),d=p[0],v=p[1];++u;for(var h=o[u]||"";(h.match(/["]/g)||[]).length&1&&u<o.length-1;)h+=`
`+o[++u];switch(h=h.trim(),+d){case-1:if(h==="BOT"){f[++l]=[],c=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?f[l][c]=!0:h==="FALSE"?f[l][c]=!1:isNaN(Kr(v))?isNaN(pi(v).getDate())?f[l][c]=v:f[l][c]=Xt(v):f[l][c]=Kr(v),++c;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),f[l][c++]=h!==""?h:null;break}if(h==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return Es(e(i,a),a)}function n(i,a){return Un(r(i,a),a)}var s=(function(){var i=function(l,c,u,f,p){l.push(c),l.push(u+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=at(l["!ref"]),f,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var h=Ze({r:d,c:v});if(f=p?(l[d]||[])[v]:l[h],!f){a(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=gn(f.z||ht[14],Qt(Xt(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,E=c.join(w);return E}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),Jf=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var d=f.split(`
`),v=-1,h=-1,g=0,w=[];g!==d.length;++g){var E=d[g].trim().split(":");if(E[0]==="cell"){var _=Tt(E[1]);if(w.length<=_.r)for(v=w.length;v<=_.r;++v)w[v]||(w[v]=[]);switch(v=_.r,h=_.c,E[2]){case"t":w[v][h]=e(E[3]);break;case"v":w[v][h]=+E[3];break;case"vtf":var O=E[E.length-1];case"vtc":E[3]==="nl"?w[v][h]=!!+E[4]:w[v][h]=+E[4],E[2]=="vtf"&&(w[v][h]=[w[v][h],O])}}}return p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),w}function n(f,p){return Es(r(f,p),p)}function s(f,p){return Un(n(f,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var p=[],d=[],v,h="",g=fr(f["!ref"]),w=Array.isArray(f),E=g.s.r;E<=g.e.r;++E)for(var _=g.s.c;_<=g.e.c;++_)if(h=Ze({r:E,c:_}),v=w?(f[E]||[])[_]:f[h],!(!v||v.v==null||v.t==="z")){switch(d=["cell",h,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var O=Qt(Xt(v.v));d[2]="vtc",d[3]="nd",d[4]=""+O,d[5]=v.w||gn(v.z||ht[14],O);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}})(),d_=(function(){function e(u,f,p,d,v){v.raw?f[p][d]=u:u===""||(u==="TRUE"?f[p][d]=!0:u==="FALSE"?f[p][d]=!1:isNaN(Kr(u))?isNaN(pi(u).getDate())?f[p][d]=u:f[p][d]=Xt(u):f[p][d]=Kr(u))}function t(u,f){var p=f||{},d=[];if(!u||u.length===0)return d;for(var v=u.split(/[\r\n]/),h=v.length-1;h>=0&&v[h].length===0;)--h;for(var g=10,w=0,E=0;E<=h;++E)w=v[E].indexOf(" "),w==-1?w=v[E].length:w++,g=Math.max(g,w);for(E=0;E<=h;++E){d[E]=[];var _=0;for(e(v[E].slice(0,g).trim(),d,E,_,p),_=1;_<=(v[E].length-g)/10+1;++_)e(v[E].slice(g+(_-1)*10,g+_*10).trim(),d,E,_,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},p=!1,d=0,v=0;d<u.length;++d)(v=u.charCodeAt(d))==34?p=!p:!p&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&v.push([f[d],d]);if(!v.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&v.push([f[d],d])}return v.sort(function(h,g){return h[0]-g[0]||n[h[1]]-n[g[1]]}),r[v.pop()[1]]||44}function i(u,f){var p=f||{},d="",v=p.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=s(u.slice(0,1024)):p&&p.FS?d=p.FS:d=s(u.slice(0,1024));var g=0,w=0,E=0,_=0,O=0,B=d.charCodeAt(0),N=!1,k=0,K=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?Om(p.dateNF):null;function q(){var Q=u.slice(_,O),ne={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)ne.t="z";else if(p.raw)ne.t="s",ne.v=Q;else if(Q.trim().length===0)ne.t="s",ne.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(ne.t="s",ne.v=Q.slice(2,-1).replace(/""/g,'"')):fw(Q)?(ne.t="n",ne.f=Q.slice(1)):(ne.t="s",ne.v=Q);else if(Q=="TRUE")ne.t="b",ne.v=!0;else if(Q=="FALSE")ne.t="b",ne.v=!1;else if(!isNaN(E=Kr(Q)))ne.t="n",p.cellText!==!1&&(ne.w=Q),ne.v=E;else if(!isNaN(pi(Q).getDate())||P&&Q.match(P)){ne.z=p.dateNF||ht[14];var ve=0;P&&Q.match(P)&&(Q=Rm(Q,p.dateNF,Q.match(P)||[]),ve=1),p.cellDates?(ne.t="d",ne.v=Xt(Q,ve)):(ne.t="n",ne.v=Qt(Xt(Q,ve))),p.cellText!==!1&&(ne.w=gn(ne.z,ne.v instanceof Date?Qt(ne.v):ne.v)),p.cellNF||delete ne.z}else ne.t="s",ne.v=Q;if(ne.t=="z"||(p.dense?(v[g]||(v[g]=[]),v[g][w]=ne):v[Ze({c:w,r:g})]=ne),_=O+1,K=u.charCodeAt(_),h.e.c<w&&(h.e.c=w),h.e.r<g&&(h.e.r=g),k==B)++w;else if(w=0,++g,p.sheetRows&&p.sheetRows<=g)return!0}e:for(;O<u.length;++O)switch(k=u.charCodeAt(O)){case 34:K===34&&(N=!N);break;case B:case 10:case 13:if(!N&&q())break e;break}return O-_>0&&q(),v["!ref"]=vt(h),v}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Es(t(u,f),f)}function o(u,f){var p="",d=f.type=="string"?[0,0,0,0]:ST(u,f);switch(f.type){case"base64":p=Yr(u);break;case"binary":p=u;break;case"buffer":f.codepage==65001?p=u.toString("utf8"):f.codepage&&typeof pa<"u"||(p=Ve&&Buffer.isBuffer(u)?u.toString("binary"):bi(u));break;case"array":p=za(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=Xs(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Xs(p):f.type=="binary"&&typeof pa<"u",p.slice(0,19)=="socialcalc:version:"?Jf.to_sheet(f.type=="string"?p:Xs(p),f):a(p,f)}function l(u,f){return Un(o(u,f),f)}function c(u){for(var f=[],p=at(u["!ref"]),d,v=Array.isArray(u),h=p.s.r;h<=p.e.r;++h){for(var g=[],w=p.s.c;w<=p.e.c;++w){var E=Ze({r:h,c:w});if(d=v?(u[h]||[])[w]:u[E],!d||d.v==null){g.push("          ");continue}for(var _=(d.w||(Qr(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";g.push(_+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})(),_u=(function(){function e(R,U,F){if(R){ir(R,R.l||0);for(var D=F.Enum||$e;R.l<R.length;){var Y=R.read_shift(2),_e=D[Y]||D[65535],Ae=R.read_shift(2),Ee=R.l+Ae,pe=_e.f&&_e.f(R,Ae,F);if(R.l=Ee,U(pe,_e,Y))return}}}function t(R,U){switch(U.type){case"base64":return r(Tr(Yr(R)),U);case"binary":return r(Tr(R),U);case"buffer":case"array":return r(R,U)}throw"Unsupported type "+U.type}function r(R,U){if(!R)return R;var F=U||{},D=F.dense?[]:{},Y="Sheet1",_e="",Ae=0,Ee={},pe=[],et=[],A={s:{r:0,c:0},e:{r:0,c:0}},I=F.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)F.Enum=$e,e(R,function(L,fe,le){switch(le){case 0:F.vers=L,L>=4096&&(F.qpro=!0);break;case 6:A=L;break;case 204:L&&(_e=L);break;case 222:_e=L;break;case 15:case 51:F.qpro||(L[1].v=L[1].v.slice(1));case 13:case 14:case 16:le==14&&(L[2]&112)==112&&(L[2]&15)>1&&(L[2]&15)<15&&(L[1].z=F.dateNF||ht[14],F.cellDates&&(L[1].t="d",L[1].v=df(L[1].v))),F.qpro&&L[3]>Ae&&(D["!ref"]=vt(A),Ee[Y]=D,pe.push(Y),D=F.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Ae=L[3],Y=_e||"Sheet"+(Ae+1),_e="");var ae=F.dense?(D[L[0].r]||[])[L[0].c]:D[Ze(L[0])];if(ae){ae.t=L[1].t,ae.v=L[1].v,L[1].z!=null&&(ae.z=L[1].z),L[1].f!=null&&(ae.f=L[1].f);break}F.dense?(D[L[0].r]||(D[L[0].r]=[]),D[L[0].r][L[0].c]=L[1]):D[Ze(L[0])]=L[1];break}},F);else if(R[2]==26||R[2]==14)F.Enum=Se,R[2]==14&&(F.qpro=!0,R.l=0),e(R,function(L,fe,le){switch(le){case 204:Y=L;break;case 22:L[1].v=L[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(L[3]>Ae&&(D["!ref"]=vt(A),Ee[Y]=D,pe.push(Y),D=F.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},Ae=L[3],Y="Sheet"+(Ae+1)),I>0&&L[0].r>=I)break;F.dense?(D[L[0].r]||(D[L[0].r]=[]),D[L[0].r][L[0].c]=L[1]):D[Ze(L[0])]=L[1],A.e.c<L[0].c&&(A.e.c=L[0].c),A.e.r<L[0].r&&(A.e.r=L[0].r);break;case 27:L[14e3]&&(et[L[14e3][0]]=L[14e3][1]);break;case 1537:et[L[0]]=L[1],L[0]==Ae&&(Y=L[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(D["!ref"]=vt(A),Ee[_e||Y]=D,pe.push(_e||Y),!et.length)return{SheetNames:pe,Sheets:Ee};for(var M={},ee=[],z=0;z<et.length;++z)Ee[pe[z]]?(ee.push(et[z]||pe[z]),M[et[z]]=Ee[et[z]]||Ee[pe[z]]):(ee.push(et[z]),M[et[z]]={"!ref":"A1"});return{SheetNames:ee,Sheets:M}}function n(R,U){var F=U||{};if(+F.codepage>=0&&hi(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Yt(),Y=at(R["!ref"]),_e=Array.isArray(R),Ae=[];de(D,0,i(1030)),de(D,6,l(Y));for(var Ee=Math.min(Y.e.r,8191),pe=Y.s.r;pe<=Ee;++pe)for(var et=Dt(pe),A=Y.s.c;A<=Y.e.c;++A){pe===Y.s.r&&(Ae[A]=$t(A));var I=Ae[A]+et,M=_e?(R[pe]||[])[A]:R[I];if(!(!M||M.t=="z"))if(M.t=="n")(M.v|0)==M.v&&M.v>=-32768&&M.v<=32767?de(D,13,d(pe,A,M.v)):de(D,14,h(pe,A,M.v));else{var ee=Qr(M);de(D,15,f(pe,A,ee.slice(0,239)))}}return de(D,1),D.end()}function s(R,U){var F=U||{};if(+F.codepage>=0&&hi(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Yt();de(D,0,a(R));for(var Y=0,_e=0;Y<R.SheetNames.length;++Y)(R.Sheets[R.SheetNames[Y]]||{})["!ref"]&&de(D,27,ke(R.SheetNames[Y],_e++));var Ae=0;for(Y=0;Y<R.SheetNames.length;++Y){var Ee=R.Sheets[R.SheetNames[Y]];if(!(!Ee||!Ee["!ref"])){for(var pe=at(Ee["!ref"]),et=Array.isArray(Ee),A=[],I=Math.min(pe.e.r,8191),M=pe.s.r;M<=I;++M)for(var ee=Dt(M),z=pe.s.c;z<=pe.e.c;++z){M===pe.s.r&&(A[z]=$t(z));var L=A[z]+ee,fe=et?(Ee[M]||[])[z]:Ee[L];if(!(!fe||fe.t=="z"))if(fe.t=="n")de(D,23,q(M,z,Ae,fe.v));else{var le=Qr(fe);de(D,22,k(M,z,Ae,le.slice(0,239)))}}++Ae}}return de(D,1),D.end()}function i(R){var U=G(2);return U.write_shift(2,R),U}function a(R){var U=G(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var F=0,D=0,Y=0,_e=0;_e<R.SheetNames.length;++_e){var Ae=R.SheetNames[_e],Ee=R.Sheets[Ae];if(!(!Ee||!Ee["!ref"])){++Y;var pe=fr(Ee["!ref"]);F<pe.e.r&&(F=pe.e.r),D<pe.e.c&&(D=pe.e.c)}}return F>8191&&(F=8191),U.write_shift(2,F),U.write_shift(1,Y),U.write_shift(1,D),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(R,U,F){var D={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&F.qpro?(D.s.c=R.read_shift(1),R.l++,D.s.r=R.read_shift(2),D.e.c=R.read_shift(1),R.l++,D.e.r=R.read_shift(2),D):(D.s.c=R.read_shift(2),D.s.r=R.read_shift(2),U==12&&F.qpro&&(R.l+=2),D.e.c=R.read_shift(2),D.e.r=R.read_shift(2),U==12&&F.qpro&&(R.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(R){var U=G(8);return U.write_shift(2,R.s.c),U.write_shift(2,R.s.r),U.write_shift(2,R.e.c),U.write_shift(2,R.e.r),U}function c(R,U,F){var D=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(D[0].c=R.read_shift(1),D[3]=R.read_shift(1),D[0].r=R.read_shift(2),R.l+=2):(D[2]=R.read_shift(1),D[0].c=R.read_shift(2),D[0].r=R.read_shift(2)),D}function u(R,U,F){var D=R.l+U,Y=c(R,U,F);if(Y[1].t="s",F.vers==20768){R.l++;var _e=R.read_shift(1);return Y[1].v=R.read_shift(_e,"utf8"),Y}return F.qpro&&R.l++,Y[1].v=R.read_shift(D-R.l,"cstr"),Y}function f(R,U,F){var D=G(7+F.length);D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,R),D.write_shift(1,39);for(var Y=0;Y<D.length;++Y){var _e=F.charCodeAt(Y);D.write_shift(1,_e>=128?95:_e)}return D.write_shift(1,0),D}function p(R,U,F){var D=c(R,U,F);return D[1].v=R.read_shift(2,"i"),D}function d(R,U,F){var D=G(7);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,R),D.write_shift(2,F,"i"),D}function v(R,U,F){var D=c(R,U,F);return D[1].v=R.read_shift(8,"f"),D}function h(R,U,F){var D=G(13);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,R),D.write_shift(8,F,"f"),D}function g(R,U,F){var D=R.l+U,Y=c(R,U,F);if(Y[1].v=R.read_shift(8,"f"),F.qpro)R.l=D;else{var _e=R.read_shift(2);O(R.slice(R.l,R.l+_e),Y),R.l+=_e}return Y}function w(R,U,F){var D=U&32768;return U&=-32769,U=(D?R:0)+(U>=8192?U-16384:U),(D?"":"$")+(F?$t(U):Dt(U))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(R,U){ir(R,0);for(var F=[],D=0,Y="",_e="",Ae="",Ee="";R.l<R.length;){var pe=R[R.l++];switch(pe){case 0:F.push(R.read_shift(8,"f"));break;case 1:_e=w(U[0].c,R.read_shift(2),!0),Y=w(U[0].r,R.read_shift(2),!1),F.push(_e+Y);break;case 2:{var et=w(U[0].c,R.read_shift(2),!0),A=w(U[0].r,R.read_shift(2),!1);_e=w(U[0].c,R.read_shift(2),!0),Y=w(U[0].r,R.read_shift(2),!1),F.push(et+A+":"+_e+Y)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(R.read_shift(2));break;case 6:{for(var I="";pe=R[R.l++];)I+=String.fromCharCode(pe);F.push('"'+I.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:Ee=F.pop(),Ae=F.pop(),F.push(["AND","OR"][pe-20]+"("+Ae+","+Ee+")");break;default:if(pe<32&&_[pe])Ee=F.pop(),Ae=F.pop(),F.push(Ae+_[pe]+Ee);else if(E[pe]){if(D=E[pe][1],D==69&&(D=R[R.l++]),D>F.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+F.join("|")+"|");return}var M=F.slice(-D);F.length-=D,F.push(E[pe][0]+"("+M.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}F.length==1?U[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function B(R){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=R.read_shift(2),U[3]=R[R.l++],U[0].c=R[R.l++],U}function N(R,U){var F=B(R);return F[1].t="s",F[1].v=R.read_shift(U-4,"cstr"),F}function k(R,U,F,D){var Y=G(6+D.length);Y.write_shift(2,R),Y.write_shift(1,F),Y.write_shift(1,U),Y.write_shift(1,39);for(var _e=0;_e<D.length;++_e){var Ae=D.charCodeAt(_e);Y.write_shift(1,Ae>=128?95:Ae)}return Y.write_shift(1,0),Y}function K(R,U){var F=B(R);F[1].v=R.read_shift(2);var D=F[1].v>>1;if(F[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return F[1].v=D,F}function P(R,U){var F=B(R),D=R.read_shift(4),Y=R.read_shift(4),_e=R.read_shift(2);if(_e==65535)return D===0&&Y===3221225472?(F[1].t="e",F[1].v=15):D===0&&Y===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var Ae=_e&32768;return _e=(_e&32767)-16446,F[1].v=(1-Ae*2)*(Y*Math.pow(2,_e+32)+D*Math.pow(2,_e)),F}function q(R,U,F,D){var Y=G(14);if(Y.write_shift(2,R),Y.write_shift(1,F),Y.write_shift(1,U),D==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var _e=0,Ae=0,Ee=0,pe=0;return D<0&&(_e=1,D=-D),Ae=Math.log2(D)|0,D/=Math.pow(2,Ae-31),pe=D>>>0,(pe&2147483648)==0&&(D/=2,++Ae,pe=D>>>0),D-=pe,pe|=2147483648,pe>>>=0,D*=Math.pow(2,32),Ee=D>>>0,Y.write_shift(4,Ee),Y.write_shift(4,pe),Ae+=16383+(_e?32768:0),Y.write_shift(2,Ae),Y}function Q(R,U){var F=P(R);return R.l+=U-14,F}function ne(R,U){var F=B(R),D=R.read_shift(4);return F[1].v=D>>6,F}function ve(R,U){var F=B(R),D=R.read_shift(8,"f");return F[1].v=D,F}function je(R,U){var F=ve(R);return R.l+=U-10,F}function J(R,U){return R[R.l+U-1]==0?R.read_shift(U,"cstr"):""}function te(R,U){var F=R[R.l++];F>U-1&&(F=U-1);for(var D="";D.length<F;)D+=String.fromCharCode(R[R.l++]);return D}function se(R,U,F){if(!(!F.qpro||U<21)){var D=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var Y=R.read_shift(U-21,"cstr");return[D,Y]}}function we(R,U){for(var F={},D=R.l+U;R.l<D;){var Y=R.read_shift(2);if(Y==14e3){for(F[Y]=[0,""],F[Y][0]=R.read_shift(2);R[R.l];)F[Y][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return F}function ke(R,U){var F=G(5+R.length);F.write_shift(2,14e3),F.write_shift(2,U);for(var D=0;D<R.length;++D){var Y=R.charCodeAt(D);F[F.l++]=Y>127?95:Y}return F[F.l++]=0,F}var $e={0:{n:"BOF",f:Kf},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:we},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ne},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})(),p_=/^\s|\s$|[\t\n\r]/;function Yf(e,t){if(!t.bookSST)return"";var r=[xt];r[r.length]=he("sst",null,{xmlns:ys[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(p_)&&(i+=' xml:space="preserve"'),i+=">"+Qe(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function g_(e){return[e.read_shift(4),e.read_shift(4)]}function v_(e,t){return t||(t=G(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var m_=ox;function x_(e){var t=Yt();Z(t,159,v_(e));for(var r=0;r<e.length;++r)Z(t,19,m_(e[r]));return Z(t,160),t.end()}function __(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Qf(e){var t=0,r,n=__(e),s=n.length+1,i,a,o,l,c;for(r=Ln(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var w_=(function(){function e(s,i){switch(i.type){case"base64":return t(Yr(s),i);case"binary":return t(s,i);case"buffer":return t(Ve&&Buffer.isBuffer(s)?s.toString("binary"):bi(s),i);case"array":return t(za(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var p=/\\\w+\b/g,d=0,v,h=-1;v=p.exec(u);){switch(v[0]){case"\\cell":var g=u.slice(d,p.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++h,g.length){var w={v:g,t:"s"};Array.isArray(o)?o[f][h]=w:o[Ze({r:f,c:h})]=w}break}d=p.lastIndex}h>c.e.c&&(c.e.c=h)}),o["!ref"]=vt(c),o}function r(s,i){return Un(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=at(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Ze({r:c,c:u});o=l?(s[c]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Qr(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function wu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var y_=6,Gr=y_;function Ta(e){return Math.floor((e+Math.round(128/Gr)/256)*Gr)}function ba(e){return Math.floor((e-5)/Gr*100+.5)/100}function Yo(e){return Math.round((e*Gr+5)/Gr*256)/256}function Fl(e){e.width?(e.wpx=Ta(e.width),e.wch=ba(e.wpx),e.MDW=Gr):e.wpx?(e.wch=ba(e.wpx),e.width=Yo(e.wch),e.MDW=Gr):typeof e.wch=="number"&&(e.width=Yo(e.wch),e.wpx=Ta(e.width),e.MDW=Gr),e.customWidth&&delete e.customWidth}var E_=96,Zf=E_;function Sa(e){return e*96/Zf}function eh(e){return e*Zf/96}function T_(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=he("numFmt",null,{numFmtId:n,formatCode:Qe(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=he("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function b_(e){var t=[];return t[t.length]=he("cellXfs",null),e.forEach(function(r){t[t.length]=he("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=he("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function th(e,t){var r=[xt,he("styleSheet",null,{xmlns:ys[0],"xmlns:vt":Et.vt})],n;return e.SSF&&(n=T_(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=b_(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function S_(e,t){var r=e.read_shift(2),n=jt(e);return[r,n]}function A_(e,t,r){r||(r=G(6+4*t.length)),r.write_shift(2,e),bt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function k_(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=px(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=dx(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jt(e),n}function C_(e,t){t||(t=G(153)),t.write_shift(2,e.sz*20),gx(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ya(e.color,t);var n=0;return n=2,t.write_shift(1,n),bt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var O_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],To,R_=Br;function yu(e,t){t||(t=G(84)),To||(To=wl(O_));var r=To[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ya({auto:1},t),ya({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function I_(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function rh(e,t,r){r||(r=G(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ns(e,t){return t||(t=G(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var F_=Br;function D_(e,t){return t||(t=G(51)),t.write_shift(1,0),Ns(null,t),Ns(null,t),Ns(null,t),Ns(null,t),Ns(null,t),t.length>t.l?t.slice(0,t.l):t}function P_(e,t){return t||(t=G(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),wa(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function N_(e,t,r){var n=G(2052);return n.write_shift(4,e),wa(t,n),wa(r,n),n.length>n.l?n.slice(0,n.l):n}function L_(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Z(e,615,kr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Z(e,44,A_(s,t[s]))}),Z(e,616))}}function B_(e){var t=1;Z(e,611,kr(t)),Z(e,43,C_({sz:12,color:{theme:1},name:"Calibri",family:2})),Z(e,612)}function M_(e){var t=2;Z(e,603,kr(t)),Z(e,45,yu({patternType:"none"})),Z(e,45,yu({patternType:"gray125"})),Z(e,604)}function U_(e){var t=1;Z(e,613,kr(t)),Z(e,46,D_()),Z(e,614)}function $_(e){var t=1;Z(e,626,kr(t)),Z(e,47,rh({numFmtId:0},65535)),Z(e,627)}function j_(e,t){Z(e,617,kr(t.length)),t.forEach(function(r){Z(e,47,rh(r,0))}),Z(e,618)}function W_(e){var t=1;Z(e,619,kr(t)),Z(e,48,P_({xfId:0,name:"Normal"})),Z(e,620)}function H_(e){var t=0;Z(e,505,kr(t)),Z(e,506)}function V_(e){var t=0;Z(e,508,N_(t,"TableStyleMedium9","PivotStyleMedium4")),Z(e,509)}function K_(e,t){var r=Yt();return Z(r,278),L_(r,e.SSF),B_(r),M_(r),U_(r),$_(r),j_(r,t.cellXfs),W_(r),H_(r),V_(r),Z(r,279),r.end()}function nh(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[xt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function G_(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jt(e)}}function q_(e){var t=G(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),bt(e.name,t),t.slice(0,t.l)}function z_(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function X_(e){var t=G(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function J_(e,t){var r=G(8+2*t.length);return r.write_shift(4,e),bt(t,r),r.slice(0,r.l)}function Y_(e){return e.l+=4,e.read_shift(4)!=0}function Q_(e,t){var r=G(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Z_(){var e=Yt();return Z(e,332),Z(e,334,kr(1)),Z(e,335,q_({name:"XLDAPR",version:12e4,flags:3496657072})),Z(e,336),Z(e,339,J_(1,"XLDAPR")),Z(e,52),Z(e,35,kr(514)),Z(e,4096,kr(0)),Z(e,4097,pr(1)),Z(e,36),Z(e,53),Z(e,340),Z(e,337,Q_(1)),Z(e,51,X_([[1,0]])),Z(e,338),Z(e,333),e.end()}function sh(){var e=[xt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ew(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ze(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var as=1024;function ih(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[he("xml",null,{"xmlns:v":ar.v,"xmlns:o":ar.o,"xmlns:x":ar.x,"xmlns:mv":ar.mv}).replace(/\/>/,">"),he("o:shapelayout",he("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),he("v:shapetype",[he("v:stroke",null,{joinstyle:"miter"}),he("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];as<e*1e3;)as+=1e3;return t.forEach(function(i){var a=Tt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?he("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=he("v:fill",l,o),u={on:"t",obscured:"t"};++as,s=s.concat(["<v:shape"+vi({id:"_x0000_s"+as,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,he("v:shadow",null,u),he("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ft("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ft("x:AutoFill","False"),Ft("x:Row",String(a.r)),Ft("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function ah(e){var t=[xt,he("comments",null,{xmlns:ys[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Qe(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Qe(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Ft("t",Qe(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;t.push(Ft("t",Qe(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function tw(e,t,r){var n=[xt,he("ThreadedComments",null,{xmlns:Et.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(he("threadedComment",Ft("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function rw(e){var t=[xt,he("personList",null,{xmlns:Et.TCMNT,"xmlns:x":ys[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(he("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function nw(e){var t={};t.iauthor=e.read_shift(4);var r=Hn(e);return t.rfx=r.s,t.ref=Ze(r.s),e.l+=16,t}function sw(e,t){return t==null&&(t=G(36)),t.write_shift(4,e[1].iauthor),Ts(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var iw=jt;function aw(e){return bt(e.slice(0,54))}function ow(e){var t=Yt(),r=[];return Z(t,628),Z(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Z(t,632,aw(s.a)))})}),Z(t,631),Z(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Tt(n[0]),e:Tt(n[0])};Z(t,635,sw([i,s])),s.t&&s.t.length>0&&Z(t,637,cx(s)),Z(t,636),delete s.iauthor})}),Z(t,634),Z(t,629),t.end()}function lw(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&tt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var oh=["xlsb","xlsm","xlam","biff8","xla"],cw=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,s+(o?"":"$")+$t(u)+(l?"":"$")+Dt(c)}return function(s,i){return t=i,s.replace(e,r)}})(),Dl=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Pl=(function(){return function(t,r){return t.replace(Dl,function(n,s,i,a,o,l){var c=kl(a)-(i?0:r.c),u=Al(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",p=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+p})}})();function uw(e,t){return e.replace(Dl,function(r,n,s,i,a,o){return n+(s=="$"?s+i:$t(kl(i)+t.c))+(a=="$"?a+o:Dt(Al(o)+t.r))})}function fw(e){return e.length!=1}function pt(e){e.l+=1}function vn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function lh(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ch(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=vn(e),o=vn(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ch(e){var t=vn(e),r=vn(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function hw(e,t,r){if(r.biff<8)return ch(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=vn(e),a=vn(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function uh(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dw(e);var n=e.read_shift(r&&r.biff==12?4:2),s=vn(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function dw(e){var t=vn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function pw(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gw(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return vw(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function vw(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function mw(e,t,r){var n=(e[e.l++]&96)>>5,s=lh(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function xw(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=lh(e,i,r);return[n,s,a]}function _w(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ww(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function yw(e,t,r){var n=(e[e.l++]&96)>>5,s=hw(e,t-1,r);return[n,s]}function Ew(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Eu(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Tw(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function bw(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Sw(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Aw(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kw(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function fh(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Cw(e){return e.read_shift(2),fh(e)}function Ow(e){return e.read_shift(2),fh(e)}function Rw(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=uh(e,0,r);return[n,s]}function Iw(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=gw(e,0,r);return[n,s]}function Fw(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=uh(e,0,r);return[n,s,i]}function Dw(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[D2[s],ph[s],n]}function Pw(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Nw(e);return[s,(i[0]===0?ph:F2)[i[1]]]}function Nw(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Lw(e,t,r){e.l+=r&&r.biff==2?3:4}function Bw(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Mw(e){return e.l++,ki[e.read_shift(1)]}function Uw(e){return e.l++,e.read_shift(2)}function $w(e){return e.l++,e.read_shift(1)!==0}function jw(e){return e.l++,bs(e)}function Ww(e,t,r){return e.l++,qf(e,t-1,r)}function Hw(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Fx(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ki[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=bs(e);break;case 2:r[1]=Lx(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Vw(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Hn:Ux)(e));return s}function Kw(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=Hw(e,r.biff);return a}function Gw(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function qw(e,t,r){if(r.biff==5)return zw(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function zw(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Xw(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Jw(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Yw(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Qw(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var Zw=Br,e2=Br,t2=Br;function Ci(e,t,r){return e.l+=2,[pw(e)]}function Nl(e){return e.l+=6,[]}var r2=Ci,n2=Nl,s2=Nl,i2=Ci;function hh(e){return e.l+=2,[Kf(e),e.read_shift(2)&1]}var a2=Ci,o2=hh,l2=Nl,c2=Ci,u2=Ci,f2=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function h2(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=f2[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function d2(e){return e.l+=2,[e.read_shift(4)]}function p2(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function g2(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function v2(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function m2(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function x2(e){return e.l+=4,[0,0]}var Tu={1:{n:"PtgExp",f:Bw},2:{n:"PtgTbl",f:t2},3:{n:"PtgAdd",f:pt},4:{n:"PtgSub",f:pt},5:{n:"PtgMul",f:pt},6:{n:"PtgDiv",f:pt},7:{n:"PtgPower",f:pt},8:{n:"PtgConcat",f:pt},9:{n:"PtgLt",f:pt},10:{n:"PtgLe",f:pt},11:{n:"PtgEq",f:pt},12:{n:"PtgGe",f:pt},13:{n:"PtgGt",f:pt},14:{n:"PtgNe",f:pt},15:{n:"PtgIsect",f:pt},16:{n:"PtgUnion",f:pt},17:{n:"PtgRange",f:pt},18:{n:"PtgUplus",f:pt},19:{n:"PtgUminus",f:pt},20:{n:"PtgPercent",f:pt},21:{n:"PtgParen",f:pt},22:{n:"PtgMissArg",f:pt},23:{n:"PtgStr",f:Ww},26:{n:"PtgSheet",f:p2},27:{n:"PtgEndSheet",f:g2},28:{n:"PtgErr",f:Mw},29:{n:"PtgBool",f:$w},30:{n:"PtgInt",f:Uw},31:{n:"PtgNum",f:jw},32:{n:"PtgArray",f:Ew},33:{n:"PtgFunc",f:Dw},34:{n:"PtgFuncVar",f:Pw},35:{n:"PtgName",f:Gw},36:{n:"PtgRef",f:Rw},37:{n:"PtgArea",f:mw},38:{n:"PtgMemArea",f:Xw},39:{n:"PtgMemErr",f:Zw},40:{n:"PtgMemNoMem",f:e2},41:{n:"PtgMemFunc",f:Jw},42:{n:"PtgRefErr",f:Yw},43:{n:"PtgAreaErr",f:_w},44:{n:"PtgRefN",f:Iw},45:{n:"PtgAreaN",f:yw},46:{n:"PtgMemAreaN",f:v2},47:{n:"PtgMemNoMemN",f:m2},57:{n:"PtgNameX",f:qw},58:{n:"PtgRef3d",f:Fw},59:{n:"PtgArea3d",f:xw},60:{n:"PtgRefErr3d",f:Qw},61:{n:"PtgAreaErr3d",f:ww},255:{}},_2={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},w2={1:{n:"PtgElfLel",f:hh},2:{n:"PtgElfRw",f:c2},3:{n:"PtgElfCol",f:r2},6:{n:"PtgElfRwV",f:u2},7:{n:"PtgElfColV",f:i2},10:{n:"PtgElfRadical",f:a2},11:{n:"PtgElfRadicalS",f:l2},13:{n:"PtgElfColS",f:n2},15:{n:"PtgElfColSV",f:s2},16:{n:"PtgElfRadicalLel",f:o2},25:{n:"PtgList",f:h2},29:{n:"PtgSxName",f:d2},255:{}},y2={0:{n:"PtgAttrNoop",f:x2},1:{n:"PtgAttrSemi",f:kw},2:{n:"PtgAttrIf",f:Sw},4:{n:"PtgAttrChoose",f:Tw},8:{n:"PtgAttrGoto",f:bw},16:{n:"PtgAttrSum",f:Lw},32:{n:"PtgAttrBaxcel",f:Eu},33:{n:"PtgAttrBaxcel",f:Eu},64:{n:"PtgAttrSpace",f:Cw},65:{n:"PtgAttrSpaceSemi",f:Ow},128:{n:"PtgAttrIfError",f:Aw},255:{}};function E2(e,t,r,n){if(n.biff<8)return Br(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Kw(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Vw(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(Br(e,t)),i}function T2(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Tu[i]||Tu[_2[i]],(i===24||i===25)&&(s=(i===24?w2:y2)[e[e.l+1]]),!s||!s.f?Br(e,t):a.push([s.n,s.f(e,t,r)]);return a}function b2(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];a?a[0]===2?s.push('"'+a[1].replace(/"/g,'""')+'"'):s.push(a[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var S2={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function A2(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function dh(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function bu(e,t,r){var n=dh(e,t,r);return n=="#REF"?n:A2(n,r)}function _s(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,p=0,d,v="";if(!e[0]||!e[0][0])return"";for(var h=-1,g="",w=0,E=e[0].length;w<E;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),h>=0){switch(e[0][h][1][0]){case 0:g=ft(" ",e[0][h][1][1]);break;case 1:g=ft("\r",e[0][h][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}c=c+g,h=-1}o.push(c+S2[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ys(_[1][1],a,s),o.push(Qs(u,i));break;case"PtgRefN":u=r?Ys(_[1][1],r,s):_[1][1],o.push(Qs(u,i));break;case"PtgRef3d":f=_[1][1],u=Ys(_[1][2],a,s),v=bu(n,f,s),o.push(v+"!"+Qs(u,i));break;case"PtgFunc":case"PtgFuncVar":var O=_[1][0],B=_[1][1];O||(O=0),O&=127;var N=O==0?[]:o.slice(-O);o.length-=O,B==="User"&&(B=N.shift()),o.push(B+"("+N.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=lu(_[1][1],r?{s:r}:a,s),o.push(yo(d,s));break;case"PtgArea":d=lu(_[1][1],a,s),o.push(yo(d,s));break;case"PtgArea3d":f=_[1][1],d=_[1][2],v=bu(n,f,s),o.push(v+"!"+yo(d,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var k=(n.names||[])[p-1]||(n[0]||[])[p],K=k?k.Name:"SH33TJSNAME"+String(p);K&&K.slice(0,6)=="_xlfn."&&!s.xlfn&&(K=K.slice(6)),o.push(K);break;case"PtgNameX":var P=_[1][1];p=_[1][2];var q;if(s.biff<=5)P<0&&(P=-P),n[P]&&(q=n[P][p]);else{var Q="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(Q=n.SheetNames[n[P][p].itab-1]+"!"):Q=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])Q+=n[P][p].Name;else if(n[0]&&n[0][p])Q+=n[0][p].Name;else{var ne=(dh(n,P,s)||"").split(";;");ne[p-1]?Q=ne[p-1]:Q+="SH33TJSERRX"}o.push(Q);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var ve="(",je=")";if(h>=0){switch(g="",e[0][h][1][0]){case 2:ve=ft(" ",e[0][h][1][1])+ve;break;case 3:ve=ft("\r",e[0][h][1][1])+ve;break;case 4:je=ft(" ",e[0][h][1][1])+je;break;case 5:je=ft("\r",e[0][h][1][1])+je;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][h][1][0])}h=-1}o.push(ve+o.pop()+je);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var J={c:r.c,r:r.r};if(n.sharedf[Ze(u)]){var te=n.sharedf[Ze(u)];o.push(_s(te,a,J,n,s))}else{var se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(_s(c[1],a,J,n,s)),se=!0;break}se||o.push(_[1])}break;case"PtgArray":o.push("{"+b2(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var we=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&h>=0&&we.indexOf(e[0][w][0])==-1){_=e[0][h];var ke=!0;switch(_[1][0]){case 4:ke=!1;case 0:g=ft(" ",_[1][1]);break;case 5:ke=!1;case 1:g=ft("\r",_[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((ke?g:"")+o.pop()+(ke?"":g)),h=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function k2(e){if(e==null){var t=G(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Bn(e);return Bn(0)}function C2(e,t,r,n,s){var i=Mn(t,r,s),a=k2(e.v),o=G(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=G(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=It([i,a,o,c]);return f}function Xa(e,t,r){var n=e.read_shift(4),s=T2(e,n,r),i=e.read_shift(4),a=i>0?E2(e,i,s,r):null;return[s,a]}var O2=Xa,Ja=Xa,R2=Xa,I2=Xa,F2={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ph={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},D2={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function P2(e){var t="of:="+e.replace(Dl,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function N2(e){return e.replace(/\./,"!")}var Zs=typeof Map<"u";function Ll(e,t,r){var n=0,s=e.length;if(r){if(Zs?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Zs?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Zs?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Ya(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Gr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ba(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Yo(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function gh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _n(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){uf(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function L2(e,t,r){if(e&&e["!ref"]){var n=at(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function B2(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+vt(e[r])+'"/>';return t+"</mergeCells>"}function M2(e,t,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,a.codeName=gi(Qe(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+he("outlinePr",null,c)}!i&&!o||(s[s.length]=he("sheetPr",o,a))}var U2=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$2=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function j2(e){var t={sheet:1};return U2.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$2.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Qf(e.password).toString(16).toUpperCase()),he("sheetProtection",null,t)}function W2(e){return gh(e),he("pageMargins",null,e)}function H2(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=he("col",null,Ya(s,n)));return r[r.length]="</cols>",r.join("")}function V2(e,t,r,n){var s=typeof e.ref=="string"?e.ref:vt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=fr(s);a.s.r==a.e.r&&(a.e.r=fr(t["!ref"]).e.r,s=vt(a));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),he("autoFilter",null,{ref:s})}function K2(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),he("sheetViews",he("sheetView",null,s),{})}function G2(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ki[e.v];break;case"d":n&&n.cellDates?s=Xt(e.v,-1).toISOString():(e=Zt(e),e.t="n",s=""+(e.v=Qt(Xt(e.v)))),typeof e.z>"u"&&(e.z=ht[14]);break;default:s=e.v;break}var o=Ft("v",Qe(s)),l={r:t},c=_n(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ft("v",""+Ll(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=he("f",Qe(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),he("c",o,l)}function q2(e,t,r,n){var s=[],i=[],a=at(e["!ref"]),o="",l,c="",u=[],f=0,p=0,d=e["!rows"],v=Array.isArray(e),h={r:c},g,w=-1;for(p=a.s.c;p<=a.e.c;++p)u[p]=$t(p);for(f=a.s.r;f<=a.e.r;++f){for(i=[],c=Dt(f),p=a.s.c;p<=a.e.c;++p){l=u[p]+c;var E=v?(e[f]||[])[p]:e[l];E!==void 0&&(o=G2(E,l,e,t))!=null&&i.push(o)}(i.length>0||d&&d[f])&&(h={r:c},d&&d[f]&&(g=d[f],g.hidden&&(h.hidden=1),w=-1,g.hpx?w=Sa(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(h.ht=w,h.customHeight=1),g.level&&(h.outlineLevel=g.level)),s[s.length]=he("row",i.join(""),h))}if(d)for(;f<d.length;++f)d&&d[f]&&(h={r:f+1},g=d[f],g.hidden&&(h.hidden=1),w=-1,g.hpx?w=Sa(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(h.ht=w,h.customHeight=1),g.level&&(h.outlineLevel=g.level),s[s.length]=he("row","",h));return s.join("")}function vh(e,t,r,n){var s=[xt,he("worksheet",null,{xmlns:ys[0],"xmlns:r":Et.r})],i=r.SheetNames[e],a=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=at(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=vt(u)}n||(n={}),l["!comments"]=[];var f=[];M2(l,r,e,t,s),s[s.length]=he("dimension",null,{ref:c}),s[s.length]=K2(l,t,e,r),t.sheetFormat&&(s[s.length]=he("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=H2(l,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=q2(l,t),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=j2(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=V2(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=B2(l["!merges"]));var p=-1,d,v=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(h){h[1].Target&&(d={ref:h[0]},h[1].Target.charAt(0)!="#"&&(v=Ye(n,-1,Qe(h[1].Target).replace(/#.*$/,""),He.HLINK),d["r:id"]="rId"+v),(p=h[1].Target.indexOf("#"))>-1&&(d.location=Qe(h[1].Target.slice(p+1))),h[1].Tooltip&&(d.tooltip=Qe(h[1].Tooltip)),s[s.length]=he("hyperlink",null,d))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=W2(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ft("ignoredErrors",he("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(v=Ye(n,-1,"../drawings/drawing"+(e+1)+".xml",He.DRAW),s[s.length]=he("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=f),l["!comments"].length>0&&(v=Ye(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",He.VML),s[s.length]=he("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function z2(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function X2(e,t,r){var n=G(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=Sa(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,p=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ze(c)];v&&(f<0&&(f=d),p=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,p))}var h=n.l;return n.l=l,n.write_shift(4,o),n.l=h,n.length>n.l?n.slice(0,n.l):n}function J2(e,t,r,n){var s=X2(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Z(e,0,s)}var Y2=Hn,Q2=Ts;function Z2(){}function ey(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=ux(e),r}function ty(e,t,r){r==null&&(r=G(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return ya({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),If(e,r),r.slice(0,r.l)}function ry(e){var t=mr(e);return[t]}function ny(e,t,r){return r==null&&(r=G(8)),$n(t,r)}function sy(e){var t=jn(e);return[t]}function iy(e,t,r){return r==null&&(r=G(4)),Wn(t,r)}function ay(e){var t=mr(e),r=e.read_shift(1);return[t,r,"b"]}function oy(e,t,r){return r==null&&(r=G(9)),$n(t,r),r.write_shift(1,e.v?1:0),r}function ly(e){var t=jn(e),r=e.read_shift(1);return[t,r,"b"]}function cy(e,t,r){return r==null&&(r=G(5)),Wn(t,r),r.write_shift(1,e.v?1:0),r}function uy(e){var t=mr(e),r=e.read_shift(1);return[t,r,"e"]}function fy(e,t,r){return r==null&&(r=G(9)),$n(t,r),r.write_shift(1,e.v),r}function hy(e){var t=jn(e),r=e.read_shift(1);return[t,r,"e"]}function dy(e,t,r){return r==null&&(r=G(8)),Wn(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function py(e){var t=mr(e),r=e.read_shift(4);return[t,r,"s"]}function gy(e,t,r){return r==null&&(r=G(12)),$n(t,r),r.write_shift(4,t.v),r}function vy(e){var t=jn(e),r=e.read_shift(4);return[t,r,"s"]}function my(e,t,r){return r==null&&(r=G(8)),Wn(t,r),r.write_shift(4,t.v),r}function xy(e){var t=mr(e),r=bs(e);return[t,r,"n"]}function _y(e,t,r){return r==null&&(r=G(16)),$n(t,r),Bn(e.v,r),r}function wy(e){var t=jn(e),r=bs(e);return[t,r,"n"]}function yy(e,t,r){return r==null&&(r=G(12)),Wn(t,r),Bn(e.v,r),r}function Ey(e){var t=mr(e),r=Ff(e);return[t,r,"n"]}function Ty(e,t,r){return r==null&&(r=G(12)),$n(t,r),Df(e.v,r),r}function by(e){var t=jn(e),r=Ff(e);return[t,r,"n"]}function Sy(e,t,r){return r==null&&(r=G(8)),Wn(t,r),Df(e.v,r),r}function Ay(e){var t=mr(e),r=Cl(e);return[t,r,"is"]}function ky(e){var t=mr(e),r=jt(e);return[t,r,"str"]}function Cy(e,t,r){return r==null&&(r=G(12+4*e.v.length)),$n(t,r),bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Oy(e){var t=jn(e),r=jt(e);return[t,r,"str"]}function Ry(e,t,r){return r==null&&(r=G(8+4*e.v.length)),Wn(t,r),bt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Iy(e,t,r){var n=e.l+t,s=mr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=Ja(e,n-e.l,r);a[3]=_s(o,null,s,r.supbooks,r)}else e.l=n;return a}function Fy(e,t,r){var n=e.l+t,s=mr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=Ja(e,n-e.l,r);a[3]=_s(o,null,s,r.supbooks,r)}else e.l=n;return a}function Dy(e,t,r){var n=e.l+t,s=mr(e);s.r=r["!row"];var i=bs(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=Ja(e,n-e.l,r);a[3]=_s(o,null,s,r.supbooks,r)}else e.l=n;return a}function Py(e,t,r){var n=e.l+t,s=mr(e);s.r=r["!row"];var i=jt(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=Ja(e,n-e.l,r);a[3]=_s(o,null,s,r.supbooks,r)}else e.l=n;return a}var Ny=Hn,Ly=Ts;function By(e,t){return t==null&&(t=G(4)),t.write_shift(4,e),t}function My(e,t){var r=e.l+t,n=Hn(e),s=Ol(e),i=jt(e),a=jt(e),o=jt(e);e.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function Uy(e,t){var r=G(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ts({s:Tt(e[0]),e:Tt(e[0])},r),Rl("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return bt(s||"",r),bt(e[1].Tooltip||"",r),bt("",r),r.slice(0,r.l)}function $y(){}function jy(e,t,r){var n=e.l+t,s=Pf(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=O2(e,n-e.l,r);a[1]=o}else e.l=n;return a}function Wy(e,t,r){var n=e.l+t,s=Hn(e),i=[s];if(r.cellFormula){var a=I2(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function Hy(e,t,r){r==null&&(r=G(18));var n=Ya(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var mh=["left","right","top","bottom","header","footer"];function Vy(e){var t={};return mh.forEach(function(r){t[r]=bs(e)}),t}function Ky(e,t){return t==null&&(t=G(48)),gh(e),mh.forEach(function(r){Bn(e[r],t)}),t}function Gy(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function qy(e,t,r){r==null&&(r=G(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function zy(e){var t=G(24);return t.write_shift(4,4),t.write_shift(4,1),Ts(e,t),t}function Xy(e,t){return t==null&&(t=G(66)),t.write_shift(2,e.password?Qf(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Jy(){}function Yy(){}function Qy(e,t,r,n,s,i,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Zt(t),t.z=t.z||ht[14],t.v=Qt(Xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=_n(s.cellXfs,t,s),t.l&&i["!links"].push([Ze(l),t.l]),t.c&&i["!comments"].push([Ze(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Ll(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,a?Z(e,18,my(t,l)):Z(e,7,gy(t,l))):(l.t="str",a?Z(e,17,Ry(t,l)):Z(e,6,Cy(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Z(e,13,Sy(t,l)):Z(e,2,Ty(t,l)):a?Z(e,16,yy(t,l)):Z(e,5,_y(t,l)),!0;case"b":return l.t="b",a?Z(e,15,cy(t,l)):Z(e,4,oy(t,l)),!0;case"e":return l.t="e",a?Z(e,14,dy(t,l)):Z(e,3,fy(t,l)),!0}return a?Z(e,12,iy(t,l)):Z(e,1,ny(t,l)),!0}function Zy(e,t,r,n){var s=at(t["!ref"]||"A1"),i,a="",o=[];Z(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){a=Dt(u),J2(e,t,s,u);var f=!1;if(u<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){u===s.s.r&&(o[p]=$t(p)),i=o[p]+a;var d=l?(t[u]||[])[p]:t[i];if(!d){f=!1;continue}f=Qy(e,d,u,p,n,t,f)}}Z(e,146)}function eE(e,t){!t||!t["!merges"]||(Z(e,177,By(t["!merges"].length)),t["!merges"].forEach(function(r){Z(e,176,Ly(r))}),Z(e,178))}function tE(e,t){!t||!t["!cols"]||(Z(e,390),t["!cols"].forEach(function(r,n){r&&Z(e,60,Hy(n,r))}),Z(e,391))}function rE(e,t){!t||!t["!ref"]||(Z(e,648),Z(e,649,zy(at(t["!ref"]))),Z(e,650))}function nE(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ye(r,-1,n[1].Target.replace(/#.*$/,""),He.HLINK);Z(e,494,Uy(n,s))}}),delete t["!links"]}function sE(e,t,r,n){if(t["!comments"].length>0){var s=Ye(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",He.VML);Z(e,551,Rl("rId"+s)),t["!legacy"]=s}}function iE(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:vt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=fr(i);o.s.r==o.e.r&&(o.e.r=fr(t["!ref"]).e.r,i=vt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Z(e,161,Ts(at(i))),Z(e,162)}}function aE(e,t,r){Z(e,133),Z(e,137,qy(t,r)),Z(e,138),Z(e,134)}function oE(e,t){t["!protect"]&&Z(e,535,Xy(t["!protect"]))}function lE(e,t,r,n){var s=Yt(),i=r.SheetNames[e],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=at(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Z(s,129),(r.vbaraw||a["!outline"])&&Z(s,147,ty(o,a["!outline"])),Z(s,148,Q2(l)),aE(s,a,r.Workbook),tE(s,a),Zy(s,a,e,t),oE(s,a),iE(s,a,r,e),eE(s,a),nE(s,a,n),a["!margins"]&&Z(s,476,Ky(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&rE(s,a),sE(s,a,e,n),Z(s,130),s.end()}function cE(e,t){e.l+=10;var r=jt(e);return{name:r}}var uE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function fE(e){return!e.Workbook||!e.Workbook.WBProps?"false":Wm(e.Workbook.WBProps.date1904)?"true":"false"}var hE="][*?/\\".split("");function xh(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hE.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dE(e,t,r){e.forEach(function(n,s){xh(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[s]&&t[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function pE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];dE(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)L2(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function _h(e){var t=[xt];t[t.length]=he("workbook",null,{xmlns:ys[0],"xmlns:r":Et.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(uE.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=he("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:Qe(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=he("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=he("definedName",Qe(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function gE(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Jo(e),r.name=jt(e),r}function vE(e,t){return t||(t=G(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Rl(e.strRelID,t),bt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function mE(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?jt(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function xE(e,t){t||(t=G(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),If(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function _E(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=fx(e),a=R2(e,0,r),o=Ol(e);e.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function wE(e,t){Z(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Z(e,156,vE(s))}Z(e,144)}function yE(e,t){t||(t=G(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return bt("SheetJS",t),bt(da.version,t),bt(da.version,t),bt("7262",t),t.length>t.l?t.slice(0,t.l):t}function EE(e,t){t||(t=G(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function TE(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Z(e,135),Z(e,158,EE(s)),Z(e,136))}}function bE(e,t){var r=Yt();return Z(r,131),Z(r,128,yE()),Z(r,153,xE(e.Workbook&&e.Workbook.WBProps||null)),TE(r,e),wE(r,e),Z(r,132),r.end()}function SE(e,t,r){return(t.slice(-4)===".bin"?bE:_h)(e)}function AE(e,t,r,n,s){return(t.slice(-4)===".bin"?lE:vh)(e,r,n,s)}function kE(e,t,r){return(t.slice(-4)===".bin"?K_:th)(e,r)}function CE(e,t,r){return(t.slice(-4)===".bin"?x_:Yf)(e,r)}function OE(e,t,r){return(t.slice(-4)===".bin"?ow:ah)(e)}function RE(e){return(e.slice(-4)===".bin"?Z_:sh)()}function IE(e,t){var r=[];return e.Props&&r.push(kx(e.Props,t)),e.Custprops&&r.push(Cx(e.Props,e.Custprops)),r.join("")}function FE(){return""}function DE(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(he("NumberFormat",null,{"ss:Format":Qe(ht[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(he("Style",i.join(""),a))}),he("Styles",r.join(""))}function wh(e){return he("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Pl(e.Ref,{r:0,c:0})})}function PE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(wh(s)))}return he("Names",r.join(""))}function NE(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(wh(o)))}return i.join("")}function LE(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(he("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(he("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(he("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(he("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ft("ProtectContents","True")),e["!protect"].objects&&s.push(Ft("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ft("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ft("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ft("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":he("WorksheetOptions",s.join(""),{xmlns:ar.x})}function BE(e){return e.map(function(t){var r=jm(t.t||""),n=he("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return he("Comment",n,{"ss:Author":t.a})}).join("")}function ME(e,t,r,n,s,i,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Qe(Pl(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=Tt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Qe(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Qe(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=ki[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ht[14]);break;case"s":f="String",p=$m(e.v||"");break}var d=_n(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var v=e.v!=null?p:"",h=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(h+=BE(e.c)),he("Cell",h,o)}function UE(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=eh(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $E(e,t,r,n){if(!e["!ref"])return"";var s=at(e["!ref"]),i=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,w){Fl(g);var E=!!g.width,_=Ya(w,g),O={"ss:Index":w+1};E&&(O["ss:Width"]=Ta(_.width)),g.hidden&&(O["ss:Hidden"]="1"),o.push(he("Column",null,O))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var u=[UE(c,(e["!rows"]||[])[c])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>f)&&!(i[a].s.r>c)&&!(i[a].e.c<f)&&!(i[a].e.r<c)){(i[a].s.c!=f||i[a].s.r!=c)&&(p=!0);break}if(!p){var d={r:c,c:f},v=Ze(d),h=l?(e[c]||[])[f]:e[v];u.push(ME(h,v,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function jE(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],a=i?NE(i,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?$E(i,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(LE(i,t,e,r)),n.join("")}function WE(e,t){t||(t={}),e.SSF||(e.SSF=Zt(ht)),e.SSF&&(Ga(),Ka(e.SSF),t.revssf=qa(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_n(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(IE(e,t)),r.push(FE()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(he("Worksheet",jE(n,t,e),{"ss:Name":Qe(e.SheetNames[n])}));return r[2]=DE(e,t),r[3]=PE(e),xt+he("Workbook",r.join(""),{xmlns:ar.ss,"xmlns:o":ar.o,"xmlns:x":ar.x,"xmlns:ss":ar.ss,"xmlns:dt":ar.dt,"xmlns:html":ar.html})}var bo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function HE(e,t){var r=[],n=[],s=[],i=0,a,o=Yc(uu,"n"),l=Yc(fu,"n");if(e.Props)for(a=Pt(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Pt(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var c=[];for(i=0;i<s.length;++i)Vf.indexOf(s[i][0])>-1||jf.indexOf(s[i][0])>-1||s[i][1]!=null&&c.push(s[i]);n.length&&tt.utils.cfb_add(t,"/SummaryInformation",vu(n,bo.SI,l,fu)),(r.length||c.length)&&tt.utils.cfb_add(t,"/DocumentSummaryInformation",vu(r,bo.DSI,o,uu,c.length?c:null,bo.UDI))}function VE(e,t){var r=t||{},n=tt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tt.utils.cfb_add(n,s,yh(e,r)),r.biff==8&&(e.Props||e.Custprops)&&HE(e,n),r.biff==8&&e.vbaraw&&lw(n,tt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var KE={0:{f:z2},1:{f:ry},2:{f:Ey},3:{f:uy},4:{f:ay},5:{f:xy},6:{f:ky},7:{f:py},8:{f:Py},9:{f:Dy},10:{f:Iy},11:{f:Fy},12:{f:sy},13:{f:by},14:{f:hy},15:{f:ly},16:{f:wy},17:{f:Oy},18:{f:vy},19:{f:Cl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_E},40:{},42:{},43:{f:k_},44:{f:S_},45:{f:R_},46:{f:F_},47:{f:I_},48:{},49:{f:sx},50:{},51:{f:z_},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:i_},62:{f:Ay},63:{f:ew},64:{f:Jy},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Gy},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ey},148:{f:Y2,p:16},151:{f:$y},152:{},153:{f:mE},154:{},155:{},156:{f:gE},157:{},158:{},159:{T:1,f:g_},160:{T:-1},161:{T:1,f:Hn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ny},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:G_},336:{T:-1},337:{f:Y_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Zx},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jy},427:{f:Wy},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vy},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Z2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:My},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iw},633:{T:1},634:{T:-1},635:{T:1,f:nw},636:{T:-1},637:{f:lx},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cE},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Yy},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function de(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Sl(r)&&e.push(r)}}function GE(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return de(e,t,r,s);var i=t;if(!isNaN(i)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Oi(e,t,r){return e||(e=G(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function qE(e,t,r,n){var s=G(9);return Oi(s,e,t),Gf(r,n||"b",s),s}function zE(e,t,r){var n=G(8+2*r.length);return Oi(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function XE(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Qt(Xt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?de(e,2,c_(r,n,s)):de(e,3,l_(r,n,s));return;case"b":case"e":de(e,5,qE(r,n,t.v,t.t));return;case"s":case"str":de(e,4,zE(r,n,(t.v||"").slice(0,255)));return}de(e,1,Oi(null,r,n))}function JE(e,t,r,n){var s=Array.isArray(t),i=at(t["!ref"]||"A1"),a,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=vt(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Dt(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=$t(u)),a=l[u]+o;var f=s?(t[c]||[])[u]:t[a];f&&XE(e,f,c,u)}}}function YE(e,t){for(var r=t||{},n=Yt(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return de(n,r.biff==4?1033:r.biff==3?521:9,Il(e,16,r)),JE(n,e.Sheets[e.SheetNames[s]],s,r),de(n,10),n.end()}function QE(e,t,r){de(e,49,Kx({sz:12,name:"Arial"},r))}function ZE(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&de(e,1054,zx(s,t[s],r))})}function eT(e,t){var r=G(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),de(e,2151,r),r=G(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Xf(at(t["!ref"]||"A1"),r),r.write_shift(4,4),de(e,2152,r)}function tT(e,t){for(var r=0;r<16;++r)de(e,224,xu({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){de(e,224,xu(n,0,t))})}function rT(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];de(e,440,r_(n)),n[1].Tooltip&&de(e,2048,n_(n))}delete t["!links"]}function nT(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&de(e,125,a_(Ya(s,n),s))})}}function sT(e,t,r,n,s){var i=16+_n(s.cellXfs,t,s);if(t.v==null&&!t.bf){de(e,513,Mn(r,n,i));return}if(t.bf)de(e,6,C2(t,r,n,s,i));else switch(t.t){case"d":case"n":var a=t.t=="d"?Qt(Xt(t.v)):t.v;de(e,515,Qx(r,n,a,i));break;case"b":case"e":de(e,517,Yx(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Ll(s.Strings,t.v,s.revStrings);de(e,253,Gx(r,n,o,i))}else de(e,516,qx(r,n,(t.v||"").slice(0,255),i,s));break;default:de(e,513,Mn(r,n,i))}}function iT(e,t,r){var n=Yt(),s=r.SheetNames[e],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,f="",p=[],d=at(i["!ref"]||"A1"),v=c?65536:16384;if(d.e.c>255||d.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}de(n,2057,Il(r,16,t)),de(n,13,pr(1)),de(n,12,pr(100)),de(n,15,Kt(!0)),de(n,17,Kt(!1)),de(n,16,Bn(.001)),de(n,95,Kt(!0)),de(n,42,Kt(!1)),de(n,43,Kt(!1)),de(n,130,pr(1)),de(n,128,Jx()),de(n,131,Kt(!1)),de(n,132,Kt(!1)),c&&nT(n,i["!cols"]),de(n,512,Xx(d,t)),c&&(i["!links"]=[]);for(var h=d.s.r;h<=d.e.r;++h){f=Dt(h);for(var g=d.s.c;g<=d.e.c;++g){h===d.s.r&&(p[g]=$t(g)),u=p[g]+f;var w=l?(i[h]||[])[g]:i[u];w&&(sT(n,w,h,g,t),c&&w.l&&i["!links"].push([u,w.l]))}}var E=o.CodeName||o.name||s;return c&&de(n,574,Vx((a.Views||[])[0])),c&&(i["!merges"]||[]).length&&de(n,229,t_(i["!merges"])),c&&rT(n,i),de(n,442,zf(E)),c&&eT(n,i),de(n,10),n.end()}function aT(e,t,r){var n=Yt(),s=(e||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(de(n,2057,Il(e,5,r)),r.bookType=="xla"&&de(n,135),de(n,225,o?pr(1200):null),de(n,193,Ix(2)),l&&de(n,191),l&&de(n,192),de(n,226),de(n,92,$x("SheetJS",r)),de(n,66,pr(o?1200:1252)),o&&de(n,353,pr(0)),o&&de(n,448),de(n,317,o_(e.SheetNames.length)),o&&e.vbaraw&&de(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";de(n,442,zf(c))}de(n,156,pr(17)),de(n,25,Kt(!1)),de(n,18,Kt(!1)),de(n,19,pr(0)),o&&de(n,431,Kt(!1)),o&&de(n,444,pr(0)),de(n,61,Hx()),de(n,64,Kt(!1)),de(n,141,pr(0)),de(n,34,Kt(fE(e)=="true")),de(n,14,Kt(!0)),o&&de(n,439,Kt(!1)),de(n,218,pr(0)),QE(n,e,r),ZE(n,e.SSF,r),tT(n,r),o&&de(n,352,Kt(!1));var u=n.end(),f=Yt();o&&de(f,140,s_()),o&&r.Strings&&GE(f,252,Wx(r.Strings)),de(f,10);var p=f.end(),d=Yt(),v=0,h=0;for(h=0;h<e.SheetNames.length;++h)v+=(o?12:11)+(o?2:1)*e.SheetNames[h].length;var g=u.length+v+p.length;for(h=0;h<e.SheetNames.length;++h){var w=i[h]||{};de(d,133,jx({pos:g,hs:w.Hidden||0,dt:0,name:e.SheetNames[h]},r)),g+=t[h].length}var E=d.end();if(v!=E.length)throw new Error("BS8 "+v+" != "+E.length);var _=[];return u.length&&_.push(u),E.length&&_.push(E),p.length&&_.push(p),It(_)}function oT(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Zt(ht)),e&&e.SSF&&(Ga(),Ka(e.SSF),r.revssf=qa(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Bl(r),r.cellXfs=[],_n(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=iT(s,r,e);return n.unshift(aT(e,n,r)),It(n)}function yh(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=fr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return oT(e,t);case 4:case 3:case 2:return YE(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function lT(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ze({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],p=f&&f.v!=null&&(f.h||Um(f.w||(Qr(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),d.id=(n.id||"sjs")+"-"+u,i.push(he("td",p,d))}}var v="<tr>";return v+i.join("")+"</tr>"}var cT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uT="</body></html>";function fT(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Eh(e,t){var r=t||{},n=r.header!=null?r.header:cT,s=r.footer!=null?r.footer:uT,i=[n],a=fr(e["!ref"]);r.dense=Array.isArray(e),i.push(fT(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(lT(e,a,o,r));return i.push("</table>"+s),i.join("")}function Th(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Tt(n.origin):n.origin;s=a.r,i=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=fr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],p=0,d=e["!rows"]||(e["!rows"]=[]),v=0,h=0,g=0,w=0,E=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&h<l;++v){var O=o[v];if(Su(O)){if(n.display)continue;d[h]={hidden:!0}}var B=O.children;for(g=w=0;g<B.length;++g){var N=B[g];if(!(n.display&&Su(N))){var k=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Hm(N.innerHTML),K=N.getAttribute("data-z")||N.getAttribute("z");for(p=0;p<f.length;++p){var P=f[p];P.s.c==w+i&&P.s.r<h+s&&h+s<=P.e.r&&(w=P.e.c+1-i,p=-1)}_=+N.getAttribute("colspan")||1,((E=+N.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:h+s,c:w+i},e:{r:h+s+(E||1)-1,c:w+i+(_||1)-1}});var q={t:"s",v:k},Q=N.getAttribute("data-t")||N.getAttribute("t")||"";k!=null&&(k.length==0?q.t=Q||"z":n.raw||k.trim().length==0||Q=="s"||(k==="TRUE"?q={t:"b",v:!0}:k==="FALSE"?q={t:"b",v:!1}:isNaN(Kr(k))?isNaN(pi(k).getDate())||(q={t:"d",v:Xt(k)},n.cellDates||(q={t:"n",v:Qt(q.v)}),q.z=n.dateNF||ht[14]):q={t:"n",v:Kr(k)})),q.z===void 0&&K!=null&&(q.z=K);var ne="",ve=N.getElementsByTagName("A");if(ve&&ve.length)for(var je=0;je<ve.length&&!(ve[je].hasAttribute("href")&&(ne=ve[je].getAttribute("href"),ne.charAt(0)!="#"));++je);ne&&ne.charAt(0)!="#"&&(q.l={Target:ne}),n.dense?(e[h+s]||(e[h+s]=[]),e[h+s][w+i]=q):e[Ze({c:w+i,r:h+s})]=q,c.e.c<w+i&&(c.e.c=w+i),w+=_}}++h}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,h-1+s),e["!ref"]=vt(c),h>=l&&(e["!fullref"]=vt((c.e.r=o.length-v+h-1+s,c))),e}function bh(e,t){var r=t||{},n=r.dense?[]:{};return Th(n,e,t)}function hT(e,t){return Un(bh(e,t),t)}function Su(e){var t="",r=dT(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function dT(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var pT=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+vi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xt+t}})(),Au=(function(){var e=function(i){return Qe(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var l=[];l.push('      <table:table table:name="'+Qe(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=fr(i["!ref"]||"A1"),p=i["!merges"]||[],d=0,v=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var h="",g=i["!rows"]||[];for(c=0;c<f.s.r;++c)h=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+h+`></table:table-row>
`);for(;c<=f.e.r;++c){for(h=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+h+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var w=!1,E={},_="";for(d=0;d!=p.length;++d)if(!(p[d].s.c>u)&&!(p[d].s.r>c)&&!(p[d].e.c<u)&&!(p[d].e.r<c)){(p[d].s.c!=u||p[d].s.r!=c)&&(w=!0),E["table:number-columns-spanned"]=p[d].e.c-p[d].s.c+1,E["table:number-rows-spanned"]=p[d].e.r-p[d].s.r+1;break}if(w){l.push(r);continue}var O=Ze({r:c,c:u}),B=v?(i[c]||[])[u]:i[O];if(B&&B.f&&(E["table:formula"]=Qe(P2(B.f)),B.F&&B.F.slice(0,O.length)==O)){var N=fr(B.F);E["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,E["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!B){l.push(t);continue}switch(B.t){case"b":_=B.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=B.v?"true":"false";break;case"n":_=B.w||String(B.v||0),E["office:value-type"]="float",E["office:value"]=B.v||0;break;case"s":case"str":_=B.v==null?"":B.v,E["office:value-type"]="string";break;case"d":_=B.w||Xt(B.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Xt(B.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(_);if(B.l&&B.l.Target){var K=B.l.Target;K=K.charAt(0)=="#"?"#"+N2(K.slice(1)):K,K.charAt(0)!="#"&&!K.match(/^\w+:/)&&(K="../"+K),k=he("text:a",k,{"xlink:href":K.replace(/&/g,"&amp;")})}l.push("          "+he("table:table-cell",he("text:p",k,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Fl(f),f.ods=o;var p=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var l=[xt],c=vi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=vi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Uf().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function Sh(e,t){if(t.bookType=="fods")return Au(e,t);var r=yl(),n="",s=[],i=[];return n="mimetype",Le(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Le(r,n,Au(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Le(r,n,pT(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Le(r,n,xt+Uf()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Le(r,n,Ax(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Le(r,n,bx(s)),r}function Aa(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gT(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Tr(gi(e))}function vT(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function mn(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function mT(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function mi(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Je(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function vs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=mi(e,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=mi(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function Ct(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Je(n*8+s.type)),s.type==2&&t.push(Je(s.data.length)),t.push(s.data))})}),mn(t)}function xr(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=mi(e,n),i=wt(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:vs(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=wt(o.data),c=vs(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(a.merge=vs(i[3][0].data)>>>0>0),r.push(a)}return r}function Qn(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Je(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Je(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:Je(a.data.length)}],n[2].push({data:Ct(a.meta),type:2})});var i=Ct(n);t.push(Je(i.length)),t.push(i),s.forEach(function(a){return t.push(a)})}),mn(t)}function xT(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=mi(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[mn(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=mn(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function _r(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xT(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return mn(t)}function Zn(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Je(n),a=i.length;t.push(i),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return mn(t)}function So(e,t){var r=new Uint8Array(32),n=Aa(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,mT(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Ao(e,t){var r=new Uint8Array(32),n=Aa(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function nn(e){var t=wt(e);return mi(t[1][0].data)}function _T(e,t,r){var n,s,i,a;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&vs(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Aa(e[7][0].data),u=0,f=[],p=Aa(e[4][0].data),d=0,v=[],h=0;h<t.length;++h){if(t[h]==null){c.setUint16(h*2,65535,!0),p.setUint16(h*2,65535);continue}c.setUint16(h*2,u,!0),p.setUint16(h*2,d,!0);var g,w;switch(typeof t[h]){case"string":g=So({t:"s",v:t[h]},r),w=Ao({t:"s",v:t[h]},r);break;case"number":g=So({t:"n",v:t[h]},r),w=Ao({t:"n",v:t[h]},r);break;case"boolean":g=So({t:"b",v:t[h]},r),w=Ao({t:"b",v:t[h]},r);break;default:throw new Error("Unsupported value "+t[h])}f.push(g),u+=g.length,v.push(w),d+=w.length,++l}for(e[2][0].data=Je(l);h<e[7][0].data.length/2;++h)c.setUint16(h*2,65535,!0),p.setUint16(h*2,65535,!0);return e[6][0].data=mn(f),e[3][0].data=mn(v),l}function wT(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=fr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var i=ka(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(U){return U.forEach(function(F){typeof F=="string"&&a.push(F)})});var o={},l=[],c=tt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,F){return[U,c.FullPaths[F]]}).forEach(function(U){var F=U[0],D=U[1];if(F.type==2&&F.name.match(/\.iwa/)){var Y=F.content,_e=_r(Y),Ae=xr(_e);Ae.forEach(function(Ee){l.push(Ee.id),o[Ee.id]={deps:[],location:D,type:vs(Ee.messages[0].meta[1][0].data)}})}}),l.sort(function(U,F){return U-F});var u=l.filter(function(U){return U>1}).map(function(U){return[U,Je(U)]});c.FileIndex.map(function(U,F){return[U,c.FullPaths[F]]}).forEach(function(U){var F=U[0];if(U[1],!!F.name.match(/\.iwa/)){var D=xr(_r(F.content));D.forEach(function(Y){Y.messages.forEach(function(_e){u.forEach(function(Ae){Y.messages.some(function(Ee){return vs(Ee.meta[1][0].data)!=11006&&vT(Ee.data,Ae[1])})&&o[Ae[0]].deps.push(Y.id)})})})}});for(var f=tt.find(c,o[1].location),p=xr(_r(f.content)),d,v=0;v<p.length;++v){var h=p[v];h.id==1&&(d=h)}var g=nn(wt(d.messages[0].data)[1][0].data);for(f=tt.find(c,o[g].location),p=xr(_r(f.content)),v=0;v<p.length;++v)h=p[v],h.id==g&&(d=h);for(g=nn(wt(d.messages[0].data)[2][0].data),f=tt.find(c,o[g].location),p=xr(_r(f.content)),v=0;v<p.length;++v)h=p[v],h.id==g&&(d=h);for(g=nn(wt(d.messages[0].data)[2][0].data),f=tt.find(c,o[g].location),p=xr(_r(f.content)),v=0;v<p.length;++v)h=p[v],h.id==g&&(d=h);var w=wt(d.messages[0].data);{w[6][0].data=Je(n.e.r+1),w[7][0].data=Je(n.e.c+1);var E=nn(w[46][0].data),_=tt.find(c,o[E].location),O=xr(_r(_.content));{for(var B=0;B<O.length&&O[B].id!=E;++B);if(O[B].id!=E)throw"Bad ColumnRowUIDMapArchive";var N=wt(O[B].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var k=0;k<=n.e.c;++k){var K=[];K[1]=K[2]=[{type:0,data:Je(k+420690)}],N[1].push({type:2,data:Ct(K)}),N[2].push({type:0,data:Je(k)}),N[3].push({type:0,data:Je(k)})}N[4]=[],N[5]=[],N[6]=[];for(var P=0;P<=n.e.r;++P)K=[],K[1]=K[2]=[{type:0,data:Je(P+726270)}],N[4].push({type:2,data:Ct(K)}),N[5].push({type:0,data:Je(P)}),N[6].push({type:0,data:Je(P)});O[B].messages[0].data=Ct(N)}_.content=Zn(Qn(O)),_.size=_.content.length,delete w[46];var q=wt(w[4][0].data);{q[7][0].data=Je(n.e.r+1);var Q=wt(q[1][0].data),ne=nn(Q[2][0].data);_=tt.find(c,o[ne].location),O=xr(_r(_.content));{if(O[0].id!=ne)throw"Bad HeaderStorageBucket";var ve=wt(O[0].messages[0].data);for(P=0;P<i.length;++P){var je=wt(ve[2][0].data);je[1][0].data=Je(P),je[4][0].data=Je(i[P].length),ve[2][P]={type:ve[2][0].type,data:Ct(je)}}O[0].messages[0].data=Ct(ve)}_.content=Zn(Qn(O)),_.size=_.content.length;var J=nn(q[2][0].data);_=tt.find(c,o[J].location),O=xr(_r(_.content));{if(O[0].id!=J)throw"Bad HeaderStorageBucket";for(ve=wt(O[0].messages[0].data),k=0;k<=n.e.c;++k)je=wt(ve[2][0].data),je[1][0].data=Je(k),je[4][0].data=Je(n.e.r+1),ve[2][k]={type:ve[2][0].type,data:Ct(je)};O[0].messages[0].data=Ct(ve)}_.content=Zn(Qn(O)),_.size=_.content.length;var te=nn(q[4][0].data);(function(){for(var U=tt.find(c,o[te].location),F=xr(_r(U.content)),D,Y=0;Y<F.length;++Y){var _e=F[Y];_e.id==te&&(D=_e)}var Ae=wt(D.messages[0].data);{Ae[3]=[];var Ee=[];a.forEach(function(A,I){Ee[1]=[{type:0,data:Je(I)}],Ee[2]=[{type:0,data:Je(1)}],Ee[3]=[{type:2,data:gT(A)}],Ae[3].push({type:2,data:Ct(Ee)})})}D.messages[0].data=Ct(Ae);var pe=Qn(F),et=Zn(pe);U.content=et,U.size=U.content.length})();var se=wt(q[3][0].data);{var we=se[1][0];delete se[2];var ke=wt(we.data);{var $e=nn(ke[2][0].data);(function(){for(var U=tt.find(c,o[$e].location),F=xr(_r(U.content)),D,Y=0;Y<F.length;++Y){var _e=F[Y];_e.id==$e&&(D=_e)}var Ae=wt(D.messages[0].data);{delete Ae[6],delete se[7];var Ee=new Uint8Array(Ae[5][0].data);Ae[5]=[];for(var pe=0,et=0;et<=n.e.r;++et){var A=wt(Ee);pe+=_T(A,i[et],a),A[1][0].data=Je(et),Ae[5].push({data:Ct(A),type:2})}Ae[1]=[{type:0,data:Je(n.e.c+1)}],Ae[2]=[{type:0,data:Je(n.e.r+1)}],Ae[3]=[{type:0,data:Je(pe)}],Ae[4]=[{type:0,data:Je(n.e.r+1)}]}D.messages[0].data=Ct(Ae);var I=Qn(F),M=Zn(I);U.content=M,U.size=U.content.length})()}we.data=Ct(ke)}q[3][0].data=Ct(se)}w[4][0].data=Ct(q)}d.messages[0].data=Ct(w);var Se=Qn(p),R=Zn(Se);return f.content=R,f.size=f.content.length,c}function yT(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Bl(e){yT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ET(e,t){return t.bookType=="ods"?Sh(e,t):t.bookType=="numbers"?wT(e,t):t.bookType=="xlsb"?TT(e,t):bT(e,t)}function TT(e,t){as=1024,e&&!e.SSF&&(e.SSF=Zt(ht)),e&&e.SSF&&(Ga(),Ka(e.SSF),t.revssf=qa(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=oh.indexOf(t.bookType)>-1,s=Lf();Bl(t=t||{});var i=yl(),a="",o=0;if(t.cellXfs=[],_n(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Le(i,a,$f(e.Props,t)),s.coreprops.push(a),Ye(t.rels,2,a,He.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Le(i,a,Wf(e.Props)),s.extprops.push(a),Ye(t.rels,3,a,He.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Le(i,a,Hf(e.Custprops)),s.custprops.push(a),Ye(t.rels,4,a,He.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";if(a="xl/worksheets/sheet"+o+"."+r,Le(i,a,AE(o-1,a,t,e,u)),s.sheets.push(a),Ye(t.wbrels,-1,"worksheets/sheet"+o+"."+r,He.WS[0]),f){var d=f["!comments"],v=!1,h="";d&&d.length>0&&(h="xl/comments"+o+"."+r,Le(i,h,OE(d,h)),s.comments.push(h),Ye(u,-1,"../comments"+o+"."+r,He.CMNT),v=!0),f["!legacy"]&&v&&Le(i,"xl/drawings/vmlDrawing"+o+".vml",ih(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Le(i,Mf(a),ps(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Le(i,a,CE(t.Strings,a,t)),s.strs.push(a),Ye(t.wbrels,-1,"sharedStrings."+r,He.SST)),a="xl/workbook."+r,Le(i,a,SE(e,a)),s.workbooks.push(a),Ye(t.rels,1,a,He.WB),a="xl/theme/theme1.xml",Le(i,a,nh(e.Themes,t)),s.themes.push(a),Ye(t.wbrels,-1,"theme/theme1.xml",He.THEME),a="xl/styles."+r,Le(i,a,kE(e,a,t)),s.styles.push(a),Ye(t.wbrels,-1,"styles."+r,He.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Le(i,a,e.vbaraw),s.vba.push(a),Ye(t.wbrels,-1,"vbaProject.bin",He.VBA)),a="xl/metadata."+r,Le(i,a,RE(a)),s.metadata.push(a),Ye(t.wbrels,-1,"metadata."+r,He.XLMETA),Le(i,"[Content_Types].xml",Bf(s,t)),Le(i,"_rels/.rels",ps(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",ps(t.wbrels)),delete t.revssf,delete t.ssf,i}function bT(e,t){as=1024,e&&!e.SSF&&(e.SSF=Zt(ht)),e&&e.SSF&&(Ga(),Ka(e.SSF),t.revssf=qa(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zs?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=oh.indexOf(t.bookType)>-1,s=Lf();Bl(t=t||{});var i=yl(),a="",o=0;if(t.cellXfs=[],_n(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Le(i,a,$f(e.Props,t)),s.coreprops.push(a),Ye(t.rels,2,a,He.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Le(i,a,Wf(e.Props)),s.extprops.push(a),Ye(t.rels,3,a,He.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Le(i,a,Hf(e.Custprops)),s.custprops.push(a),Ye(t.rels,4,a,He.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],d=(p||{})["!type"]||"sheet";if(a="xl/worksheets/sheet"+o+"."+r,Le(i,a,vh(o-1,t,e,f)),s.sheets.push(a),Ye(t.wbrels,-1,"worksheets/sheet"+o+"."+r,He.WS[0]),p){var v=p["!comments"],h=!1,g="";if(v&&v.length>0){var w=!1;v.forEach(function(E){E[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+o+"."+r,Le(i,g,tw(v,u,t)),s.threadedcomments.push(g),Ye(f,-1,"../threadedComments/threadedComment"+o+"."+r,He.TCMNT)),g="xl/comments"+o+"."+r,Le(i,g,ah(v)),s.comments.push(g),Ye(f,-1,"../comments"+o+"."+r,He.CMNT),h=!0}p["!legacy"]&&h&&Le(i,"xl/drawings/vmlDrawing"+o+".vml",ih(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Le(i,Mf(a),ps(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Le(i,a,Yf(t.Strings,t)),s.strs.push(a),Ye(t.wbrels,-1,"sharedStrings."+r,He.SST)),a="xl/workbook."+r,Le(i,a,_h(e)),s.workbooks.push(a),Ye(t.rels,1,a,He.WB),a="xl/theme/theme1.xml",Le(i,a,nh(e.Themes,t)),s.themes.push(a),Ye(t.wbrels,-1,"theme/theme1.xml",He.THEME),a="xl/styles."+r,Le(i,a,th(e,t)),s.styles.push(a),Ye(t.wbrels,-1,"styles."+r,He.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Le(i,a,e.vbaraw),s.vba.push(a),Ye(t.wbrels,-1,"vbaProject.bin",He.VBA)),a="xl/metadata."+r,Le(i,a,sh()),s.metadata.push(a),Ye(t.wbrels,-1,"metadata."+r,He.XLMETA),u.length>1&&(a="xl/persons/person.xml",Le(i,a,rw(u)),s.people.push(a),Ye(t.wbrels,-1,"persons/person.xml",He.PEOPLE)),Le(i,"[Content_Types].xml",Bf(s,t)),Le(i,"_rels/.rels",ps(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",ps(t.wbrels)),delete t.revssf,delete t.ssf,i}function ST(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ah(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Si(t.file,tt.write(e,{type:Ve?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tt.write(e,t)}function AT(e,t){var r=Zt(t||{}),n=ET(e,r);return kT(n,r)}function kT(e,t){var r={},n=Ve?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?tt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Va(s))}return t.password&&typeof encrypt_agile<"u"?Ah(encrypt_agile(s,t.password),t):t.type==="file"?Si(t.file,s):t.type=="string"?Xs(s):s}function CT(e,t){var r=t||{},n=VE(e,r);return Ah(n,r)}function Ir(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return di(gi(n));case"binary":return gi(n);case"string":return e;case"file":return Si(t.file,n,"utf8");case"buffer":return Ve?tn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ir(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function OT(e,t){switch(t.type){case"base64":return di(e);case"binary":return e;case"string":return e;case"file":return Si(t.file,e,"binary");case"buffer":return Ve?tn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xi(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?di(r):t.type=="string"?Xs(r):r;case"file":return Si(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function kh(e,t){nm(),pE(e);var r=Zt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kh(e,r);return r.type="array",Va(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ir(WE(e,r),r);case"slk":case"sylk":return Ir(f_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ir(Eh(e.Sheets[e.SheetNames[s]],r),r);case"txt":return OT(Ch(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ir(Ml(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ir(h_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Xi(u_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ir(d_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ir(w_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ir(Jf.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ir(Sh(e,r),r);case"wk1":return Xi(_u.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Xi(_u.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Xi(yh(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),CT(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return AT(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function RT(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function IT(e,t,r){var n={};return n.type="file",n.file=t,RT(n),kh(e,n)}function FT(e,t,r,n,s,i,a,o){var l=Dt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=a?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[d]!=null&&(p[i[d]]=c);continue}var h=v.v;switch(v.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[d]!=null){if(h==null)if(v.t=="e"&&h===null)p[i[d]]=null;else if(c!==void 0)p[i[d]]=c;else if(u&&h===null)p[i[d]]=null;else continue;else p[i[d]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?h:Qr(v,h,o);h!=null&&(f=!1)}}return{row:p,isempty:f}}function ka(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=at(u);break;case"number":l=at(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var f=Dt(l.s.r),p=[],d=[],v=0,h=0,g=Array.isArray(e),w=l.s.r,E=0,_={};g&&!e[w]&&(e[w]=[]);var O=c.skipHidden&&e["!cols"]||[],B=c.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(O[E]||{}).hidden)switch(p[E]=$t(E),r=g?e[w][E]:e[p[E]+f],n){case 1:i[E]=E-l.s.c;break;case 2:i[E]=p[E];break;case 3:i[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Qr(r,null,c),h=_[a]||0,!h)_[a]=1;else{do o=a+"_"+h++;while(_[o]);_[a]=h,_[o]=1}i[E]=o}for(w=l.s.r+s;w<=l.e.r;++w)if(!(B[w]||{}).hidden){var N=FT(e,l,w,p,n,i,g,c);(N.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[v++]=N.row)}return d.length=v,d}var ku=/"/g;function DT(e,t,r,n,s,i,a,o){for(var l=!0,c=[],u="",f=Dt(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var d=o.dense?(e[r]||[])[p]:e[n[p]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Qr(d,null,o));for(var v=0,h=0;v!==u.length;++v)if((h=u.charCodeAt(v))===s||h===i||h===34||o.forceQuotes){u='"'+u.replace(ku,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(ku,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Ml(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=at(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(p[v]||{}).hidden||(f[v]=$t(v));for(var h=0,g=s.s.r;g<=s.e.r;++g)(d[g]||{}).hidden||(u=DT(e,s,g,f,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((h++?o:"")+u)));return delete n.dense,r.join("")}function Ch(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ml(e,t);return r}function PT(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=at(e["!ref"]),i="",a=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)a[o]=$t(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Dt(u),o=s.s.c;o<=s.e.c;++o)if(t=a[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Oh(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+s}};if(i["!ref"]){var f=at(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+s)}else a==-1&&(a=0,u.e.r=t.length-1+s);var p=n.header||[],d=0;t.forEach(function(h,g){Pt(h).forEach(function(w){(d=p.indexOf(w))==-1&&(p[d=p.length]=w);var E=h[w],_="z",O="",B=Ze({c:o+d,r:a+g+s});c=xi(i,B),E&&typeof E=="object"&&!(E instanceof Date)?i[B]=E:(typeof E=="number"?_="n":typeof E=="boolean"?_="b":typeof E=="string"?_="s":E instanceof Date?(_="d",n.cellDates||(_="n",E=Qt(E)),O=n.dateNF||ht[14]):E===null&&n.nullError&&(_="e",E=0),c?(c.t=_,c.v=E,delete c.w,delete c.R,O&&(c.z=O)):i[B]=c={t:_,v:E},O&&(c.z=O))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var v=Dt(a);if(s)for(d=0;d<p.length;++d)i[$t(d+o)+v]={t:"s",v:p[d]};return i["!ref"]=vt(u),i}function NT(e,t){return Oh(null,e,t)}function xi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?xi(e,Ze(t)):xi(e,Ze({r:t,c:r||0}))}function LT(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function BT(){return{SheetNames:[],Sheets:{}}}function MT(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(xh(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function UT(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=LT(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function $T(e,t){return e.z=t,e}function Rh(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function jT(e,t,r){return Rh(e,"#"+t,r)}function WT(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function HT(e,t,r,n){for(var s=typeof t!="string"?t:at(t),i=typeof t=="string"?t:vt(t),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=xi(e,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Sn={encode_col:$t,encode_row:Dt,encode_cell:Ze,encode_range:vt,decode_col:kl,decode_row:Al,split_cell:nx,decode_cell:Tt,decode_range:fr,format_cell:Qr,sheet_add_aoa:Rf,sheet_add_json:Oh,sheet_add_dom:Th,aoa_to_sheet:Es,json_to_sheet:NT,table_to_sheet:bh,table_to_book:hT,sheet_to_csv:Ml,sheet_to_txt:Ch,sheet_to_json:ka,sheet_to_html:Eh,sheet_to_formulae:PT,sheet_to_row_object_array:ka,sheet_get_cell:xi,book_new:BT,book_append_sheet:MT,book_set_sheet_visibility:UT,cell_set_number_format:$T,cell_set_hyperlink:Rh,cell_set_internal_link:jT,cell_add_comment:WT,sheet_set_array_formula:HT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const VT={class:"space-y-6"},KT={class:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex flex-wrap gap-4 items-end"},GT={class:"space-y-1"},qT=["value"],zT={class:"space-y-1"},XT=["value"],JT={class:"space-y-1"},YT=["value"],QT={class:"space-y-1"},ZT=["disabled"],eb=["value"],tb={class:"ml-auto flex items-center gap-4"},rb={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},nb={class:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white shadow-lg relative overflow-hidden"},sb={class:"relative z-10"},ib={class:"mt-2 flex items-baseline"},ab={class:"text-3xl font-bold"},ob={class:"mt-2 text-xs text-blue-100 opacity-70"},lb={class:"bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl p-6 text-white shadow-lg relative overflow-hidden"},cb={class:"relative z-10"},ub={class:"mt-2 flex items-baseline"},fb={class:"text-3xl font-bold"},hb={class:"mt-2 text-xs text-purple-100 opacity-70"},db={class:"bg-gradient-to-br from-orange-400 to-red-500 rounded-2xl p-6 text-white shadow-lg relative overflow-hidden"},pb={key:0,class:"absolute inset-0 bg-black/10 z-0"},gb={class:"relative z-10"},vb={class:"mt-2 flex items-baseline"},mb={class:"text-3xl font-bold"},xb={class:"mt-2 text-xs text-orange-100 opacity-70"},_b={key:0,class:"block mt-1 text-[10px] bg-black/20 w-fit px-1 rounded"},wb={__name:"Dashboard",props:{records:{type:Array,default:()=>[]},districts:{type:Array,default:()=>[]},sites:{type:Array,default:()=>[]},processedBatches:{type:Array,default:()=>[]},dispatches:{type:Array,default:()=>[]}},setup(e){const t=e,r=Be(new Date().getFullYear()),n=Be(""),s=Be(""),i=Be(""),a=yt(()=>{const h=new Set([new Date().getFullYear()]);return t.records.forEach(g=>h.add(new Date(g.date).getFullYear())),Array.from(h).sort((g,w)=>w-g)}),o=yt(()=>s.value?t.sites.filter(h=>h.districtId===s.value):[]),l=h=>{if(!h)return!1;const g=new Date(h),w=g.getFullYear()===r.value,E=n.value===""||g.getMonth()===n.value;return w&&E},c=yt(()=>t.records.filter(h=>!(!l(h.date)||s.value&&t.sites.find(g=>g.id===h.siteId)?.districtId!==s.value||s.value&&h.districtId&&h.districtId!==s.value||i.value&&h.siteId!==i.value))),u=yt(()=>t.processedBatches.filter(h=>{if(!l(h.processingDate))return!1;if(!s.value&&!i.value)return!0;const g=t.records.filter(w=>h.sourceCollectionIds.includes(w.id));return!(s.value&&!g.some(E=>E.districtId===s.value)||i.value&&!g.some(E=>E.siteId===i.value))})),f=yt(()=>t.dispatches.filter(h=>!!l(h.dispatchDate))),p=yt(()=>{const h=c.value.reduce((E,_)=>E+Number(_.quantity||0),0),g=u.value.reduce((E,_)=>E+Number(_.outputQuantity||0),0),w=f.value.reduce((E,_)=>E+Number(_.totalWeight||0),0);return{collected:h.toFixed(2),processed:g.toFixed(2),dispatched:w.toFixed(2)}}),d=["January","February","March","April","May","June","July","August","September","October","November","December"],v=()=>{const h=c.value.map(k=>({ID:k.id,Date:new Date(k.date).toLocaleDateString(),District:k.districtName,Site:k.siteName,"Bag Number":k.bagNumber,"Quantity (kg)":k.quantity,Status:k.status,"Container ID":k.containerId||"-","Batch ID":k.batch_id||"-"})),g=u.value.map(k=>({ID:k.id,"Processing Date":new Date(k.processingDate).toLocaleDateString(),"Container ID":k.containerId,"Output Quantity (kg)":k.outputQuantity,Status:k.status,"Dispatch ID":k.dispatch_id||"-"})),w=f.value.map(k=>({ID:k.id,"Dispatch Date":new Date(k.dispatchDate).toLocaleDateString(),"Vehicle Number":k.vehicleNumber,"Loads Count":k.processedBatchIds?.length||0})),E=Sn.book_new(),_=Sn.json_to_sheet(h);Sn.book_append_sheet(E,_,"Collections");const O=Sn.json_to_sheet(g);Sn.book_append_sheet(E,O,"Processed Batches");const B=Sn.json_to_sheet(w);Sn.book_append_sheet(E,B,"Dispatches");const N=new Date().toISOString().split("T")[0];IT(E,`PCS_Report_${N}.xlsx`)};return(h,g)=>(oe(),ce("div",VT,[x("div",KT,[x("div",GT,[g[6]||(g[6]=x("label",{class:"text-xs font-bold text-slate-500 uppercase"},"Year",-1)),Ke(x("select",{"onUpdate:modelValue":g[0]||(g[0]=w=>r.value=w),class:"block w-32 px-3 py-2 rounded-lg border border-slate-200 text-sm focus:ring-2 focus:ring-blue-100 outline-none"},[(oe(!0),ce(We,null,ct(a.value,w=>(oe(),ce("option",{key:w,value:w},be(w),9,qT))),128))],512),[[br,r.value]])]),x("div",zT,[g[8]||(g[8]=x("label",{class:"text-xs font-bold text-slate-500 uppercase"},"Month",-1)),Ke(x("select",{"onUpdate:modelValue":g[1]||(g[1]=w=>n.value=w),class:"block w-40 px-3 py-2 rounded-lg border border-slate-200 text-sm focus:ring-2 focus:ring-blue-100 outline-none"},[g[7]||(g[7]=x("option",{value:""},"All Months",-1)),(oe(),ce(We,null,ct(d,(w,E)=>x("option",{key:E,value:E},be(w),9,XT)),64))],512),[[br,n.value]])]),x("div",JT,[g[10]||(g[10]=x("label",{class:"text-xs font-bold text-slate-500 uppercase"},"District",-1)),Ke(x("select",{"onUpdate:modelValue":g[2]||(g[2]=w=>s.value=w),class:"block w-40 px-3 py-2 rounded-lg border border-slate-200 text-sm focus:ring-2 focus:ring-blue-100 outline-none",onChange:g[3]||(g[3]=w=>i.value="")},[g[9]||(g[9]=x("option",{value:""},"All Districts",-1)),(oe(!0),ce(We,null,ct(e.districts,w=>(oe(),ce("option",{key:w.id,value:w.id},be(w.name),9,YT))),128))],544),[[br,s.value]])]),x("div",QT,[g[12]||(g[12]=x("label",{class:"text-xs font-bold text-slate-500 uppercase"},"Site",-1)),Ke(x("select",{"onUpdate:modelValue":g[4]||(g[4]=w=>i.value=w),class:"block w-48 px-3 py-2 rounded-lg border border-slate-200 text-sm focus:ring-2 focus:ring-blue-100 outline-none disabled:bg-slate-50",disabled:!s.value},[g[11]||(g[11]=x("option",{value:""},"All Sites",-1)),(oe(!0),ce(We,null,ct(o.value,w=>(oe(),ce("option",{key:w.id,value:w.id},be(w.name),9,eb))),128))],8,ZT),[[br,i.value]])]),x("div",tb,[x("button",{onClick:v,class:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm"},[...g[13]||(g[13]=[x("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),ur(" Download Report ",-1)])]),x("button",{onClick:g[5]||(g[5]=w=>{s.value="",i.value="",n.value=""}),class:"text-sm text-slate-500 hover:text-blue-600 underline"}," Reset Filters ")])]),x("div",rb,[x("div",nb,[x("div",sb,[g[15]||(g[15]=x("p",{class:"text-blue-100 text-sm font-medium uppercase tracking-wider"},"Collected",-1)),x("div",ib,[x("span",ab,be(p.value.collected),1),g[14]||(g[14]=x("span",{class:"ml-2 text-lg opacity-80"},"kg",-1))]),x("div",ob," From "+be(c.value.length)+" collections ",1)])]),x("div",lb,[x("div",cb,[g[17]||(g[17]=x("p",{class:"text-purple-100 text-sm font-medium uppercase tracking-wider"},"Processed & Stored",-1)),x("div",ub,[x("span",fb,be(p.value.processed),1),g[16]||(g[16]=x("span",{class:"ml-2 text-lg opacity-80"},"kg",-1))]),x("div",hb,be(u.value.length)+" batches stored ",1)])]),x("div",db,[s.value||i.value?(oe(),ce("div",pb)):dt("",!0),x("div",gb,[g[19]||(g[19]=x("p",{class:"text-orange-100 text-sm font-medium uppercase tracking-wider"},"Dispatched",-1)),x("div",vb,[x("span",mb,be(p.value.dispatched),1),g[18]||(g[18]=x("span",{class:"ml-2 text-lg opacity-80"},"kg",-1))]),x("div",xb,[ur(be(f.value.length)+" loads sent ",1),s.value?(oe(),ce("span",_b,"Global stat (not district filtered)")):dt("",!0)])])])])]))}},yb={class:"space-y-6"},Eb={class:"space-y-2"},Tb={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},bb={class:"space-y-2"},Sb=["value"],Ab={class:"space-y-2"},kb=["disabled"],Cb=["value"],Ob={class:"space-y-2"},Rb=["disabled"],Ib=["value"],Fb={class:"space-y-2"},Db={class:"space-y-2"},Pb={class:"space-y-2"},Nb={key:0,class:"text-amber-600 text-sm bg-amber-50 p-3 rounded-lg"},Lb=["disabled"],Bb={__name:"NurdleForm",props:{districts:{type:Array,required:!0},sites:{type:Array,required:!0},containers:{type:Array,required:!0},initialData:{type:Object,default:null}},emits:["submit"],setup(e,{emit:t}){const r=e,n=t,s=Be({date:new Date().toISOString().split("T")[0],districtId:"",siteId:"",containerId:"",quantity:"",bagNumber:"",notes:""});r.initialData&&(s.value={...r.initialData});const i=yt(()=>s.value.districtId?r.sites.filter(l=>l.districtId===s.value.districtId):[]),a=yt(()=>s.value.districtId?r.containers.filter(l=>l.districtId===s.value.districtId):[]),o=()=>{const l=r.districts.find(u=>u.id===s.value.districtId),c=r.sites.find(u=>u.id===s.value.siteId);n("submit",{id:r.initialData?r.initialData.id:Date.now(),...s.value,districtName:l?.name,siteName:c?.name,status:r.initialData?r.initialData.status:"collected"}),r.initialData||(s.value={date:new Date().toISOString().split("T")[0],districtId:s.value.districtId,siteId:s.value.siteId,containerId:"",quantity:"",bagNumber:"",notes:""})};return(l,c)=>(oe(),ce("form",{onSubmit:Ei(o,["prevent"]),class:"bg-white rounded-2xl shadow-xl p-8 border border-slate-100 max-w-2xl mx-auto"},[x("div",yb,[x("div",Eb,[c[8]||(c[8]=x("label",{class:"text-sm font-medium text-slate-700"},"Date Collected",-1)),Ke(x("input",{"onUpdate:modelValue":c[0]||(c[0]=u=>s.value.date=u),type:"date",required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none"},null,512),[[zt,s.value.date]])]),x("div",Tb,[x("div",bb,[c[10]||(c[10]=x("label",{class:"text-sm font-medium text-slate-700"},"District",-1)),Ke(x("select",{"onUpdate:modelValue":c[1]||(c[1]=u=>s.value.districtId=u),required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none bg-white",onChange:c[2]||(c[2]=u=>{s.value.siteId="",s.value.containerId=""})},[c[9]||(c[9]=x("option",{value:"",disabled:""},"Select District",-1)),(oe(!0),ce(We,null,ct(e.districts,u=>(oe(),ce("option",{key:u.id,value:u.id},be(u.name),9,Sb))),128))],544),[[br,s.value.districtId]])]),x("div",Ab,[c[12]||(c[12]=x("label",{class:"text-sm font-medium text-slate-700"},"Site",-1)),Ke(x("select",{"onUpdate:modelValue":c[3]||(c[3]=u=>s.value.siteId=u),required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none bg-white",disabled:!s.value.districtId},[c[11]||(c[11]=x("option",{value:"",disabled:""},"Select Site",-1)),(oe(!0),ce(We,null,ct(i.value,u=>(oe(),ce("option",{key:u.id,value:u.id},be(u.name),9,Cb))),128))],8,kb),[[br,s.value.siteId]])])]),x("div",Ob,[c[14]||(c[14]=x("label",{class:"text-sm font-medium text-slate-700"},"Container",-1)),Ke(x("select",{"onUpdate:modelValue":c[4]||(c[4]=u=>s.value.containerId=u),required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none bg-white",disabled:!s.value.districtId},[c[13]||(c[13]=x("option",{value:"",disabled:""},"Select Container",-1)),(oe(!0),ce(We,null,ct(a.value,u=>(oe(),ce("option",{key:u.id,value:u.id},be(u.label),9,Ib))),128))],8,Rb),[[br,s.value.containerId]])]),x("div",Fb,[c[15]||(c[15]=x("label",{class:"text-sm font-medium text-slate-700"},"Quantity Collected (kg)",-1)),Ke(x("input",{"onUpdate:modelValue":c[5]||(c[5]=u=>s.value.quantity=u),type:"number",step:"0.01",placeholder:"0.00",required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none font-mono text-lg"},null,512),[[zt,s.value.quantity]])]),x("div",Db,[c[16]||(c[16]=x("label",{class:"text-sm font-medium text-slate-700"},"Bag Number",-1)),Ke(x("input",{"onUpdate:modelValue":c[6]||(c[6]=u=>s.value.bagNumber=u),type:"text",placeholder:"e.g. B-001",required:"",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none font-mono"},null,512),[[zt,s.value.bagNumber]])]),x("div",Pb,[c[17]||(c[17]=x("label",{class:"text-sm font-medium text-slate-700"},"Notes (Optional)",-1)),Ke(x("textarea",{"onUpdate:modelValue":c[7]||(c[7]=u=>s.value.notes=u),rows:"3",placeholder:"Any observations...",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all outline-none resize-none"},null,512),[[zt,s.value.notes]])]),e.districts.length===0?(oe(),ce("div",Nb,"  Please add Districts and Sites in the Config tab before recording collections. ")):dt("",!0),x("button",{type:"submit",class:"w-full py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold rounded-xl shadow-lg hover:shadow-blue-500/30 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.districts.length===0}," Save Record ",8,Lb)])],32))}},Mb={class:"space-y-6"},Ub={key:0,class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},$b={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},jb={class:"bg-blue-50/50 border border-blue-100 p-4 rounded-xl flex items-center gap-4"},Wb={class:"text-2xl font-bold text-slate-800"},Hb={key:2,class:"animate-fade-in"},Vb={class:"flex items-center mb-6"},Kb={class:"text-2xl font-bold text-slate-800"},Gb={key:3,class:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden animate-fade-in"},qb={class:"p-4 border-b border-slate-100 flex flex-col sm:flex-row gap-4 bg-white"},zb={class:"w-full sm:max-w-xs relative text-slate-500"},Xb=["value"],Jb={key:0,class:"p-12 text-center text-slate-400"},Yb={key:1,class:"overflow-x-auto"},Qb={class:"w-full text-left border-collapse"},Zb={class:"divide-y divide-slate-50"},eS={class:"px-6 py-4 align-middle"},tS={class:"font-bold text-slate-700 text-sm"},rS={class:"text-[11px] text-slate-400 mt-0.5"},nS={class:"px-6 py-4 align-middle font-mono text-sm text-slate-600 font-bold bg-slate-50/50"},sS={class:"px-6 py-4 align-middle font-mono text-sm text-slate-500"},iS={class:"px-6 py-4 align-middle"},aS={class:"font-medium text-slate-700"},oS={class:"text-xs text-slate-500"},lS={class:"px-6 py-4 align-middle"},cS={class:"px-6 py-4 align-middle text-right"},uS={class:"font-bold text-slate-700"},fS={class:"px-6 py-4 align-middle text-center"},hS={class:"flex items-center justify-center gap-2"},dS=["onClick"],pS=["onClick"],gS={__name:"CollectionPanel",props:{records:{type:Array,required:!0},districts:{type:Array,required:!0},sites:{type:Array,required:!0},containers:{type:Array,required:!0}},emits:["add-record","delete-record","update-record"],setup(e,{emit:t}){const r=e,n=t,s=Be(!1),i=Be(null),a=Be(""),o=Be(""),l=yt(()=>r.records.filter(d=>{if(a.value){const v=a.value.toLowerCase();if(!(d.collectorName&&d.collectorName.toLowerCase().includes(v)||d.districtName&&d.districtName.toLowerCase().includes(v)||d.siteName&&d.siteName.toLowerCase().includes(v)||d.bagNumber&&d.bagNumber.toLowerCase().includes(v)||d.notes&&d.notes.toLowerCase().includes(v)))return!1}return!(o.value&&d.districtId!==o.value)}).sort((d,v)=>new Date(v.date)-new Date(d.date)||v.id-d.id)),c=d=>{i.value?n("update-record",d):n("add-record",d),p()},u=d=>{i.value=d,s.value=!0},f=d=>{confirm("Delete this record?")&&n("delete-record",d)},p=()=>{s.value=!1,i.value=null};return(d,v)=>(oe(),ce("div",Mb,[s.value?dt("",!0):(oe(),ce("div",Ub,[v[4]||(v[4]=x("div",null,[x("h2",{class:"text-2xl font-bold text-slate-800"},"Collected Entries"),x("p",{class:"text-slate-500 text-sm"},"Manage incoming nurdle collections from sites.")],-1)),x("button",{onClick:v[0]||(v[0]=h=>s.value=!0),class:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl shadow-lg shadow-blue-500/30 transition-all flex items-center gap-2"},[...v[3]||(v[3]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),ur(" Add New Entry ",-1)])])])),s.value?dt("",!0):(oe(),ce("div",$b,[x("div",jb,[v[6]||(v[6]=x("div",{class:"p-3 bg-blue-100 text-blue-600 rounded-lg"},[x("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),x("div",null,[x("div",Wb,be(e.records.length),1),v[5]||(v[5]=x("div",{class:"text-xs font-medium text-slate-500 uppercase tracking-wide"},"Total Entries",-1))])])])),s.value?(oe(),ce("div",Hb,[x("div",Vb,[x("button",{onClick:p,class:"mr-4 p-2 hover:bg-slate-100 rounded-full text-slate-500 transition-colors"},[...v[7]||(v[7]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),x("h2",Kb,be(i.value?"Edit Collection Record":"Add Collection Record"),1)]),Rt(Bb,{districts:e.districts,sites:e.sites,containers:e.containers,"initial-data":i.value,onSubmit:c},null,8,["districts","sites","containers","initial-data"])])):(oe(),ce("div",Gb,[x("div",qb,[x("div",zb,[v[8]||(v[8]=x("svg",{class:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),Ke(x("input",{"onUpdate:modelValue":v[1]||(v[1]=h=>a.value=h),type:"text",placeholder:"Search site, district, bag #...",class:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-100 focus:border-blue-300 outline-none transition-all"},null,512),[[zt,a.value]])]),Ke(x("select",{"onUpdate:modelValue":v[2]||(v[2]=h=>o.value=h),class:"px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-100 outline-none w-full sm:w-auto"},[v[9]||(v[9]=x("option",{value:""},"All Districts",-1)),(oe(!0),ce(We,null,ct(e.districts,h=>(oe(),ce("option",{key:h.id,value:h.id},be(h.name),9,Xb))),128))],512),[[br,o.value]])]),l.value.length===0?(oe(),ce("div",Jb," No records found. ")):(oe(),ce("div",Yb,[x("table",Qb,[v[13]||(v[13]=x("thead",null,[x("tr",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100"},[x("th",{class:"px-6 py-4 bg-white"},"Registration Info"),x("th",{class:"px-6 py-4 bg-white"},"Bag #"),x("th",{class:"px-6 py-4 bg-white"},"Container"),x("th",{class:"px-6 py-4 bg-white"},"Site / District"),x("th",{class:"px-6 py-4 bg-white"},"Status"),x("th",{class:"px-6 py-4 bg-white text-right"},"Quantity"),x("th",{class:"px-6 py-4 bg-white text-center"},"Actions")])],-1)),x("tbody",Zb,[(oe(!0),ce(We,null,ct(l.value,h=>(oe(),ce("tr",{key:h.id,class:"hover:bg-slate-50/80 transition-colors group"},[x("td",eS,[x("div",tS,be(h.date),1),x("div",rS,"#"+be(h.id.toString().slice(-6)),1)]),x("td",nS,be(h.bagNumber||"-"),1),x("td",sS,be(h.containerId||"-"),1),x("td",iS,[x("div",aS,be(h.siteName),1),x("div",oS,be(h.districtName),1)]),x("td",lS,[x("span",{class:qr(["inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium",h.status==="collected"?"bg-blue-100 text-blue-700":h.status==="processed"?"bg-purple-100 text-purple-700":"bg-slate-100 text-slate-600"])},be(h.status||"Collected"),3)]),x("td",cS,[x("span",uS,be(h.quantity),1),v[10]||(v[10]=x("span",{class:"text-slate-400 text-xs ml-1"},"kg",-1))]),x("td",fS,[x("div",hS,[x("button",{onClick:g=>u(h),class:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors",title:"Edit Record"},[...v[11]||(v[11]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,dS),x("button",{onClick:Ei(g=>f(h.id),["stop"]),class:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Delete Record"},[...v[12]||(v[12]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,pS)])])]))),128))])])]))]))]))}},vS={class:"space-y-8"},mS={class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},xS={class:"flex gap-4 mb-6"},_S={class:"space-y-3"},wS={key:0,class:"text-slate-400 italic text-center py-4"},yS={class:"font-medium text-slate-700"},ES=["onClick"],TS={class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},bS={class:"flex flex-col md:flex-row gap-4 mb-6"},SS=["value"],AS=["disabled"],kS={class:"space-y-6"},CS={key:0,class:"text-slate-400 italic text-center py-4"},OS={class:"bg-slate-50 px-4 py-3 border-b border-slate-200 font-medium text-slate-700"},RS={class:"p-4 space-y-2"},IS={key:0,class:"text-slate-400 text-sm italic"},FS={class:"text-slate-600"},DS=["onClick"],PS={class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},NS={class:"flex flex-col md:flex-row gap-4 mb-6"},LS={class:"w-full md:w-1/3"},BS=["value"],MS={class:"w-full md:w-1/3"},US={class:"w-full md:w-1/3 flex items-end"},$S=["disabled"],jS={class:"space-y-6"},WS={key:0,class:"text-slate-400 italic text-center py-4"},HS={class:"bg-slate-50 px-4 py-3 border-b border-slate-200 font-medium text-slate-700 flex justify-between items-center"},VS={class:"text-xs text-slate-500 font-normal"},KS={class:"p-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3"},GS={key:0,class:"col-span-full text-slate-400 text-sm italic"},qS=["title"],zS={class:"font-mono text-sm font-bold text-slate-700 truncate w-full pr-6"},XS=["onClick"],JS={key:1,class:"border border-slate-200 rounded-xl overflow-hidden mt-4"},YS={class:"p-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"},QS={class:"font-mono text-sm font-bold text-slate-700"},ZS=["onClick"],e4={__name:"ConfigPanel",props:{districts:{type:Array,required:!0},sites:{type:Array,required:!0},containers:{type:Array,required:!0}},emits:["add-district","delete-district","add-site","delete-site","add-container","delete-container"],setup(e,{emit:t}){const r=e,n=t,s=Be(""),i=Be(""),a=Be(""),o=Be(""),l=Be(""),c=()=>{s.value.trim()&&(n("add-district",{id:Date.now(),name:s.value.trim()}),s.value="")},u=()=>{!i.value.trim()||!a.value||(n("add-site",{id:Date.now(),districtId:a.value,name:i.value.trim()}),i.value="")},f=()=>{!o.value.trim()||!l.value||(n("add-container",{id:o.value.trim(),id:o.value.trim(),label:o.value.trim(),districtId:l.value}),o.value="")},p=v=>r.sites.filter(h=>h.districtId===v),d=v=>r.containers.filter(h=>h.districtId===v);return(v,h)=>(oe(),ce("div",vS,[x("div",mS,[h[5]||(h[5]=x("h2",{class:"text-xl font-bold text-slate-800 mb-4"},"Manage Districts",-1)),x("div",xS,[Ke(x("input",{"onUpdate:modelValue":h[0]||(h[0]=g=>s.value=g),type:"text",placeholder:"New District Name",class:"flex-1 px-4 py-2 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",onKeyup:uo(c,["enter"])},null,544),[[zt,s.value]]),x("button",{onClick:c,class:"px-6 py-2 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 transition-colors"}," Add District ")]),x("div",_S,[e.districts.length===0?(oe(),ce("div",wS," No districts added yet. ")):dt("",!0),(oe(!0),ce(We,null,ct(e.districts,g=>(oe(),ce("div",{key:g.id,class:"flex items-center justify-between p-4 bg-slate-50 rounded-xl"},[x("span",yS,be(g.name),1),x("button",{onClick:w=>v.$emit("delete-district",g.id),class:"text-red-500 hover:text-red-700 text-sm font-medium"}," Delete ",8,ES)]))),128))])]),x("div",TS,[h[7]||(h[7]=x("h2",{class:"text-xl font-bold text-slate-800 mb-4"},"Manage Sites",-1)),x("div",bS,[Ke(x("select",{"onUpdate:modelValue":h[1]||(h[1]=g=>a.value=g),class:"px-4 py-2 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none bg-white"},[h[6]||(h[6]=x("option",{value:"",disabled:""},"Select District",-1)),(oe(!0),ce(We,null,ct(e.districts,g=>(oe(),ce("option",{key:g.id,value:g.id},be(g.name),9,SS))),128))],512),[[br,a.value]]),Ke(x("input",{"onUpdate:modelValue":h[2]||(h[2]=g=>i.value=g),type:"text",placeholder:"New Site Name",class:"flex-1 px-4 py-2 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",onKeyup:uo(u,["enter"])},null,544),[[zt,i.value]]),x("button",{onClick:u,class:"px-6 py-2 bg-indigo-600 text-white font-medium rounded-xl hover:bg-indigo-700 transition-colors",disabled:!a.value}," Add Site ",8,AS)]),x("div",kS,[e.districts.length===0?(oe(),ce("div",CS," Add districts first to manage sites. ")):dt("",!0),(oe(!0),ce(We,null,ct(e.districts,g=>(oe(),ce("div",{key:g.id,class:"border border-slate-200 rounded-xl overflow-hidden active"},[x("div",OS,be(g.name),1),x("div",RS,[p(g.id).length===0?(oe(),ce("div",IS," No sites in this district. ")):dt("",!0),(oe(!0),ce(We,null,ct(p(g.id),w=>(oe(),ce("div",{key:w.id,class:"flex items-center justify-between py-2 px-3 hover:bg-slate-50 rounded-lg transition-colors"},[x("span",FS,be(w.name),1),x("button",{onClick:E=>v.$emit("delete-site",w.id),class:"text-red-500 hover:text-red-700 text-xs font-medium"}," Remove ",8,DS)]))),128))])]))),128))])]),x("div",PS,[h[14]||(h[14]=x("h2",{class:"text-xl font-bold text-slate-800 mb-4"},"Manage Containers",-1)),x("div",NS,[x("div",LS,[h[9]||(h[9]=x("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"District",-1)),Ke(x("select",{"onUpdate:modelValue":h[3]||(h[3]=g=>l.value=g),class:"w-full px-4 py-2 rounded-xl border border-slate-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none bg-white"},[h[8]||(h[8]=x("option",{value:"",disabled:""},"Select District",-1)),(oe(!0),ce(We,null,ct(e.districts,g=>(oe(),ce("option",{key:g.id,value:g.id},be(g.name),9,BS))),128))],512),[[br,l.value]])]),x("div",MS,[h[10]||(h[10]=x("label",{class:"block text-xs font-bold text-slate-500 uppercase mb-1"},"Container ID / Label",-1)),Ke(x("input",{"onUpdate:modelValue":h[4]||(h[4]=g=>o.value=g),type:"text",placeholder:"e.g. PUT-01",class:"w-full px-4 py-2 rounded-xl border border-slate-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none",onKeyup:uo(f,["enter"])},null,544),[[zt,o.value]])]),x("div",US,[x("button",{onClick:f,class:"w-full px-6 py-2 bg-purple-600 text-white font-medium rounded-xl hover:bg-purple-700 transition-colors",disabled:!l.value||!o.value}," Add Container ",8,$S)])]),x("div",jS,[e.districts.length===0?(oe(),ce("div",WS," Add districts first to manage containers. ")):dt("",!0),(oe(!0),ce(We,null,ct(e.districts,g=>(oe(),ce("div",{key:g.id,class:"border border-slate-200 rounded-xl overflow-hidden"},[x("div",HS,[x("span",null,be(g.name),1),x("span",VS,be(d(g.id).length)+" containers",1)]),x("div",KS,[d(g.id).length===0?(oe(),ce("div",GS," No containers assigned. ")):dt("",!0),(oe(!0),ce(We,null,ct(d(g.id),w=>(oe(),ce("div",{key:w.id,class:"group relative flex items-center justify-between p-2 bg-slate-50 border border-slate-100 rounded-lg hover:border-purple-200 hover:bg-purple-50 transition-colors",title:w.label},[x("div",zS,be(w.label),1),x("button",{onClick:E=>v.$emit("delete-container",w.id),class:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",title:"Remove"},[...h[11]||(h[11]=[x("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,XS)],8,qS))),128))])]))),128)),d(void 0).length>0?(oe(),ce("div",JS,[h[13]||(h[13]=x("div",{class:"bg-yellow-50 px-4 py-3 border-b border-yellow-200 font-medium text-yellow-800"}," Unassigned Containers (Legacy) ",-1)),x("div",YS,[(oe(!0),ce(We,null,ct(d(void 0),g=>(oe(),ce("div",{key:g.id,class:"group relative flex items-center justify-between p-2 bg-slate-50 border border-slate-100 rounded-lg"},[x("div",QS,be(g.label),1),x("button",{onClick:w=>v.$emit("delete-container",g.id),class:"text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100"},[...h[12]||(h[12]=[x("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ZS)]))),128))])])):dt("",!0)])])]))}},t4={class:"space-y-8"},r4={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},n4={class:"mb-3"},s4={key:0,class:"text-slate-400 italic text-sm p-4 bg-slate-50 rounded-xl"},i4={key:1,class:"space-y-2 max-h-[400px] overflow-y-auto pr-2"},a4=["onClick"],o4={class:"flex justify-between items-start"},l4={class:"font-medium text-slate-800"},c4={class:"text-xs text-slate-500"},u4={key:0,class:"mt-1 inline-block px-1.5 py-0.5 rounded text-xs font-bold bg-blue-50 text-blue-600 border border-blue-100 font-mono"},f4={class:"font-bold text-slate-700"},h4={class:"lg:pl-8 lg:border-l border-slate-100"},d4={class:"font-bold text-slate-700 mb-4"},p4={class:"p-4 bg-slate-50 rounded-xl mb-6"},g4={class:"text-2xl font-bold text-slate-800"},v4={key:0,class:"text-xs text-purple-600 mt-2 font-medium"},m4={class:"space-y-4"},x4={class:"space-y-2"},_4={key:0,class:"px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-400 text-sm italic"},w4={key:1,class:"px-4 py-3 rounded-xl border border-slate-200 bg-red-50 text-red-500 text-sm"},y4=["value"],E4={class:"space-y-2"},T4={class:"space-y-2"},b4={class:"flex gap-3 mt-4"},S4=["disabled"],A4={class:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden"},k4={class:"overflow-x-auto"},C4={class:"w-full text-left border-collapse"},O4={class:"divide-y divide-slate-50"},R4={key:0},I4={class:"px-6 py-5 align-middle text-slate-600"},F4={class:"px-6 py-5 align-middle font-bold text-slate-800"},D4={class:"px-6 py-5 align-middle text-right text-slate-500"},P4={class:"px-6 py-5 align-middle text-right font-bold text-purple-600"},N4={class:"px-6 py-5 align-middle text-center"},L4={class:"px-2.5 py-1 text-xs font-medium rounded-full bg-green-100 text-green-700 uppercase tracking-wide"},B4={class:"px-6 py-5 align-middle text-center"},M4={class:"flex items-center justify-center gap-2"},U4=["onClick","disabled"],$4=["onClick","disabled"],j4={__name:"ProcessingPanel",props:{records:{type:Array,required:!0},processedBatches:{type:Array,required:!0},containers:{type:Array,required:!0}},emits:["create-batch","delete-batch","update-batch"],setup(e,{emit:t}){const r=e,n=t,s=yt(()=>{const B=new Set;return r.processedBatches.forEach(N=>{N.sourceCollectionIds.forEach(k=>B.add(k))}),r.records.filter(N=>!B.has(N.id)&&N.status==="collected")}),i=Be(""),a=yt(()=>{if(!i.value)return s.value;const B=i.value.toLowerCase();return s.value.filter(N=>N.bagNumber?.toLowerCase().includes(B)||N.siteName?.toLowerCase().includes(B))}),o=Be([]),l=Be(""),c=Be(""),u=Be(new Date().toISOString().split("T")[0]),f=Be(null),p=yt(()=>f.value?r.records.filter(B=>f.value.sourceCollectionIds.includes(B.id)).reduce((B,N)=>B+Number(N.quantity),0).toFixed(2):r.records.filter(B=>o.value.includes(B.id)).reduce((B,N)=>B+Number(N.quantity),0).toFixed(2)),d=yt(()=>{const B=new Set(r.processedBatches.filter(P=>P.status==="stored"&&(!f.value||P.id!==f.value.id)).map(P=>P.containerId)),N=r.containers.filter(P=>!B.has(P.id));let k=[];if(f.value){const P=r.records.filter(q=>f.value.sourceCollectionIds.includes(q.id));k=[...new Set(P.map(q=>q.districtId).filter(Boolean))]}else{if(o.value.length===0)return[];const P=r.records.filter(q=>o.value.includes(q.id));k=[...new Set(P.map(q=>q.districtId).filter(Boolean))]}if(k.length===0)return N.filter(P=>!P.districtId);if(k.length>1)return[];const K=k[0];return N.filter(P=>P.districtId===K)}),v=B=>{f.value||(o.value.includes(B)?o.value=o.value.filter(N=>N!==B):o.value.push(B))},h=()=>{if(f.value)n("update-batch",{...f.value,containerId:l.value,outputQuantity:Number(c.value),processingDate:u.value}),E();else{if(o.value.length===0||!l.value||!c.value)return;n("create-batch",{id:Date.now(),sourceCollectionIds:[...o.value],processingDate:u.value,outputQuantity:Number(c.value),containerId:l.value,status:"stored"}),_()}},g=Be(null),w=B=>{f.value=B,l.value=B.containerId,c.value=B.outputQuantity,u.value=B.processingDate,o.value=[],g.value&&g.value.scrollIntoView({behavior:"smooth",block:"start"})},E=()=>{f.value=null,_()},_=()=>{o.value=[],l.value="",c.value="",u.value=new Date().toISOString().split("T")[0]},O=B=>{confirm('Delete this batch? This will revert items to "Collected".')&&n("delete-batch",B)};return(B,N)=>(oe(),ce("div",t4,[x("div",{ref_key:"formContainer",ref:g,class:"bg-white rounded-2xl shadow-xl p-8 border border-slate-100"},[N[12]||(N[12]=x("h2",{class:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-6"}," Processed & Stored ",-1)),x("div",r4,[x("div",null,[N[4]||(N[4]=x("h3",{class:"font-bold text-slate-700 mb-4"},"1. Select pending collections to process",-1)),x("div",n4,[Ke(x("input",{"onUpdate:modelValue":N[0]||(N[0]=k=>i.value=k),type:"text",placeholder:"Search bag #...",class:"w-full px-3 py-2 rounded-lg border border-slate-200 text-sm focus:ring-2 focus:ring-purple-100 outline-none"},null,512),[[zt,i.value]])]),a.value.length===0?(oe(),ce("div",s4," No pending collections found. ")):(oe(),ce("div",i4,[(oe(!0),ce(We,null,ct(a.value,k=>(oe(),ce("div",{key:k.id,onClick:K=>v(k.id),class:qr(["p-4 rounded-xl border cursor-pointer transition-all",o.value.includes(k.id)||f.value&&f.value.sourceCollectionIds.includes(k.id)?"border-purple-500 bg-purple-50 ring-1 ring-purple-200":"border-slate-200 hover:bg-slate-50 hover:border-slate-300",f.value&&!f.value.sourceCollectionIds.includes(k.id)?"opacity-50 cursor-not-allowed pointer-events-none":""])},[x("div",o4,[x("div",null,[x("div",l4,be(k.districtName)+" - "+be(k.siteName),1),x("div",c4,be(k.date),1),k.bagNumber?(oe(),ce("div",u4,be(k.bagNumber),1)):dt("",!0)]),x("div",f4,be(k.quantity)+" kg",1)])],10,a4))),128))]))]),x("div",h4,[x("h3",d4,be(f.value?"2. Edit Batch Details":"2. Enter Processing Details"),1),x("div",p4,[N[6]||(N[6]=x("div",{class:"text-sm text-slate-500 mb-1"},"Total Input Weight",-1)),x("div",g4,[ur(be(p.value)+" ",1),N[5]||(N[5]=x("span",{class:"text-sm text-slate-500 font-normal"},"kg",-1))]),o.value.length>0?(oe(),ce("div",v4,be(o.value.length)+" collections selected ",1)):dt("",!0)]),x("div",m4,[x("div",x4,[N[8]||(N[8]=x("label",{class:"text-sm font-medium text-slate-700"},"Storage Container ID",-1)),!f.value&&o.value.length===0?(oe(),ce("div",_4," Select collections first to see available containers. ")):d.value.length===0?(oe(),ce("div",w4," No available containers found for this district. ")):Ke((oe(),ce("select",{key:2,"onUpdate:modelValue":N[1]||(N[1]=k=>l.value=k),class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all outline-none bg-white"},[N[7]||(N[7]=x("option",{value:"",disabled:""},"Select Container",-1)),(oe(!0),ce(We,null,ct(d.value,k=>(oe(),ce("option",{key:k.id,value:k.id},be(k.label||k.id),9,y4))),128))],512)),[[br,l.value]])]),x("div",E4,[N[9]||(N[9]=x("label",{class:"text-sm font-medium text-slate-700"},"Final Output Weight (kg)",-1)),Ke(x("input",{"onUpdate:modelValue":N[2]||(N[2]=k=>c.value=k),type:"number",step:"0.01",placeholder:"0.00",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all outline-none font-mono"},null,512),[[zt,c.value]]),N[10]||(N[10]=x("p",{class:"text-xs text-slate-500"},"Weight after cleaning/processing.",-1))]),x("div",T4,[N[11]||(N[11]=x("label",{class:"text-sm font-medium text-slate-700"},"Processing Date",-1)),Ke(x("input",{"onUpdate:modelValue":N[3]||(N[3]=k=>u.value=k),type:"date",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all outline-none"},null,512),[[zt,u.value]])]),x("div",b4,[f.value?(oe(),ce("button",{key:0,onClick:E,class:"flex-1 py-4 bg-slate-100 text-slate-600 font-bold rounded-xl shadow hover:bg-slate-200 transition-all"}," Cancel ")):dt("",!0),x("button",{onClick:h,class:"flex-[2] py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-xl shadow-lg hover:shadow-purple-500/30 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:!f.value&&(o.value.length===0||!l.value||!c.value)},be(f.value?"Update Batch":"Process & Store Batch"),9,S4)])])])])],512),x("div",A4,[N[17]||(N[17]=x("div",{class:"p-6 border-b border-slate-50"},[x("h3",{class:"font-bold text-lg text-slate-800"},"Stored Batches")],-1)),x("div",k4,[x("table",C4,[N[16]||(N[16]=x("thead",null,[x("tr",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100"},[x("th",{class:"px-6 py-4 bg-white"},"Date"),x("th",{class:"px-6 py-4 bg-white"},"Container ID"),x("th",{class:"px-6 py-4 bg-white text-right"},"Input (kg)"),x("th",{class:"px-6 py-4 bg-white text-right"},"Output (kg)"),x("th",{class:"px-6 py-4 bg-white text-center"},"Status"),x("th",{class:"px-6 py-4 bg-white text-center"},"Actions")])],-1)),x("tbody",O4,[e.processedBatches.length===0?(oe(),ce("tr",R4,[...N[13]||(N[13]=[x("td",{colspan:"6",class:"px-6 py-12 text-center text-slate-400 italic"},"No processed batches yet.",-1)])])):dt("",!0),(oe(!0),ce(We,null,ct(e.processedBatches,k=>(oe(),ce("tr",{key:k.id,class:qr(["transition-colors group",f.value&&f.value.id===k.id?"bg-purple-50 border-l-4 border-purple-500":"hover:bg-slate-50/80"])},[x("td",I4,be(k.processingDate),1),x("td",F4,be(k.containerId),1),x("td",D4,be(k.sourceCollectionIds.reduce((K,P)=>{const q=e.records.find(Q=>Q.id===P);return K+(q?Number(q.quantity):0)},0).toFixed(2)),1),x("td",P4,be(k.outputQuantity),1),x("td",N4,[x("span",L4,be(k.status),1)]),x("td",B4,[x("div",M4,[x("button",{onClick:K=>w(k),disabled:k.status!=="stored",class:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors disabled:opacity-20 disabled:cursor-not-allowed",title:"Edit Batch (Stored only)"},[...N[14]||(N[14]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,U4),x("button",{onClick:Ei(K=>O(k.id),["stop"]),disabled:k.status!=="stored",class:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors disabled:opacity-20 disabled:cursor-not-allowed",title:"Delete Batch (Stored only)"},[...N[15]||(N[15]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,$4)])])],2))),128))])])])])]))}},W4={class:"space-y-8"},H4={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},V4={class:"flex justify-between items-center mb-4"},K4={key:0,class:"text-slate-400 italic text-sm p-4 bg-slate-50 rounded-xl"},G4={key:1,class:"space-y-2 max-h-[400px] overflow-y-auto pr-2"},q4=["onClick"],z4={class:"flex items-center gap-3"},X4={key:0,class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},J4={class:"font-bold text-slate-800"},Y4={class:"text-xs text-slate-500"},Q4={class:"font-bold text-orange-600"},Z4={class:"lg:pl-8 lg:border-l border-slate-100"},eA={class:"font-bold text-slate-700 mb-4"},tA={class:"p-4 bg-slate-50 rounded-xl mb-6"},rA={class:"text-2xl font-bold text-slate-800"},nA={key:0,class:"text-xs text-orange-600 mt-2 font-medium"},sA={class:"space-y-4"},iA={class:"space-y-2"},aA={class:"space-y-2"},oA={class:"flex gap-3 mt-4"},lA=["disabled"],cA={class:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden"},uA={class:"overflow-x-auto"},fA={class:"w-full text-left border-collapse"},hA={class:"divide-y divide-slate-50"},dA={key:0},pA={class:"px-6 py-5 align-middle text-slate-600"},gA={class:"px-6 py-5 align-middle font-bold text-slate-800"},vA={class:"px-6 py-5 align-middle text-center text-slate-500"},mA={class:"px-6 py-5 align-middle text-right font-bold text-orange-600"},xA={class:"px-6 py-5 align-middle text-center"},_A={class:"flex items-center justify-center gap-2"},wA=["onClick"],yA=["onClick"],EA={__name:"DispatchPanel",props:{processedBatches:{type:Array,required:!0},dispatches:{type:Array,required:!0}},emits:["create-dispatch","delete-dispatch","update-dispatch"],setup(e,{emit:t}){const r=e,n=t,s=yt(()=>r.processedBatches.filter(E=>E.status==="stored")),i=Be([]),a=Be(""),o=Be(new Date().toISOString().split("T")[0]),l=Be(null),c=yt(()=>l.value?r.processedBatches.filter(E=>l.value.processedBatchIds.includes(E.id)).reduce((E,_)=>E+Number(_.outputQuantity),0).toFixed(2):r.processedBatches.filter(E=>i.value.includes(E.id)).reduce((E,_)=>E+Number(_.outputQuantity),0).toFixed(2)),u=E=>{l.value||(i.value.includes(E)?i.value=i.value.filter(_=>_!==E):i.value.push(E))},f=()=>{l.value||(i.value.length===s.value.length?i.value=[]:i.value=s.value.map(E=>E.id))},p=()=>{if(l.value)n("update-dispatch",{...l.value,destination:a.value,dispatchDate:o.value}),h();else{if(i.value.length===0||!a.value)return;n("create-dispatch",{id:Date.now(),processedBatchIds:[...i.value],dispatchDate:o.value,destination:a.value,totalWeight:Number(c.value),status:"dispatched"}),g()}},d=Be(null),v=E=>{l.value=E,a.value=E.destination,o.value=E.dispatchDate,i.value=[],d.value&&d.value.scrollIntoView({behavior:"smooth",block:"start"})},h=()=>{l.value=null,g()},g=()=>{i.value=[],a.value="",o.value=new Date().toISOString().split("T")[0]},w=E=>{confirm('Delete this dispatch? This will revert containers to "Stored".')&&n("delete-dispatch",E)};return(E,_)=>(oe(),ce("div",W4,[x("div",{ref_key:"formContainer",ref:d,class:"bg-white rounded-2xl shadow-xl p-8 border border-slate-100"},[_[8]||(_[8]=x("h2",{class:"text-2xl font-bold bg-gradient-to-r from-orange-500 to-red-600 bg-clip-text text-transparent mb-6"}," Dispatch Management ",-1)),x("div",H4,[x("div",null,[x("div",V4,[_[2]||(_[2]=x("h3",{class:"font-bold text-slate-700"},"1. Select Containers to Dispatch",-1)),s.value.length>0&&!l.value?(oe(),ce("button",{key:0,onClick:f,class:"text-xs font-bold text-blue-600 hover:text-blue-800 transition-colors"},be(i.value.length===s.value.length?"Deselect All":"Select All"),1)):dt("",!0)]),s.value.length===0?(oe(),ce("div",K4," No stored containers available for dispatch. ")):(oe(),ce("div",G4,[(oe(!0),ce(We,null,ct(s.value,O=>(oe(),ce("div",{key:O.id,onClick:B=>u(O.id),class:qr(["p-4 rounded-xl border cursor-pointer transition-all flex justify-between items-center group",i.value.includes(O.id)?"border-orange-500 bg-orange-50 ring-1 ring-orange-200":"border-slate-200 hover:bg-slate-50 hover:border-slate-300"])},[x("div",z4,[x("div",{class:qr(["w-5 h-5 rounded border flex items-center justify-center transition-colors",i.value.includes(O.id)?"bg-orange-500 border-orange-500 text-white":"bg-white border-slate-300 group-hover:border-slate-400"])},[i.value.includes(O.id)?(oe(),ce("svg",X4,[..._[3]||(_[3]=[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):dt("",!0)],2),x("div",null,[x("div",J4,be(O.containerId),1),x("div",Y4,"Processed: "+be(O.processingDate),1)])]),x("div",Q4,be(O.outputQuantity)+" kg",1)],10,q4))),128))]))]),x("div",Z4,[x("h3",eA,be(l.value?"2. Edit Dispatch Details":"2. Enter Dispatch Details"),1),x("div",tA,[_[5]||(_[5]=x("div",{class:"text-sm text-slate-500 mb-1"},"Total Dispatch Weight",-1)),x("div",rA,[ur(be(c.value)+" ",1),_[4]||(_[4]=x("span",{class:"text-sm text-slate-500 font-normal"},"kg",-1))]),i.value.length>0?(oe(),ce("div",nA,be(i.value.length)+" containers selected ",1)):dt("",!0)]),x("div",sA,[x("div",iA,[_[6]||(_[6]=x("label",{class:"text-sm font-medium text-slate-700"},"Destination",-1)),Ke(x("input",{"onUpdate:modelValue":_[0]||(_[0]=O=>a.value=O),type:"text",placeholder:"e.g. Colombo Export Hub",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-all outline-none"},null,512),[[zt,a.value]])]),x("div",aA,[_[7]||(_[7]=x("label",{class:"text-sm font-medium text-slate-700"},"Dispatch Date",-1)),Ke(x("input",{"onUpdate:modelValue":_[1]||(_[1]=O=>o.value=O),type:"date",class:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-all outline-none"},null,512),[[zt,o.value]])]),x("div",oA,[l.value?(oe(),ce("button",{key:0,onClick:h,class:"flex-1 py-4 bg-slate-100 text-slate-600 font-bold rounded-xl shadow hover:bg-slate-200 transition-all"}," Cancel ")):dt("",!0),x("button",{onClick:p,class:"flex-[2] py-4 bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold rounded-xl shadow-lg hover:shadow-orange-500/30 active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:!l.value&&(i.value.length===0||!a.value)},be(l.value?"Update Dispatch":"Create Dispatch Record"),9,lA)])])])])],512),x("div",cA,[_[13]||(_[13]=x("div",{class:"p-6 border-b border-slate-50"},[x("h3",{class:"font-bold text-lg text-slate-800"},"Dispatch History")],-1)),x("div",uA,[x("table",fA,[_[12]||(_[12]=x("thead",null,[x("tr",{class:"text-xs font-bold text-slate-400 uppercase tracking-wider border-b border-slate-100"},[x("th",{class:"px-6 py-4 bg-white"},"Date"),x("th",{class:"px-6 py-4 bg-white"},"Destination"),x("th",{class:"px-6 py-4 bg-white text-center"},"Containers"),x("th",{class:"px-6 py-4 bg-white text-right"},"Total Weight (kg)"),x("th",{class:"px-6 py-4 bg-white text-center"},"Actions")])],-1)),x("tbody",hA,[e.dispatches.length===0?(oe(),ce("tr",dA,[..._[9]||(_[9]=[x("td",{colspan:"5",class:"px-6 py-12 text-center text-slate-400 italic"},"No dispatches recorded yet.",-1)])])):dt("",!0),(oe(!0),ce(We,null,ct(e.dispatches,O=>(oe(),ce("tr",{key:O.id,class:"hover:bg-slate-50/80 transition-colors group"},[x("td",pA,be(O.dispatchDate),1),x("td",gA,be(O.destination),1),x("td",vA,be(O.processedBatchIds.length),1),x("td",mA,be(O.totalWeight),1),x("td",xA,[x("div",_A,[x("button",{onClick:B=>v(O),class:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors",title:"Edit Dispatch"},[..._[10]||(_[10]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,wA),x("button",{onClick:Ei(B=>w(O.id),["stop"]),class:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:"Delete Dispatch"},[..._[11]||(_[11]=[x("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,yA)])])]))),128))])])])])]))}},TA={key:0},bA={key:1,class:"flex h-screen bg-[#f1f5f9] font-sans text-slate-900 overflow-hidden"},SA={class:"w-64 bg-[#0f172a] text-white flex-shrink-0 flex flex-col z-20"},AA={class:"flex-1 py-6 px-3 space-y-1 overflow-y-auto"},kA=["onClick"],CA={class:"w-5 h-5 fill-current opacity-70",viewBox:"0 0 24 24","aria-hidden":"true"},OA=["d"],RA={class:"flex-1 flex flex-col h-full overflow-hidden relative"},IA={class:"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6 z-10 shrink-0"},FA={class:"flex items-center gap-4"},DA={class:"font-semibold text-slate-800"},PA={class:"flex-1 overflow-y-auto p-6 scroll-smooth"},NA={class:"max-w-7xl mx-auto space-y-6 animate-fade-in pb-10"},LA={__name:"App",setup(e){const t=Be("dashboard"),r=Be(null),n=Be([]),s=Be([]),i=Be([]),a=Be([]),o=Be([]),l=Be([]),c=Be(!0),u=async()=>{if(r.value){c.value=!0;try{const[J,te,se,we,ke,$e]=await Promise.all([Xe.from("districts").select("*").order("name"),Xe.from("sites").select("*").order("name"),Xe.from("containers").select("*").order("label"),Xe.from("collections").select("*").order("date",{ascending:!1}),Xe.from("batches").select("*").order("processing_date",{ascending:!1}),Xe.from("dispatches").select("*").order("dispatch_date",{ascending:!1})]);if(J.error)throw J.error;if(te.error)throw te.error;if(se.error)throw se.error;if(we.error)throw we.error;if(ke.error)throw ke.error;if($e.error)throw $e.error;s.value=J.data.map(Se=>({...Se,id:Se.id})),i.value=te.data.map(Se=>({...Se,id:Se.id,districtId:Se.district_id})),l.value=se.data.map(Se=>({...Se,id:Se.id,districtId:Se.district_id})),n.value=we.data.map(Se=>({...Se,districtId:Se.district_id,siteId:Se.site_id,bagNumber:Se.bag_number,containerId:Se.container_id})),a.value=ke.data.map(Se=>({...Se,processingDate:Se.processing_date,outputQuantity:Se.output_quantity,containerId:Se.container_id,sourceCollectionIds:we.data.filter(R=>R.batch_id===Se.id).map(R=>R.id)})),o.value=$e.data.map(Se=>({...Se,dispatchDate:Se.dispatch_date,vehicleNumber:Se.vehicle_number,processedBatchIds:ke.data.filter(R=>R.dispatch_id===Se.id).map(R=>R.id)}))}catch(J){console.error("Error fetching data:",J)}finally{c.value=!1}}},f=yt(()=>n.value.map(J=>{const te=s.value.find(we=>we.id===J.districtId),se=i.value.find(we=>we.id===J.siteId);return{...J,districtName:te?.name||"Unknown",siteName:se?.name||"Unknown"}})),p=yt(()=>a.value.map(J=>({...J})));c0(()=>{Xe.auth.getSession().then(({data:J})=>{r.value=J.session,r.value&&u()}),Xe.auth.onAuthStateChange((J,te)=>{r.value=te,te?u():(n.value=[],s.value=[],i.value=[])})});const d=async()=>{await Xe.auth.signOut()},v=async({id:J,date:te,districtId:se,siteId:we,quantity:ke,bagNumber:$e,notes:Se,containerId:R})=>{const U={id:J,date:te,district_id:se,site_id:we,quantity:ke,bag_number:$e,notes:Se,container_id:R,status:"collected"},{error:F}=await Xe.from("collections").insert(U);if(F)return console.error(F);n.value.push({...U,districtId:se,siteId:we,bagNumber:$e,containerId:R})},h=async J=>{const{id:te,date:se,districtId:we,siteId:ke,quantity:$e,bagNumber:Se,notes:R,containerId:U,status:F}=J,D={date:se,district_id:we,site_id:ke,quantity:$e,bag_number:Se,notes:R,container_id:U,status:F},{error:Y}=await Xe.from("collections").update(D).eq("id",te);if(Y)return console.error(Y);const _e=n.value.findIndex(Ae=>Ae.id===te);_e!==-1&&(n.value[_e]={...n.value[_e],...J})},g=async J=>{const{error:te}=await Xe.from("collections").delete().eq("id",J);if(te)return console.error(te);n.value=n.value.filter(se=>se.id!==J)},w=async J=>{const{id:te,sourceCollectionIds:se,processingDate:we,outputQuantity:ke,containerId:$e,status:Se}=J,{error:R}=await Xe.from("batches").insert({id:te,processing_date:we,output_quantity:ke,container_id:$e,status:Se});if(R)return console.error(R);const{error:U}=await Xe.from("collections").update({batch_id:te,status:"processed"}).in("id",se);U&&console.error(U),a.value.push(J),n.value=n.value.map(F=>se.includes(F.id)?{...F,status:"processed",batch_id:te}:F),t.value="dispatch"},E=async J=>{const te=a.value.find(ke=>ke.id===J);if(!te)return;const{error:se}=await Xe.from("collections").update({batch_id:null,status:"collected"}).eq("batch_id",J);if(se)return console.error(se);const{error:we}=await Xe.from("batches").delete().eq("id",J);if(we)return console.error(we);n.value=n.value.map(ke=>te.sourceCollectionIds.includes(ke.id)?{...ke,status:"collected",batch_id:null}:ke),a.value=a.value.filter(ke=>ke.id!==J)},_=async J=>{const{id:te,processingDate:se,outputQuantity:we,containerId:ke,status:$e}=J,{error:Se}=await Xe.from("batches").update({processing_date:se,output_quantity:we,container_id:ke,status:$e}).eq("id",te);if(Se)return console.error(Se);const R=a.value.findIndex(U=>U.id===te);R!==-1&&(a.value[R]=J)},O=async J=>{const{id:te,dispatchDate:se,vehicleNumber:we,processedBatchIds:ke}=J,{error:$e}=await Xe.from("dispatches").insert({id:te,dispatch_date:se,vehicle_number:we});if($e)return console.error($e);const{error:Se}=await Xe.from("batches").update({dispatch_id:te,status:"dispatched"}).in("id",ke);Se&&console.error(Se),o.value.push(J),a.value=a.value.map(R=>ke.includes(R.id)?{...R,status:"dispatched",dispatch_id:te}:R),t.value="dashboard"},B=async J=>{const te=o.value.find(ke=>ke.id===J);if(!te)return;const{error:se}=await Xe.from("batches").update({dispatch_id:null,status:"stored"}).eq("dispatch_id",J);if(se)return console.error(se);const{error:we}=await Xe.from("dispatches").delete().eq("id",J);if(we)return console.error(we);a.value=a.value.map(ke=>te.processedBatchIds.includes(ke.id)?{...ke,status:"stored",dispatch_id:null}:ke),o.value=o.value.filter(ke=>ke.id!==J)},N=async J=>{const{id:te,dispatchDate:se,vehicleNumber:we}=J,{error:ke}=await Xe.from("dispatches").update({dispatch_date:se,vehicle_number:we}).eq("id",te);if(ke)return console.error(ke);const $e=o.value.findIndex(Se=>Se.id===te);$e!==-1&&(o.value[$e]=J)},k=async J=>{const{data:te,error:se}=await Xe.from("districts").insert({name:J.name}).select();if(se)return console.error(se);te&&te[0]&&s.value.push({...te[0],id:te[0].id})},K=async J=>{const{error:te}=await Xe.from("districts").delete().eq("id",J);if(te)return console.error(te);s.value=s.value.filter(se=>se.id!==J),i.value=i.value.filter(se=>se.districtId!==J)},P=async J=>{const{data:te,error:se}=await Xe.from("sites").insert({name:J.name,district_id:J.districtId}).select();if(se)return console.error(se);te&&te[0]&&i.value.push({...te[0],id:te[0].id,districtId:te[0].district_id})},q=async J=>{const{error:te}=await Xe.from("sites").delete().eq("id",J);if(te)return console.error(te);i.value=i.value.filter(se=>se.id!==J)},Q=async J=>{const{error:te}=await Xe.from("containers").insert({id:J.id,label:J.label,district_id:J.districtId});if(te)return console.error(te);l.value.push(J)},ne=async J=>{const{error:te}=await Xe.from("containers").delete().eq("id",J);if(te)return console.error(te);l.value=l.value.filter(se=>se.id!==J)},ve=[{id:"dashboard",label:"Dashboard",icon:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"},{id:"collections",label:"Collected",icon:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"},{id:"processing",label:"Processed & Stored",icon:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-7-2h2v-2h-2v2zm0-4h2V7h-2v6z"},{id:"dispatch",label:"Dispatched",icon:"M20 8h-3V4H3v16h18v-8zM5 18v-6h6v6H5zm8 0v-6h4v6h-4zm4-8H5V6h10v4zm2 2v4h-2v-4h2z"},{id:"config",label:"Configuration",icon:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.48.48 0 0 0-.59.22L2.05 8.93a.49.49 0 0 0 .12.61l2.03 1.58c-.05.3-.07.63-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.58 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32a.49.49 0 0 0-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}],je=yt(()=>{const J=ve.find(te=>te.id===t.value);return J?J.label:"Puttalam Central Storage"});return(J,te)=>r.value?(oe(),ce("div",bA,[x("aside",SA,[te[2]||(te[2]=x("div",{class:"h-16 flex items-center px-6 border-b border-slate-800"},[x("h1",{class:"text-xl font-bold tracking-tight"},[ur("PCS "),x("span",{class:"text-slate-500 font-normal ml-1"},"v2.0")])],-1)),x("nav",AA,[(oe(),ce(We,null,ct(ve,se=>x("button",{key:se.id,onClick:we=>t.value=se.id,class:qr(["w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors",t.value===se.id?"bg-blue-600 text-white shadow-md shadow-blue-900/20":"text-slate-400 hover:text-slate-100 hover:bg-slate-800"])},[(oe(),ce("svg",CA,[x("path",{d:se.icon},null,8,OA)])),ur(" "+be(se.label),1)],10,kA)),64))]),x("div",{class:"p-4 border-t border-slate-800 max-w-full overflow-hidden"},[te[1]||(te[1]=Ip('<div class="flex items-center gap-3 mb-4"><div class="w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-xs font-bold flex-shrink-0"> MS </div><div class="text-xs truncate"><div class="font-medium text-slate-200">Logged User</div><div class="text-slate-500">Admin</div></div></div>',1)),x("button",{onClick:d,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg text-xs font-medium transition-colors"},[...te[0]||(te[0]=[x("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),ur(" Sign Out ",-1)])])])]),x("div",RA,[x("header",IA,[x("div",FA,[te[3]||(te[3]=x("span",{class:"text-slate-400 font-medium"},"Application / ",-1)),x("span",DA,be(je.value),1)])]),x("main",PA,[x("div",NA,[Ke(x("div",null,[Rt(wb,{records:f.value,districts:s.value,sites:i.value,processedBatches:p.value,dispatches:o.value},null,8,["records","districts","sites","processedBatches","dispatches"])],512),[[Fs,t.value==="dashboard"]]),Ke(x("div",null,[Rt(gS,{records:f.value,districts:s.value,sites:i.value,containers:l.value,onAddRecord:v,onUpdateRecord:h,onDeleteRecord:g},null,8,["records","districts","sites","containers"])],512),[[Fs,t.value==="collections"]]),Ke(x("div",null,[Rt(j4,{records:f.value,processedBatches:p.value,containers:l.value,onCreateBatch:w,onDeleteBatch:E,onUpdateBatch:_},null,8,["records","processedBatches","containers"])],512),[[Fs,t.value==="processing"]]),Ke(x("div",null,[Rt(EA,{processedBatches:a.value,dispatches:o.value,onCreateDispatch:O,onDeleteDispatch:B,onUpdateDispatch:N},null,8,["processedBatches","dispatches"])],512),[[Fs,t.value==="dispatch"]]),Ke(x("div",null,[Rt(e4,{districts:s.value,sites:i.value,containers:l.value,onAddDistrict:k,onDeleteDistrict:K,onAddSite:P,onDeleteSite:q,onAddContainer:Q,onDeleteContainer:ne},null,8,["districts","sites","containers"])],512),[[Fs,t.value==="config"]])])])])])):(oe(),ce("div",TA,[Rt(em)]))}};d1(LA).mount("#app");
